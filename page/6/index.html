<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/libs/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/libs/pace/pace-theme-flash.min.css?v=1.0.2">


















  
  
  
  

  
    
    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Monda:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|Monda:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext">
  






<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.0',
    sidebar: {"position":"left","display":"hide","offset":12,"onmobile":true,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Beny&#39;s blog">
<meta property="og:url" content="https://benyzheng.github.io/page/6/index.html">
<meta property="og:site_name" content="Beny&#39;s blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Beny&#39;s blog">





  
  
  <link rel="canonical" href="https://benyzheng.github.io/page/6/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Beny's blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Beny's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">Nothing worth having comes easy.</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">13</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">60</span></a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

<a href="https://github.com/bengzheng" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://benyzheng.github.io/2019/05/26/数据结构/1 算法的复杂度/算法复杂度/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Beny">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Beny's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/26/数据结构/1 算法的复杂度/算法复杂度/" class="post-title-link" itemprop="url">算法复杂度</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

             
                
              

              <time title="创建时间：2019-05-26 12:12:57" itemprop="dateCreated datePublished" datetime="2019-05-26T12:12:57+08:00">2019-05-26 12:12:57</time>
            

            
              
            <!--  old version
              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
              <time title="修改时间：2019-10-06 22:10:45" itemprop="dateModified" datetime="2019-10-06T22:10:45+08:00">2019-10-06</time> 
              -->
              <!-- new version -->
                        
            <span class="post-updated">
                
                  <span class="post-meta-divider">|</span>
                  

                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-check-o"></i>
                  </span>
                  
                    <span class="post-meta-item-text">更新于</span>
                
              <time itemprop="dateUpdated" datetime="2019-10-06T22:10:45+08:00" content="2019-10-06">
                2019-10-06 22:10:45
              </time>
            </span>
          
            
          </span>


          
          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/05/26/数据结构/1 算法的复杂度/算法复杂度/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/05/26/数据结构/1 算法的复杂度/算法复杂度/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="算法复杂度"><a href="#算法复杂度" class="headerlink" title="算法复杂度"></a>算法复杂度</h3><p>算法是对问题求解步骤的描述，通过有限序列的指令来实现</p>
<p>五大特征</p>
<ul>
<li>有穷性：有限步之后结束</li>
<li>确定性：不存在二义性</li>
<li>可行性</li>
<li>输入</li>
<li>输出</li>
</ul>
<h6 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h6><p>用来衡量算法随着问题规模增大，算法执行时间的增大的快慢</p>
<p>时间复杂度是问题规模的函数：T(n)</p>
<p>T(n)=O(f(n))，大O记法</p>
<p>计算方法： 算法时间增长最快的那个函数项，把它的系数改为1</p>
<h6 id="空间复杂度"><a href="#空间复杂度" class="headerlink" title="空间复杂度"></a>空间复杂度</h6><ul>
<li>用来衡量算法随问题规模增大，算法所需空间的增长的快慢</li>
<li>是问题规模的函数：S(n)=O(g(n))</li>
</ul>
<p>常见的时间复杂度大小关系</p>
<p>O(1)&lt;O(logn)&lt;O(n)&lt;O(nlogn)&lt;O(n2)&lt;O(n3)&lt;O(2n)</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://benyzheng.github.io/2019/05/26/数据结构/2 线性表/线性表/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Beny">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Beny's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/26/数据结构/2 线性表/线性表/" class="post-title-link" itemprop="url">线性表</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

             
                
              

              <time title="创建时间：2019-05-26 12:12:57" itemprop="dateCreated datePublished" datetime="2019-05-26T12:12:57+08:00">2019-05-26 12:12:57</time>
            

            
              
            <!--  old version
              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
              <time title="修改时间：2019-10-06 22:13:24" itemprop="dateModified" datetime="2019-10-06T22:13:24+08:00">2019-10-06</time> 
              -->
              <!-- new version -->
                        
            <span class="post-updated">
                
                  <span class="post-meta-divider">|</span>
                  

                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-check-o"></i>
                  </span>
                  
                    <span class="post-meta-item-text">更新于</span>
                
              <time itemprop="dateUpdated" datetime="2019-10-06T22:13:24+08:00" content="2019-10-06">
                2019-10-06 22:13:24
              </time>
            </span>
          
            
          </span>


          
          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/05/26/数据结构/2 线性表/线性表/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/05/26/数据结构/2 线性表/线性表/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="线性表"><a href="#线性表" class="headerlink" title="线性表"></a>线性表</h3><p>线性表是具有相同数据类型的n(n&gt;=0)个数据元素的有限序列</p>
<p>线性表的顺序存储是用一组<strong>地址连续</strong>的存储单元，依次存储线性表中的数据元素，顺序存储的线性表也叫顺序表</p>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/顺序表的存储结构.png" alt></p>
<p>静态建表：</p>
<ul>
<li>存储空间的起始位置</li>
<li>顺序表最大存储容量</li>
<li>顺序表当前的长度</li>
</ul>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/顺序表结构体.png" alt></p>
<p>数组是静态分配的（大小固定）</p>
<p>其实存储空间（数组）还可以动态分配，也就是存储数组的空间是在程序执行过程中通过动态分配语句来分配的</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> Elemtype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    ElemType *data;<span class="comment">//指示动态分配数组的指针</span></span><br><span class="line">    <span class="keyword">int</span> MaxSize,length;<span class="comment">//数组的最大容量和当前个数</span></span><br><span class="line">&#125;SeqList;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">动态分配语句</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> InitSize 100</span></span><br><span class="line">SeqList L;</span><br><span class="line">L.data=(ElemType*)<span class="built_in">malloc</span>(sezeof(ElemType)*InitSize);</span><br></pre></td></tr></table></figure>
<p>动态分配并不是链式存储，同样还是属于顺序存储结构，只是分配的空间大小可以在运行时决定</p>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/顺序存储特点总结.png" alt></p>
<h5 id="顺序表的操作"><a href="#顺序表的操作" class="headerlink" title="顺序表的操作"></a>顺序表的操作</h5><h6 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">在顺序表L的第i（1&lt;=i&lt;=L.length）个位置插入新元素e。如果i的输入不合法，则返回false,表示插入失败；否则，将顺序表的第i个元素以及其后的所有元素右移一个位置，腾出一个空位置插入新元素e，顺序表长度增加1，插入成功，返回true</span><br><span class="line"></span><br><span class="line">bool ListInsert(SqlList &amp;L,int i,ElemType e)&#123;</span><br><span class="line">	if(i&lt;1||i&gt;L.length+1)//判断i的范围是否有效</span><br><span class="line">	return false;</span><br><span class="line">	if(L.length&gt;=MaxSize)//当前的存储空间已满，不能插入</span><br><span class="line">		return false;</span><br><span class="line">	for(int j=L.length;j&gt;=i;j--)//将第i个元素及之后的元素后移</span><br><span class="line">		L.data[j]=L.data[j-1];</span><br><span class="line">	L.data[i-1]=e;</span><br><span class="line">	L.lengt++;</span><br><span class="line">	return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/顺序表插入复杂度.png" alt></p>
<h6 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">删除顺序表L中第i（1&lt;=i&lt;=L.length）个位置的元素，成功则返回true，并将被删除的元素用应用变量e返回；否则返回false</span><br><span class="line"></span><br><span class="line">bool ListDelete(SqList &amp;L,int i,ElemType &amp;e)&#123;</span><br><span class="line">	if(i&lt;1||i&gt;L.length+1)//判断i的范围是否有效</span><br><span class="line">		return false;</span><br><span class="line">	e=L.data[i-1];</span><br><span class="line">	for(int j=i;j&lt;L.length;j++)</span><br><span class="line">		L.data[j-1]=L.data[j];</span><br><span class="line">	L.length--;</span><br><span class="line">	return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/顺序表删除复杂度.png" alt></p>
<p>优点：</p>
<ul>
<li>存储密度大，不需要为表中元素之间的逻辑关系增加额外存储空间</li>
<li>随机存取：可以快速存取表中任一位置的元素</li>
</ul>
<p>缺点：</p>
<ul>
<li>插入和删除需要移动大量元素</li>
<li>对存储空间要求高，会产生存储空间的碎片</li>
</ul>
<h5 id="链式存储"><a href="#链式存储" class="headerlink" title="链式存储"></a>链式存储</h5><p> 线性表的链式存储是指通过一组任意的存储单元来存储线性表中的数据元素。为了建立起数据元素之间的线性关系，每个链表结点，除了存放元素自身的信息之外，还需要存放一个指向其后继的指针。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span>&#123;</span></span><br><span class="line">	ElemType data;<span class="comment">//数据域</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> *<span class="title">next</span>;</span><span class="comment">//指针域</span></span><br><span class="line">&#125;LNode,*LinkList;</span><br></pre></td></tr></table></figure>
<p>通常用“头指针”来标识一个单链表，例如LinkList L，那么头指针L代表一个单链表</p>
<p>单链表第一个结点之前附加一个结点，称为头结点，头结点的数据域可以不设任何信息，也可以记录表长等相关信息。头结点的指针域指向线性表的第一个元素结点。</p>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/头指针.png" alt></p>
<h5 id="单链表操作"><a href="#单链表操作" class="headerlink" title="单链表操作"></a>单链表操作</h5><h6 id="头插法建立单链表"><a href="#头插法建立单链表" class="headerlink" title="头插法建立单链表"></a>头插法建立单链表</h6><p>建立新的结点分配内存空间，将新结点插入当前链表的表头</p>
<p> <img src="/2019/05/26/数据结构/2 线性表/线性表/头插法建立链表.png" alt></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//默认有空的头结点</span></span><br><span class="line"><span class="function">LinkList <span class="title">CreatList1</span><span class="params">(LinkList &amp;L)</span></span>&#123;</span><br><span class="line">    LNode *s;</span><br><span class="line">	<span class="keyword">int</span> x;<span class="comment">//存储插入结点的数据的值</span></span><br><span class="line">	L=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LNode));<span class="comment">//创建头结点</span></span><br><span class="line">	L-&gt;next=<span class="literal">NULL</span>;<span class="comment">//初始化为空链表</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);<span class="comment">//输入结点的值</span></span><br><span class="line">	<span class="keyword">while</span>(x!=<span class="number">9999</span>)&#123;<span class="comment">//输入9999表示结束</span></span><br><span class="line">		s=(LNode*)<span class="built_in">malloc</span>(sizeif(LNode));<span class="comment">//创建新结点</span></span><br><span class="line">		s-&gt;data=x;<span class="comment">//对新结点的数据域赋值</span></span><br><span class="line">		s-&gt;next=L-&gt;next;<span class="comment">//新结点的后继指向第一个结点</span></span><br><span class="line">		L-&gt;next=s;<span class="comment">//头结点的后继指向新结点</span></span><br><span class="line">        sanf(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="尾插法建立单链表"><a href="#尾插法建立单链表" class="headerlink" title="尾插法建立单链表"></a>尾插法建立单链表</h6><p>建立新的结点分配内存空间，将新的结点插入到当前链表的表尾</p>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/尾插法建立链表.png" alt></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LinkList <span class="title">CreatList2</span><span class="params">(LinkList &amp;L)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x;<span class="comment">//存储插入结点的数据的值</span></span><br><span class="line">	L=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LNode));<span class="comment">//创建头结点</span></span><br><span class="line">    LNode *s,*r=L;<span class="comment">//r为表尾指针，指向表尾</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);<span class="comment">//输入结点的值</span></span><br><span class="line">	<span class="keyword">while</span>(x!=<span class="number">9999</span>)&#123;<span class="comment">//输入9999表示结束</span></span><br><span class="line">		s=(LNode*)<span class="built_in">malloc</span>(sizeif(LNode));<span class="comment">//创建新结点</span></span><br><span class="line">		s-&gt;data=x;<span class="comment">//对新结点的数据域赋值</span></span><br><span class="line">		r-&gt;next=s;</span><br><span class="line">        r=s;</span><br><span class="line">        sanf(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">	&#125;</span><br><span class="line">    r-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="按序号查找结点"><a href="#按序号查找结点" class="headerlink" title="按序号查找结点"></a>按序号查找结点</h6><p>在单链表中从第一个结点出发，顺指针next域逐个往下搜索，直到找到第i个结点为止，否则返回最后一个结点指针域NULL</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LNode *<span class="title">GEtElem</span><span class="params">(LinkList L,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> j=<span class="number">1</span>;<span class="comment">//计数，初始为1</span></span><br><span class="line">	LNode *p=L-&gt;next;<span class="comment">//第一个结点指针赋给p</span></span><br><span class="line">	<span class="keyword">if</span>(i==<span class="number">0</span>) <span class="keyword">return</span> L;<span class="comment">//若i等于0，返回头结点</span></span><br><span class="line">	<span class="keyword">if</span>(i&lt;<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span>(p&amp;&amp;j&lt;i)&#123;<span class="comment">//从第一个结点开始找，查找第i个结点</span></span><br><span class="line">        p=p-&gt;next;</span><br><span class="line">        j++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>按值查找结点</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LNode *<span class="title">Locate</span><span class="params">(LinkList L,ElemType e)</span></span>&#123;</span><br><span class="line">	LNode *p=L-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(p!=<span class="literal">NULL</span>&amp;&amp;p-&gt;data!=e)&#123;<span class="comment">//从第一个结点开始找</span></span><br><span class="line">        p=p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="插入新结点"><a href="#插入新结点" class="headerlink" title="插入新结点"></a>插入新结点</h6><p>插入操作是将值为x的新结点插入到单链表的第i个位置上。先检查插入位置和合法性，然后找到待插入位置的前驱结点，即第i-1个结点，再在其后插入新结点</p>
<p>算法思路：</p>
<ol>
<li>取指向插入位置的前驱结点的指针p=GetElem(L,i-1);</li>
<li>取新结点<em>s的指针域指向 </em>p的后继结点s-&gt;next=p-&gt;next</li>
<li>令结点<em>p的指针域指向新插入的结点 </em>s p-&gt;next=s;</li>
</ol>
<h6 id="删除一个结点"><a href="#删除一个结点" class="headerlink" title="删除一个结点"></a>删除一个结点</h6><p>删除操作是将单链表的第i个结点删除，先检查删除位置的合法性，然后查找表中第i-1个结点，即被删除结点的前驱结点，再将其删除</p>
<p>算法思路：</p>
<ol>
<li>取指向删除位置的前驱结点的指针 p=GetElem(L,i-1);</li>
<li>取指向删除位置的指针 q=p-&gt;next;</li>
<li>p指向结点的后继指向被删除结点的后继 p-&gt;next=q-&gt;next</li>
</ol>
<h5 id="双链表"><a href="#双链表" class="headerlink" title="双链表"></a>双链表</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span>&#123;</span></span><br><span class="line">	ElemType data;</span><br><span class="line">    structLNode *node;</span><br><span class="line">&#125;LNode,*LinkList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">DNode</span>&#123;</span></span><br><span class="line">    ElemType data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">DNode</span> *<span class="title">prior</span>,*<span class="title">next</span>;</span><span class="comment">//前驱和后继指针</span></span><br><span class="line">&#125;DNode,*DLinkList;</span><br></pre></td></tr></table></figure>
<h6 id="插入-1"><a href="#插入-1" class="headerlink" title="插入"></a>插入</h6><ol>
<li>s-&gt;next=p-&gt;next</li>
<li>p-next-&gt;prior=s</li>
<li>s-&gt;prior=p</li>
<li>p-&gt;next=s</li>
</ol>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/双链表插入.png" alt></p>
<h6 id="删除-1"><a href="#删除-1" class="headerlink" title="删除"></a>删除</h6><ol>
<li>p-&gt;next=q-&gt;next</li>
<li>q-&gt;next-&gt;prior=p</li>
<li>free(q)</li>
</ol>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/双链表删除.png" alt></p>
<h5 id="循环链表-amp-静态链表"><a href="#循环链表-amp-静态链表" class="headerlink" title="循环链表&amp;静态链表"></a>循环链表&amp;静态链表</h5><p>循环单链表：循环单链表和单链表的区别在于，表中最后一个结点的指针不是NULL，而改为指向头结点，从而整个链表形成一个环</p>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/循环单链表结构.png" alt></p>
<p>循环单链表的判空条件不是头结点的后继指针是否为空，而是它是否等于头指针</p>
<p>循环双链表</p>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/循环双链表结构.png" alt></p>
<p>静态链表</p>
<p>使用数组来描述线性表的链式存储结构</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MaxSize 50<span class="comment">//静态链表的最大长度</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> ElemType<span class="comment">//静态链表的数据类型假定为int</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">	ElemType data;<span class="comment">//数据域，存储数据元素</span></span><br><span class="line">	<span class="keyword">int</span> next;<span class="comment">//指针域，下一个元素的数组下标</span></span><br><span class="line">&#125;SLinkList[MaxSize];</span><br></pre></td></tr></table></figure>
<p>数组第一个元素不存储数据，它的指针域存储第一个元素所在的数组下标。</p>
<p>链表最后一个元素的指针域值为-1</p>
<p><img src="/2019/05/26/数据结构/2 线性表/线性表/静态链表结构.png" alt></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://benyzheng.github.io/2019/05/26/数据库/数据库之索引/数据库之索引/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Beny">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Beny's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/26/数据库/数据库之索引/数据库之索引/" class="post-title-link" itemprop="url">数据库之索引</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

             
                
              

              <time title="创建时间：2019-05-26 12:12:57" itemprop="dateCreated datePublished" datetime="2019-05-26T12:12:57+08:00">2019-05-26 12:12:57</time>
            

            
              
            <!--  old version
              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
              <time title="修改时间：2019-10-06 23:44:39" itemprop="dateModified" datetime="2019-10-06T23:44:39+08:00">2019-10-06</time> 
              -->
              <!-- new version -->
                        
            <span class="post-updated">
                
                  <span class="post-meta-divider">|</span>
                  

                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-check-o"></i>
                  </span>
                  
                    <span class="post-meta-item-text">更新于</span>
                
              <time itemprop="dateUpdated" datetime="2019-10-06T23:44:39+08:00" content="2019-10-06">
                2019-10-06 23:44:39
              </time>
            </span>
          
            
          </span>


          
          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据库/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/05/26/数据库/数据库之索引/数据库之索引/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/05/26/数据库/数据库之索引/数据库之索引/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="数据库之索引"><a href="#数据库之索引" class="headerlink" title="数据库之索引"></a>数据库之索引</h1><h3 id="创建索引"><a href="#创建索引" class="headerlink" title="创建索引"></a>创建索引</h3><p>在创建表的时候添加索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> mytable(  </span><br><span class="line">    <span class="keyword">ID</span> <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,   </span><br><span class="line">    username <span class="built_in">VARCHAR</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,  </span><br><span class="line">    <span class="keyword">INDEX</span> [indexName] (username(<span class="keyword">length</span>))  </span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>在创建表以后添加索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> my_table <span class="keyword">ADD</span> [<span class="keyword">UNIQUE</span>] <span class="keyword">INDEX</span> index_name(column_name);</span><br><span class="line">或者</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> index_name <span class="keyword">ON</span> my_table(column_name);</span><br></pre></td></tr></table></figure>
<p>注意：</p>
<p>1、索引需要占用磁盘空间，因此在创建索引时要考虑到磁盘空间是否足够</p>
<p>2、创建索引时需要对表加锁，因此实际操作中需要在业务空闲期间进行</p>
<h3 id="根据索引进行查询"><a href="#根据索引进行查询" class="headerlink" title="根据索引进行查询"></a>根据索引进行查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">具体查询：</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column_1=column_2;(为column_1建立了索引)</span><br><span class="line"></span><br><span class="line">或者模糊查询</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column_1 <span class="keyword">LIKE</span> <span class="string">'%三'</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column_1 <span class="keyword">LIKE</span> <span class="string">'三%'</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column_1 <span class="keyword">LIKE</span> <span class="string">'%三%'</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column_1 <span class="keyword">LIKE</span> <span class="string">'_好_'</span></span><br><span class="line"> </span><br><span class="line">如果要表示在字符串中既有A又有B，那么查询语句为：</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column_1 <span class="keyword">LIKE</span> <span class="string">'%A%'</span> <span class="keyword">AND</span> column_1 <span class="keyword">LIKE</span> <span class="string">'%B%'</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column_1 <span class="keyword">LIKE</span> <span class="string">'[张李王]三'</span>;  //表示column_1中有匹配张三、李</span><br><span class="line">三、王三的都可以</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column_1 <span class="keyword">LIKE</span> <span class="string">'[^张李王]三'</span>;  //表示column_1中有匹配除了张</span><br><span class="line">三、李三、王三的其他三都可以</span><br><span class="line"></span><br><span class="line">//在模糊查询中，%表示任意0个或多个字符；_表示任意单个字符（有且仅有），通常用来限制字符串长度;[]表示</span><br><span class="line">其中的某一个字符；[^]表示除了其中的字符的所有字符</span><br><span class="line"> </span><br><span class="line">或者在全文索引中模糊查询</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> <span class="keyword">MATCH</span>(<span class="keyword">content</span>) AGAINST(<span class="string">'word1'</span>,<span class="string">'word2'</span>,...);</span><br></pre></td></tr></table></figure>
<p>删除索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> my_index <span class="keyword">ON</span> tablename；</span><br><span class="line">或者</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">DROP</span> <span class="keyword">INDEX</span> index_name;</span><br></pre></td></tr></table></figure>
<p>查看表中的索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">INDEX</span> <span class="keyword">FROM</span> tablename</span><br></pre></td></tr></table></figure>
<p>查看查询语句查询索引的情况</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//<span class="keyword">explain</span> 加查询语句</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column_1=<span class="string">'123'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="索引的优缺点"><a href="#索引的优缺点" class="headerlink" title="索引的优缺点"></a>索引的优缺点</h3><p>优点：</p>
<ul>
<li>可以快速检索，加快检索速度</li>
<li>根据索引分组和排序，可以加快分组和排序</li>
</ul>
<p>缺点：</p>
<ul>
<li>索引本身也是表，会占据存储空间</li>
<li>索引表的创建和维护需要时间，随数据量增大而增大</li>
<li>降低数据表的修改操作（删除、添加、修改）的效率，因为在修改数据表的同时也要修改索引表</li>
</ul>
<h3 id="索引的分类"><a href="#索引的分类" class="headerlink" title="索引的分类"></a>索引的分类</h3><p>常见的索引类型有：主键索引、唯一索引、普通索引、全文索引、组合索引</p>
<p>1、主键索引：即主索引，根据主键pk_clolum（length）建立索引，<strong>不允许重复，不允许空值</strong>；</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">'table_name'</span> <span class="keyword">ADD</span> PRIMARY <span class="keyword">KEY</span> pk_index(<span class="string">'col'</span>)；</span><br></pre></td></tr></table></figure>
<p>2、唯一索引：用来建立索引的列的值必须是<strong>唯一的，允许空值</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">'table_name'</span> <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> index_name(<span class="string">'col'</span>)；</span><br></pre></td></tr></table></figure>
<p>3、普通索引：用表中的普通列构建的索引，没有任何限制</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">'table_name'</span> <span class="keyword">ADD</span> <span class="keyword">INDEX</span> index_name(<span class="string">'col'</span>)；</span><br></pre></td></tr></table></figure>
<p>4、全文索引：用大文本对象的列构建的索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">'table_name'</span> <span class="keyword">ADD</span> FULLTEXT <span class="keyword">INDEX</span> ft_index(<span class="string">'col'</span>)；</span><br></pre></td></tr></table></figure>
<p>5、组合索引：用多个列组合构建的索引，这多个列中的值不允许有空值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">'table_name'</span> <span class="keyword">ADD</span> <span class="keyword">INDEX</span> index_name(<span class="string">'col1'</span>,<span class="string">'col2'</span>,<span class="string">'col3'</span>)；</span><br></pre></td></tr></table></figure>
<p>遵循“<strong>最左前缀</strong>”原则，把最常用作为检索或排序的列放在最左，依次递减，组合索引<strong>相当于建立了col1,col1col2,col1col2col3三个索引</strong>，而col2或者col3是不能使用索引的。</p>
<p>在使用组合索引的时候可能因为列名长度过长而导致索引的key太大，导致效率降低，在允许的情况下，可以只取col1和col2的前几个字符作为索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">'table_name'</span> <span class="keyword">ADD</span> <span class="keyword">INDEX</span> index_name(col1(<span class="number">4</span>),col2（<span class="number">3</span>))；</span><br></pre></td></tr></table></figure>
<p>表示使用col1的前4个字符和col2的前3个字符作为索引。</p>
<h3 id="索引的选取类型"><a href="#索引的选取类型" class="headerlink" title="索引的选取类型"></a>索引的选取类型</h3><p>1、越小的数据类型通常更好：越小的数据类型通常在磁盘、内存和CPU缓存中都需要更少的空间，处理起来更快</p>
<p>2、简单的数据类型更好：整型数据比起字符，处理开销更小，因为字符串的比较更复杂</p>
<p>3、尽量避免NULL：应该指定列为NOT nuLL,在MySQL中， 含有空值的列很难进行查询优化，因为它们使得索引、索引的统计信息以及比较运算更加复杂</p>
<h3 id="什么场景不适合创建索引"><a href="#什么场景不适合创建索引" class="headerlink" title="什么场景不适合创建索引"></a>什么场景不适合创建索引</h3><p>1、很少使用查询或者只是作为参考的列，因为这些列很少用到，添加索引只会增加开销和维护成本</p>
<p>2、很少数据集的列也不应该加索引，例如班级的同学的性别，只有男或女，利用索引相当于全表搜索，没意义</p>
<p>3、当修改性能远远大于检索性能时，因为修改性能和检索性能互相矛盾</p>
<p>4、不会出现在where条件中的字段不该建立索引</p>
<h3 id="什么的字段适合索引"><a href="#什么的字段适合索引" class="headerlink" title="什么的字段适合索引"></a>什么的字段适合索引</h3><p>1、表的主键和外键必须有索引，外键唯一，且经常查询</p>
<p>2、数据量比较多的超过300需要索引</p>
<p>3、经常需要和其他表进行连接查询的字段应该建立索引</p>
<p>4、经常出现在where子句中的字段，加快判断速度</p>
<p>5、经常用到排序的列上，因为索引已经排序</p>
<p>6、经常用在范围内搜索的列上创建索引，因为索引已经排序，指定范围是连续（B+树）</p>
<h3 id="MySQL索引的底层原理"><a href="#MySQL索引的底层原理" class="headerlink" title="MySQL索引的底层原理"></a>MySQL索引的底层原理</h3><p>索引是帮助MySQL高效获取数据的数据结构</p>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/索引方式思路图.png" alt></p>
<p>上图展示的是一种可能的索引方式</p>
<p>左边是数据表，一共有两列14条记录，最左边是数据记录的物理地址（注意逻辑上相邻的记录在磁盘上并不一定物理相邻），但实际数据库系统几乎没有使用二叉查找树或其进化品种<a href="https://link.jianshu.com/?t=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FRed-black_tree" target="_blank" rel="noopener">红黑树</a>（red-black tree）实现</p>
<p>目前大部分数据库系统及文件系统都采用B Tree或其变种B+Tree作为索引结构，MySQL普遍使用B+树实现索引</p>
<p>在MySQL中，索引属于存储引擎级别的概念，不同存储引擎对索引的实现方式是不同的</p>
<p><strong>MyISAM和InnoDB对索引和数据的存储在磁盘上是如何体现的</strong></p>
<p>role表使用的存储引擎是MyISAM，而user使用的是InnoDB：</p>
<ol>
<li>role表有三个文件，对应如下：</li>
</ol>
<ul>
<li>role.frm：表结构文件</li>
<li>role.MYD：数据文件（MyISAM Data）</li>
<li>role.MYI：索引文件（MyISAM Index）</li>
</ul>
<ol start="2">
<li>user表有两个文件，对应如下：</li>
</ol>
<ul>
<li>user.frm：表结构文件</li>
<li>user.ibd：索引和数据文件（InnoDB Data）</li>
</ul>
<p>由于两种引擎对索引和数据的存储方式的不同，我们也称MyISAM的索引为非聚集索引，InnoDB的索引为聚集索引。</p>
<p><strong>MyISAM索引实现</strong></p>
<p>MyISAM引擎使用B+Tree作为索引结构，叶节点data域存放数据记录的地址</p>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/MyISAM索引实现.png" alt></p>
<p>设Col1为主键，上图是一个MyISAM表的主索引（Primary key）示例。<br>可以看出MyISAM的索引文件仅仅保存数据记录的地址。<br>在MyISAM中，主索引和辅索引（Secondary key）在结构上没有任何区别，只是主索引要求key是唯一的，而辅索引的key可以重复（为什么没有区别，是因为SQL语句中where子句可以使用的是其他字段来作为条件，如clo2&gt;…之类的语句，所以主索引和辅助索引在MyISAM没有区别）<br>如果我们在Col2上建立一个辅索引，则此索引的结构如下图所示：</p>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/MyISAM辅助索引图.png" alt></p>
<p>MyISAM的索引方式也叫做“非聚集”的，之所以这么称呼是为了与InnoDB的聚集索引区分</p>
<p><strong>InnoDB索引实现</strong></p>
<ul>
<li>MyISAM索引文件和数据文件是分离的，索引文件仅保存数据记录的地址</li>
<li>而在InnoDB中，表数据文件本身就是按B+Tree组织的一个索引结构，这棵树的叶节点data域保存了完整的数据记录。这个索引的key是数据表的主键，因此InnoDB表数据文件本身就是主索引</li>
</ul>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/InnoDB主索引.png" alt></p>
<p>与MyISAM的区别两点：</p>
<p>一、因为InnoDB的数据文件本身要按主键聚集，所以InnoDB要求表必须有主键（MyISAM可以没有）</p>
<p>如果没有显式指定，则MySQL系统会自动选择一个可以唯一标识数据记录的列作为主键</p>
<p>如果不存在这种列，则MySQL自动为InnoDB表生成一个隐含字段作为主键，这个字段长度为6个字节，类型为长整形</p>
<p>二、InnoDB的辅索引data域存储相应记录主键的值而不是地址。</p>
<p>InnoDB的所有辅助索引都引用主键作为data域</p>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/InnoDB辅助索引图.png" alt></p>
<h3 id="索引存在但未使用情况（索引失效、索引优化）"><a href="#索引存在但未使用情况（索引失效、索引优化）" class="headerlink" title="索引存在但未使用情况（索引失效、索引优化）"></a>索引存在但未使用情况（索引失效、索引优化）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> idx_test_a1234 <span class="keyword">ON</span> <span class="keyword">test</span>(a1,a2,a3,a4);//创建联合索引来说明索引失效的一下情况</span><br></pre></td></tr></table></figure>
<p>1.字符串为使用引号，导致索引失效（不能在索引列上干任何操作(计算,函数,类型转换) ）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span>  a1 = a1;//可以查到数据，数据库自动转换类型，但索引失效</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 = <span class="string">'a1'</span>;</span><br></pre></td></tr></table></figure>
<p>2、索引最左原则使用不当，导致索引失效（where子句后面的顺序无关，只要用到就可以）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 = <span class="string">'a1'</span> <span class="keyword">and</span> a2 = <span class="string">'a2'</span> <span class="keyword">and</span> a3 = <span class="string">'a3'</span> <span class="keyword">and</span> a4 = <span class="string">'a4'</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a4= <span class="string">'a4'</span> <span class="keyword">and</span> a3 = <span class="string">'a3'</span> <span class="keyword">and</span> a2 = <span class="string">'a2'</span> <span class="keyword">and</span> a1= <span class="string">'a1'</span>;</span><br><span class="line">以上两个查询中，where条件中的索引位置是相反的，但是执行结果是一致的，这个是由mysql优化器来处理的，因</span><br><span class="line">为两个查询中都出现了联合索引a1,a2，a3,a4，MySQL优化器底层会进行优化处理。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 = <span class="string">'a1'</span> <span class="keyword">and</span> a3 = <span class="string">'a3'</span> <span class="keyword">and</span> a4 = <span class="string">'a4'</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a4= <span class="string">'a4'</span> <span class="keyword">and</span> a3 = <span class="string">'a3'</span> <span class="keyword">and</span> a1= <span class="string">'a1'</span>;</span><br><span class="line">以上两个查询只用到一个索引a1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 = <span class="string">'a1'</span> <span class="keyword">and</span> a2 = <span class="string">'a2'</span>  <span class="keyword">and</span> a4 = <span class="string">'a4'</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a4= <span class="string">'a4'</span> <span class="keyword">and</span> a2 = <span class="string">'a2'</span> <span class="keyword">and</span> a1= <span class="string">'a1'</span>;</span><br><span class="line">以上两个查询用到两个索引</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a2 = <span class="string">'a2'</span> <span class="keyword">and</span> a3 = <span class="string">'a3'</span> <span class="keyword">and</span> a4 = <span class="string">'a4'</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a4= <span class="string">'a4'</span> <span class="keyword">and</span> a3 = <span class="string">'a3'</span> <span class="keyword">and</span> a2 = <span class="string">'a2'</span></span><br><span class="line">以上两个查询未使用索引</span><br></pre></td></tr></table></figure>
<p>3、范围查找导致索引失效（存储引擎不能使用索引中范围条件右边的列）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select * from test where a1 = &apos;a1&apos; and a2 = &apos;a2&apos; and a3 &gt;&apos;a3&apos; and a4 = &apos;a4&apos;;</span><br><span class="line">以上用到a1、a2、a3，3个索引，因为a3右边是a4，导致a4的索引不可用</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select * from test where a1 = &apos;a1&apos; and a2 = &apos;a2&apos; and a4 &gt;&apos;a4&apos; and a3= &apos;a3&apos;;</span><br><span class="line">以上用到a1、a2、a3、a4，4个索引，因为a4后面已经没有索引了，不影响</span><br></pre></td></tr></table></figure>
<p>4、order by使用不当，导致索引失效</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 = <span class="string">'a1'</span> <span class="keyword">and</span> a2 = <span class="string">'a2'</span> <span class="keyword">and</span> a4 = <span class="string">'a4'</span> <span class="keyword">order</span> <span class="keyword">by</span> a3</span><br><span class="line"><span class="keyword">explain</span>语句显示两个索引，严格来说以上用到两个索引查询，三个索引排序</span><br><span class="line">因为查找的<span class="keyword">where</span>条件中跳过了a3,违背了索引的最左原则，导致索引a4失效</span><br><span class="line">严格意义上来说，以上查询使用了<span class="number">3</span>个索引，a3并未用于查找，但是在排序中使用到了，只是为统计到<span class="keyword">explain</span>中，即</span><br><span class="line">满足索引的两大功能：查找和排序</span><br></pre></td></tr></table></figure>
<p>以下排序中，索引使用不当，导致产生了文件内排序，影响性能</p>
<p>a2之后a3断开，导致a4索引失效，mysql 为了将结果展现出来，进行了内部排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 =<span class="string">'a1'</span> <span class="keyword">and</span> a2 = <span class="string">'a2'</span>  <span class="keyword">order</span> <span class="keyword">by</span> a4;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/索引失效oderby1.png" alt></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 =<span class="string">'a1'</span> <span class="keyword">and</span> a5 = <span class="string">'a5'</span>  <span class="keyword">order</span> <span class="keyword">by</span> a2,a3;</span><br><span class="line">使用到a1一个索引</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 =<span class="string">'a1'</span> <span class="keyword">and</span> a5= <span class="string">'a5'</span>  <span class="keyword">order</span> <span class="keyword">by</span> a3,a2;</span><br><span class="line">使用到a1索引，并且产生文件内排序</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 =<span class="string">'a1'</span> <span class="keyword">and</span> a2 = <span class="string">'a2'</span>  <span class="keyword">order</span> <span class="keyword">by</span> a2,a3;</span><br><span class="line">使用到a1、a2两个索引，没有产生文件内排序</span><br><span class="line"></span><br><span class="line">原文：https://blog.csdn.net/weixin_39539399/article/details/80842750</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/索引失效oderby2.png" alt></p>
<p>5、group by使用不当导致索引失效</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 =<span class="string">'a1'</span><span class="keyword">and</span> a4 = <span class="string">'a4'</span> <span class="keyword">group</span> <span class="keyword">by</span> a2，a3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 =<span class="string">'a1'</span><span class="keyword">and</span> a4 = <span class="string">'a4'</span> <span class="keyword">group</span> <span class="keyword">by</span> a3，a2;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/索引失效groupby.png" alt></p>
<p>分组之前必排序，group by 表面上是分组，但是对索引的使用和order by 的使用大致相同，所以group by后面如果索引错乱，会产生临时表，导致mysql内部进行排序</p>
<p>6、通配符like的使用不当导致索引失效（like以通配符开头(“%abc…”) ）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 <span class="keyword">like</span> <span class="string">'%a'</span>;索引失效</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span>  * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 <span class="keyword">like</span> <span class="string">'a%'</span>;索引不失效</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span>  a1 <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 <span class="keyword">like</span> <span class="string">'%a'</span>;覆盖索引，解决最左匹配不当的索引失效问题</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span>  * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 <span class="keyword">like</span> <span class="string">'c%'</span>;索引失效</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span>  * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 <span class="keyword">like</span> <span class="string">'%c'</span>;索引失效</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span>  * <span class="keyword">from</span> <span class="keyword">test</span> <span class="keyword">where</span> a1 <span class="keyword">like</span> <span class="string">'abc%'</span>;索引不失效</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/索引失效通配符like.png" alt></p>
<p>6、MYSQL 中!=,&lt;&gt;导致索引失效（is null, is not null 也无法使用索引）</p>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/索引失效等号.png" alt></p>
<p>尽量使用覆盖索引(只访问索引的查询),减少select *，可以解决索引失效的以上问题</p>
<p>7、少用or,用它来连接时索引会失效</p>
<p>关于or导致的索引失效，是有存在这种情况的，即or的左右边的查询条件，有一个列没有加索引，那么另一个列的索引会失效。要想使得索引生效，需要保证or两边的列都有索引，且一个列是主键。</p>
<p>小总结</p>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/索引总结1.png" alt></p>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/索引总结2.png" alt></p>
<p><img src="/2019/05/26/数据库/数据库之索引/数据库之索引/索引总结3.png" alt></p>
<p>索引的底层原理其实没有我总结那么简单，水平有限，B+B-树随缘再总结</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://benyzheng.github.io/2019/05/26/数据结构/3 栈和队列/栈和队列/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Beny">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Beny's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/26/数据结构/3 栈和队列/栈和队列/" class="post-title-link" itemprop="url">栈和队列</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

             
                
              

              <time title="创建时间：2019-05-26 12:12:57" itemprop="dateCreated datePublished" datetime="2019-05-26T12:12:57+08:00">2019-05-26 12:12:57</time>
            

            
              
            <!--  old version
              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
              <time title="修改时间：2019-10-06 22:14:39" itemprop="dateModified" datetime="2019-10-06T22:14:39+08:00">2019-10-06</time> 
              -->
              <!-- new version -->
                        
            <span class="post-updated">
                
                  <span class="post-meta-divider">|</span>
                  

                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-check-o"></i>
                  </span>
                  
                    <span class="post-meta-item-text">更新于</span>
                
              <time itemprop="dateUpdated" datetime="2019-10-06T22:14:39+08:00" content="2019-10-06">
                2019-10-06 22:14:39
              </time>
            </span>
          
            
          </span>


          
          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/05/26/数据结构/3 栈和队列/栈和队列/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/05/26/数据结构/3 栈和队列/栈和队列/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="栈和队列"><a href="#栈和队列" class="headerlink" title="栈和队列"></a>栈和队列</h3><h5 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h5><p>只允许在一端进行插入或删除操作的线性表</p>
<p>栈顶：栈中允许进行插入和删除的哪一端</p>
<p>栈底：固定的，不允许进行插入和删除的另一端</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MaxSize 50</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">	Elemtype data[MaxSize];<span class="comment">//存放栈中的元素</span></span><br><span class="line">	<span class="keyword">int</span> top;<span class="comment">//栈顶指针</span></span><br><span class="line">&#125;SqStack;</span><br></pre></td></tr></table></figure>
<ul>
<li>top值不能超过MaxSize</li>
<li>空栈的判定条件通常定为top==-1，满栈的判定条件通常为top==MaxSize-1，栈中数据元素个数为top+1</li>
</ul>
<h5 id="顺序栈的操作"><a href="#顺序栈的操作" class="headerlink" title="顺序栈的操作"></a>顺序栈的操作</h5><h6 id="判空"><a href="#判空" class="headerlink" title="判空"></a>判空</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">StackEmpty</span><span class="params">(SqStack S)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(s.top==<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="进栈"><a href="#进栈" class="headerlink" title="进栈"></a>进栈</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Push</span><span class="params">(SqStack &amp;S,ElemType x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(S.top==MaxSize<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    S.data[++S.top]=x; </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="出栈"><a href="#出栈" class="headerlink" title="出栈"></a>出栈</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Pop</span><span class="params">(SqStack &amp;S,ElemType &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(S.top==<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    x=S.data[S.top--];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="获取栈顶元素"><a href="#获取栈顶元素" class="headerlink" title="获取栈顶元素"></a>获取栈顶元素</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">GetTop</span><span class="params">(SqStack S,ElemType &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(S.top==<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    x=S.data[S.top];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="共享栈"><a href="#共享栈" class="headerlink" title="共享栈"></a>共享栈</h5><p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/共享栈.png" alt></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MaxSize 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    Elemtype data[MaxSize];<span class="comment">//存放栈中的元素</span></span><br><span class="line">    <span class="keyword">int</span> top1;<span class="comment">//栈1栈顶指针</span></span><br><span class="line">    <span class="keyword">int</span> top2;<span class="comment">//栈2栈顶指针</span></span><br><span class="line">&#125;SqDoubleStack;</span><br></pre></td></tr></table></figure>
<h6 id="进栈-1"><a href="#进栈-1" class="headerlink" title="进栈"></a>进栈</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Push</span><span class="params">(SqDoubleStack &amp;S,ElemType x,<span class="keyword">int</span> stackNum)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(S.top1+<span class="number">1</span>==S.top2) <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//栈满</span></span><br><span class="line">    <span class="keyword">if</span>(stackNum==<span class="number">1</span>) 			</span><br><span class="line">        S.data[++S.top1]=x;<span class="comment">//栈1有元素进栈</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(stackNum==<span class="number">2</span>) S.data[--S.top2]=x;<span class="comment">//栈2有元素进栈</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="链式栈"><a href="#链式栈" class="headerlink" title="链式栈"></a>链式栈</h5><p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/链式栈结构.png" alt></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">SNode</span>&#123;</span></span><br><span class="line">    Elemtype data;<span class="comment">//存放栈中的元素</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">SNode</span> *<span class="title">next</span>//栈顶指针</span></span><br><span class="line"><span class="class">&#125;<span class="title">SNode</span>,*<span class="title">SLink</span>//链栈结点</span></span><br><span class="line"><span class="class">    </span></span><br><span class="line"><span class="class"><span class="title">typedef</span> <span class="title">struct</span> <span class="title">LinkStack</span>&#123;</span></span><br><span class="line">	SLink top;<span class="comment">//栈顶指针</span></span><br><span class="line">	<span class="keyword">int</span> count;<span class="comment">//链栈结点数</span></span><br><span class="line">&#125;LinkStack</span><br></pre></td></tr></table></figure>
<ul>
<li>链栈没有栈满的情况</li>
<li>链栈空为top==null</li>
</ul>
<h6 id="进栈-2"><a href="#进栈-2" class="headerlink" title="进栈"></a>进栈</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Push</span><span class="params">(LinkStack *S,ElemType x)</span></span>&#123;</span><br><span class="line">    SLink p=(SLink)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(SNode));<span class="comment">//给新元素分配空间</span></span><br><span class="line">    p-&gt;data=x;<span class="comment">//新元素的值</span></span><br><span class="line">    p-next=S-&gt;top;<span class="comment">//p的后继指向栈顶元素</span></span><br><span class="line">    S-&gt;top=p;<span class="comment">//栈顶指针指向新的元素</span></span><br><span class="line">    S-&gt;count++;<span class="comment">//栈中元素个数加1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/链式栈进栈.png" alt></p>
<h6 id="出栈-1"><a href="#出栈-1" class="headerlink" title="出栈"></a>出栈</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Pop</span><span class="params">(LinkStack *S,ElemType &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(S-&gt;top==<span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    x=S-&gt;top-&gt;data;<span class="comment">//栈顶元素值</span></span><br><span class="line">    SLink p=S-&gt;top;<span class="comment">//辅助指针</span></span><br><span class="line">    S-&gt;top=S-&gt;top-&gt;next;<span class="comment">//栈顶指针后移</span></span><br><span class="line">    <span class="built_in">free</span>(p);<span class="comment">//释放被删除数据的存储空间</span></span><br><span class="line">    S-&gt;count--;<span class="comment">//栈中元素个数减一</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/链式栈出栈.png" alt></p>
<h5 id="栈的应用"><a href="#栈的应用" class="headerlink" title="栈的应用"></a>栈的应用</h5><h6 id="括号配对"><a href="#括号配对" class="headerlink" title="括号配对"></a>括号配对</h6><p>假设有两种括号，一种圆的()，一种方的[]，嵌套的顺序是任意的</p>
<p>算法思路：</p>
<p>若是左括号，入栈；若是右括号，出栈一个左括号判断是否与之匹配；检验到字符串尾，还要检查栈是否为空。只有栈空整个字符串才是括号匹配</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Check</span><span class="params">(<span class="keyword">char</span> *str)</span></span>&#123;</span><br><span class="line">    <span class="built_in">stack</span> s;</span><br><span class="line">    InitStack(s);</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(str);<span class="comment">//字符串长度</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="keyword">char</span> a=str[i];</span><br><span class="line">        <span class="keyword">switch</span>(a)&#123;</span><br><span class="line">        	<span class="keyword">case</span> <span class="string">'('</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'['</span>;</span><br><span class="line">                Push(s,a);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">')'</span>;</span><br><span class="line">                <span class="keyword">if</span>(Pop(s)!=<span class="string">'('</span>) <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//出栈顶，如果不匹配直接返回不合法</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">']'</span>;</span><br><span class="line">                <span class="keyword">if</span>(Pop(s)!=<span class="string">']'</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(Empty(s)) <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//匹配完所有括号最后要求栈中为空</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="表达式求值"><a href="#表达式求值" class="headerlink" title="表达式求值"></a>表达式求值</h6><p>从左到右，先乘除后加减，右括号先算括号</p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/表达式.png" alt></p>
<p>后缀表达式做法：</p>
<p>规则：从左到右扫描表达式的每个数字和符号，遇到数字就进栈，遇到符号就将处于栈顶的两个数字出栈然后跟这个符号进行运算，最后将结果进栈，直到最终获得结果</p>
<p> 如何将中缀表达式转换成后缀表达式（计算机也是用到栈取转换，下面是手动方法）</p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/中缀转后缀.png" alt></p>
<h6 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h6><p>递归最重要的是递归式和递归边界</p>
<p>使用递归求解n的阶乘</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">F</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//递归边界</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> n*F(n<span class="number">-1</span>);<span class="comment">//递归式</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>求斐波拉契数列的第n项</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Fib</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(n==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> Fib(n<span class="number">-1</span>)+Fib(n<span class="number">-2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/斐波拉契数列递归.png" alt></p>
<h5 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h5><p>队列是只允许在一端进行插入，而在另一端进行删除的线性表</p>
<p>队头（Front）：允许删除的一端，队首</p>
<p>队尾（Rear）：允许插入的一端</p>
<h6 id="顺序队列"><a href="#顺序队列" class="headerlink" title="顺序队列"></a>顺序队列</h6><p>用数组实现队列，可以将队首放在数组下标为0的位置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MaxSize 50</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    ElemType data[MaxSize];<span class="comment">//存放队列的元素</span></span><br><span class="line">    <span class="keyword">int</span> front,rear;<span class="comment">//队头指针和队尾指针</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/队列假溢出.png" alt></p>
<h6 id="循环队列"><a href="#循环队列" class="headerlink" title="循环队列"></a>循环队列</h6><p>入队：rear=(rear+1)%MaxSize</p>
<p>出队：front=(front+1)%MaxSize</p>
<p>判断队列是空是满</p>
<ul>
<li>设置标志位flag，当flag=0且rear等于front时为队列空，当flag=1且rear等于front时为队列满（入队时flag等于1，出队时flag等于0）</li>
<li><strong>把front==rear仅作为队空的判定条件</strong>。当队列满的时候，令数组中仍然保留一个空余单元。认为这种情况就是队列满了</li>
</ul>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/循环队列队满判断.png" alt></p>
<p>队满关系</p>
<p>(rear+1)%MaxSize==front</p>
<p>队列中元素个数</p>
<p>(rear-front+MaxSize)%MaxSize</p>
<h6 id="入队"><a href="#入队" class="headerlink" title="入队"></a>入队</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">EnQueue</span><span class="params">(SqQueue &amp;Q,ElemType x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((Q.rear+<span class="number">1</span>)%MaxSize==Q.front) <span class="keyword">return</span> flase;<span class="comment">//队满</span></span><br><span class="line">    Q.data[Q.rear]=x;</span><br><span class="line">    Q.rear=(Q.rear+<span class="number">1</span>)%MaxSize;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="出队"><a href="#出队" class="headerlink" title="出队"></a>出队</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">DeQueue</span><span class="params">(SqQueue &amp;Q,ElemType &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Q.rear==Q.front) <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//队空，报错</span></span><br><span class="line">	x=Q.data[Q.front];</span><br><span class="line">    Q.front=(Q.front+<span class="number">1</span>)%MaxSize;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="链式队列"><a href="#链式队列" class="headerlink" title="链式队列"></a>链式队列</h5><p>队列的链式存储结构，其实就是线性表的单链表，只不过需要加点限制，只能表尾插入元素，表头删除元素</p>
<p>分别设置队头指针和队尾指针，队头指针指向头结点，队尾指针指向队尾结点</p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/链式队列.png" alt></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span><span class="comment">//链式队列结点</span></span><br><span class="line">    ElemType data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LinkNode</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;LinkNode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span><span class="comment">//链式队列</span></span><br><span class="line">    LinkNode *front,*rear;<span class="comment">//队头和队尾指针</span></span><br><span class="line">&#125;LinkQueue;</span><br></pre></td></tr></table></figure>
<h6 id="入队-1"><a href="#入队-1" class="headerlink" title="入队"></a>入队</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">EnQueue</span><span class="params">(LinkQueue &amp;Q,ElemType x)</span></span>&#123;</span><br><span class="line">    s=(LinkNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LinkNode));</span><br><span class="line">    s-&gt;data=x;</span><br><span class="line">    s-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    Q.rear-&gt;next=s;</span><br><span class="line">    Q.rear=s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/链式队列入队.png" alt></p>
<h6 id="出队-1"><a href="#出队-1" class="headerlink" title="出队"></a>出队</h6><p>出队就是头结点的后继结点出队，然后将头结点的后继改为它后面的结点</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">DeQueue</span><span class="params">(LinkQueue &amp;Q,ElemType &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Q.front==Q.rear) <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//空队</span></span><br><span class="line">    p=Q.front-&gt;next;</span><br><span class="line">    x=p-&gt;data;</span><br><span class="line">    Q.front-&gt;next=p-&gt;next;</span><br><span class="line">    <span class="keyword">if</span>(Q.rear==p) Q.rear=Q.front;<span class="comment">//若原队列中只有一个结点，删除后变空</span></span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/链式队列出队.png" alt></p>
<h5 id="双端队列"><a href="#双端队列" class="headerlink" title="双端队列"></a>双端队列</h5><p>双端队列是指允许两端都可以进行入队和出队操作的队列</p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/双端队列结构.png" alt></p>
<h5 id="矩阵"><a href="#矩阵" class="headerlink" title="矩阵"></a>矩阵</h5><p>对于二维数组，两种映射方法：按行优先和按列优先</p>
<p>行优先</p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/行优先.png" alt></p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/行优先计算.png" alt></p>
<p>列优先</p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/列优先.png" alt></p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/列优先计算.png" alt></p>
<h6 id="矩阵的压缩存储"><a href="#矩阵的压缩存储" class="headerlink" title="矩阵的压缩存储"></a>矩阵的压缩存储</h6><p>对称矩阵</p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/对角矩阵.png" alt></p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/对角矩阵计算.png" alt></p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/对角矩阵计算2.png" alt></p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/对角矩阵计算3.png" alt></p>
<p>三角矩阵</p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/三角矩阵.png" alt></p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/三角矩阵计算.png" alt></p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/三角矩阵计算1.png" alt></p>
<p>三对角矩阵</p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/三对角矩阵.png" alt></p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/三对角矩阵2.png" alt></p>
<p>稀疏矩阵</p>
<p><img src="/2019/05/26/数据结构/3 栈和队列/栈和队列/稀疏矩阵.png" alt></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://benyzheng.github.io/2019/05/26/数据结构/4 树和二叉树/树与二叉树/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Beny">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Beny's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/" class="post-title-link" itemprop="url">树与二叉树</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

             
                
              

              <time title="创建时间：2019-05-26 12:12:57" itemprop="dateCreated datePublished" datetime="2019-05-26T12:12:57+08:00">2019-05-26 12:12:57</time>
            

            
              
            <!--  old version
              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
              <time title="修改时间：2019-10-06 22:21:52" itemprop="dateModified" datetime="2019-10-06T22:21:52+08:00">2019-10-06</time> 
              -->
              <!-- new version -->
                        
            <span class="post-updated">
                
                  <span class="post-meta-divider">|</span>
                  

                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-check-o"></i>
                  </span>
                  
                    <span class="post-meta-item-text">更新于</span>
                
              <time itemprop="dateUpdated" datetime="2019-10-06T22:21:52+08:00" content="2019-10-06">
                2019-10-06 22:21:52
              </time>
            </span>
          
            
          </span>


          
          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="树与二叉树"><a href="#树与二叉树" class="headerlink" title="树与二叉树"></a>树与二叉树</h3><p>一对多的树形结构</p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树的结构定义.png" alt></p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树结点相关概念.png" alt></p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树结点相关概念2.png" alt></p>
<h5 id="树的性质"><a href="#树的性质" class="headerlink" title="树的性质"></a>树的性质</h5><ul>
<li>树中的结点等于所有结点的度数加1</li>
</ul>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树的性质1.png" alt></p>
<ul>
<li>度为m的树中第i层上至多有m<sup>i-1</sup>个结点（i&gt;=1）</li>
</ul>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树的性质2.png" alt></p>
<ul>
<li><p>高度为h的m叉树至多有（m<sup>h</sup>-1)/(m-1)个结点</p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树的性质3.png" alt></p>
</li>
<li><p>具有n个结点的m叉树的最小高度为取上整[log<sub>m</sub>(n(m-1)+1)]</p>
</li>
</ul>
<p>解上一个方程的h即可</p>
<h5 id="树的存储结构"><a href="#树的存储结构" class="headerlink" title="树的存储结构"></a>树的存储结构</h5><h6 id="顺序存储结构"><a href="#顺序存储结构" class="headerlink" title="顺序存储结构"></a>顺序存储结构</h6><p>双亲表示法：用一组连续的存储空间存储树的结点，同时在每个结点中，用一个变量存储该结点的双亲结点在数组中的位置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> ElemType;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TNode</span>&#123;</span></span><br><span class="line">    ElemType data;<span class="comment">//结点数据</span></span><br><span class="line">    <span class="keyword">int</span> parent;<span class="comment">//该结点双亲在数组的下标</span></span><br><span class="line">&#125;TNode;<span class="comment">//结点的数据类型</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MaxSize 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    TNode nodes[MaxSize];<span class="comment">//结点数组</span></span><br><span class="line">    <span class="keyword">int</span> n;<span class="comment">//结点的数量</span></span><br><span class="line">&#125;Tree;<span class="comment">//结点双亲表示结构</span></span><br></pre></td></tr></table></figure>
<p>双亲表示法可以根据parent找到该结点的双亲结点，时间复杂度为O(1)。但如果找到某节点的孩子结点就需要遍历</p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/顺序存储结构.png" alt></p>
<h6 id="链式存储结构"><a href="#链式存储结构" class="headerlink" title="链式存储结构"></a>链式存储结构</h6><p>孩子表示法：把每个结点的孩子结点排列起来存储成一个单链表。所以n个结点就有n个链表；如果时叶子结点，那这个结点的孩子单链表就是空的；然后n个单链表的头指针又存储在一个顺序表（数组）中。</p>
<p>需要设计两种结合结构类型：</p>
<ul>
<li>孩子链表的结点</li>
<li>每个孩子链表的表头结点（存在数组中）</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> ElemType;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">CNode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> child;<span class="comment">//该孩子在表头数组的下标</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">CNode</span> *<span class="title">next</span>;</span><span class="comment">//指向该结点的下一个孩子结点</span></span><br><span class="line">&#125;CNode,*Child;<span class="comment">//孩子结点数据结构</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    Elemtype data;<span class="comment">//结点数据域</span></span><br><span class="line">    Child firstchild;<span class="comment">//指向该结点的第一个孩子结点</span></span><br><span class="line">&#125;TNode<span class="comment">//孩子结点的数据类型</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MaxSize 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    TNode nodes[MaxSize];<span class="comment">//结点数据域</span></span><br><span class="line">    <span class="keyword">int</span> n;<span class="comment">//树中结点个数</span></span><br><span class="line">&#125;Tree;<span class="comment">//树的孩子表示结构</span></span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/链式存储结构.png" alt></p>
<p>孩子兄弟表示法：要存储孩子结点和兄弟结点，就是设置两个指针，分别指向该结点的第一个孩子结点和该结点的兄弟结点。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> ElemType;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">CSNode</span>&#123;</span></span><br><span class="line">    ElemType data;<span class="comment">//该结点的数据域</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">CSNode</span> *<span class="title">firstchild</span>,*<span class="title">rightsib</span>//指向该结点的第一个孩子结点和该结点的右兄弟结点</span></span><br><span class="line"><span class="class">&#125;<span class="title">CSNode</span>;</span><span class="comment">//孩子兄弟结点数据类型</span></span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/链式存储结构2.png" alt></p>
<h5 id="二叉树"><a href="#二叉树" class="headerlink" title="二叉树"></a>二叉树</h5><p>每个结点最多有两颗子树</p>
<p>左右子树有顺序</p>
<p>五种基本形态</p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/二叉树五种形态.png" alt></p>
<h6 id="特殊二叉树"><a href="#特殊二叉树" class="headerlink" title="特殊二叉树"></a>特殊二叉树</h6><p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/斜树.png" alt></p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/满二叉树.png" alt></p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/完全二叉树.png" alt></p>
<h5 id="二叉树性质"><a href="#二叉树性质" class="headerlink" title="二叉树性质"></a>二叉树性质</h5><ul>
<li>非空二叉树上叶子结点等于度为2的结点数加1</li>
</ul>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/二叉树性质1.png" alt></p>
<ul>
<li>非空二叉树上第K层上至多有2<sup>k-1</sup>个结点（k&gt;=1）</li>
</ul>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/二叉树性质2.png" alt></p>
<ul>
<li>高度为H的二叉树至多有2<sup>H</sup>-1个结点（H&gt;=1）</li>
</ul>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/二叉树性质3.png" alt></p>
<ul>
<li>具有N个(N&gt;0)结点的完全二叉树的高度为上取整[log<sub>2</sub>(N+1)]或下取整[log<sub>2</sub>N]+1</li>
</ul>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/二叉树性质4.png" alt></p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/二叉树性质5.png" alt></p>
<h5 id="二叉树的存储结构"><a href="#二叉树的存储结构" class="headerlink" title="二叉树的存储结构"></a>二叉树的存储结构</h5><h6 id="顺序存储结构-1"><a href="#顺序存储结构-1" class="headerlink" title="顺序存储结构"></a>顺序存储结构</h6><p>二叉树的顺序存储结构就是用一组地址连续的存储单元依次自上而下，自左而右存储完全二叉树上的结点元素</p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/二叉树顺序存储.png" alt></p>
<h6 id="链式存储结构-1"><a href="#链式存储结构-1" class="headerlink" title="链式存储结构"></a>链式存储结构</h6><p>二叉树每个结点最多两个孩子，所以设计二叉树的结点结构时考虑两个指针指向该结点的两个孩子</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">BiTNode</span>&#123;</span></span><br><span class="line">    ElemType data;<span class="comment">//数据域</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">BiTNode</span> *<span class="title">lchild</span>,*<span class="title">rchild</span>;</span><span class="comment">//指向该结点的左右孩子指针</span></span><br><span class="line">&#125;BiTNode,*BiTNode;<span class="comment">//二叉树结点结构</span></span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/二叉树链式存储结构.png" alt></p>
<h5 id="二叉树遍历-递归"><a href="#二叉树遍历-递归" class="headerlink" title="二叉树遍历(递归)"></a>二叉树遍历(递归)</h5><p>二叉树的遍历是指按某种次序依次访问树中的每个结点，使得每个结点均被访问一次，而且仅被访问一次</p>
<h6 id="递归先序遍历"><a href="#递归先序遍历" class="headerlink" title="递归先序遍历"></a>递归先序遍历</h6><p>操作过程：</p>
<ul>
<li>访问根结点</li>
<li>先序遍历左子树</li>
<li>先序遍历右子树</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PreOrder</span><span class="params">(BiTree T)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%c"</span>,T-&gt;data)<span class="comment">//根节点</span></span><br><span class="line">        PreOrder(T-&gt;lchild);<span class="comment">//左子树</span></span><br><span class="line">        PreOrder(T-&gt;rchild);<span class="comment">//右子树</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="递归中序遍历"><a href="#递归中序遍历" class="headerlink" title="递归中序遍历"></a>递归中序遍历</h6><p>操作过程：</p>
<ul>
<li>中序遍历左子树</li>
<li>访问根节点</li>
<li>中序遍历右子树</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InOrder</span><span class="params">(BiTree T)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">        InOrder(T-&gt;lchild);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%c"</span>,T-&gt;data);</span><br><span class="line">        InOrder(T-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="递归后序遍历"><a href="#递归后序遍历" class="headerlink" title="递归后序遍历"></a>递归后序遍历</h6><p>操作过程：</p>
<ul>
<li>后序遍历左子树</li>
<li>后序遍历右子树</li>
<li>访问根节点</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PostOrder</span><span class="params">(BiTree T)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">        PostOrder(T-&gt;lchild);</span><br><span class="line">        PostOrder(T-&gt;rchild);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%c"</span>,T-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="二叉树遍历-非递归"><a href="#二叉树遍历-非递归" class="headerlink" title="二叉树遍历(非递归)"></a>二叉树遍历(非递归)</h5><h6 id="非递归先序遍历"><a href="#非递归先序遍历" class="headerlink" title="非递归先序遍历"></a>非递归先序遍历</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PreOrderTraverse</span><span class="params">(BiTree b)</span></span>&#123;</span><br><span class="line">    InitStack(S);</span><br><span class="line">    BitTree p=b;<span class="comment">//工作指针p</span></span><br><span class="line">    <span class="keyword">while</span>(p || !IsEmpty(S))&#123;</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%c"</span>,p-&gt;data);<span class="comment">//先序先遍历结点</span></span><br><span class="line">            Push(S,p);<span class="comment">//进栈保存</span></span><br><span class="line">            p=p-&gt;lchild;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!IsEmpty(S))&#123;</span><br><span class="line">            p=Pop(S);</span><br><span class="line">            p=p-rchild;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="非递归中序遍历"><a href="#非递归中序遍历" class="headerlink" title="非递归中序遍历"></a>非递归中序遍历</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InOrderTraverse</span><span class="params">(BiTree b)</span></span>&#123;</span><br><span class="line">    InitStack(S);</span><br><span class="line">    BitTree p=b;<span class="comment">//工作指针p</span></span><br><span class="line">    <span class="keyword">while</span>(p || !IsEmpty(S))&#123;</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            Push(S,p);<span class="comment">//进栈保存</span></span><br><span class="line">            p=p-&gt;lchild;</span><br><span class="line">        &#125;</span><br><span class="line">        p=Pop(S);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%c"</span>,p-&gt;data);</span><br><span class="line">        p=p-rchild;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="非递归后序遍历"><a href="#非递归后序遍历" class="headerlink" title="非递归后序遍历"></a>非递归后序遍历</h6><p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/非递归后续遍历.png" alt></p>
<h6 id="层序遍历"><a href="#层序遍历" class="headerlink" title="层序遍历"></a>层序遍历</h6><p>操作过程：</p>
<p>若树为空，则什么都不做直接返回；</p>
<p>否则从树的第一层开始访问，从上而下逐层遍历，在同一层中，按从左到右的顺序对结点逐个访问</p>
<p>出队-&gt;访问-&gt;左右孩子入队</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LevelOrder</span><span class="params">(BiTree b)</span></span>&#123;</span><br><span class="line">    InitQueue(Q);</span><br><span class="line">    BiTree p;</span><br><span class="line">    EnQueue(Q,b);<span class="comment">//根节点入队</span></span><br><span class="line">    <span class="keyword">while</span>(!IsEmpty(Q))&#123;</span><br><span class="line">        DeQueue(Q,p);<span class="comment">//队头元素出队</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%c"</span>,p-&gt;data);</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;lchild!=<span class="literal">NULL</span>)</span><br><span class="line">            EnQueue(Q,p-&gt;lchild);</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;rchild!=<span class="literal">NULL</span>)</span><br><span class="line">            EnQueue(Q,p-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="线索二叉树"><a href="#线索二叉树" class="headerlink" title="线索二叉树"></a>线索二叉树</h5><p>二叉链表表示的二叉树存在大量空指针</p>
<p>N个结点的二叉树，每个结点都有指向左右孩子的结点指针，所以一共有2N个指针，而N个结点的二叉树一共有N-1个分支，也就是说存在2N-(N-1)=N+1个空指针。</p>
<p>指向前驱和后继的指针称为线索，加上线索的二叉链表称为线索链表，相应的二叉树称为线索二叉树</p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/线索二叉树.png" alt></p>
<p>对二叉树以某种次序遍历使其变为线索二叉树的过程叫做线索化。</p>
<p>如何区分指针是指向左孩子还是前驱，右孩子还是后继？</p>
<p>在二叉链表结点的结构基础上增加两个标志位ltag和rtag</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">ThreadNode</span>&#123;</span></span><br><span class="line">    ElemType data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ThreadNode</span> *<span class="title">lchild</span>,*<span class="title">rchild</span>;</span></span><br><span class="line">    <span class="keyword">int</span> ltag,rtag;</span><br><span class="line">&#125;ThreadNode,*ThreadTree;<span class="comment">//线索链表</span></span><br></pre></td></tr></table></figure>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/线索二叉树结构.png" alt></p>
<ul>
<li>ltag==0表示lchild指向该结点左孩子</li>
<li>ltag==1表示rchild指向该结点前驱</li>
<li>rtag==0表示rchild指向该结点右孩子</li>
<li>rtag==1表示指向该结点后继</li>
</ul>
<h6 id="构造线索二叉树"><a href="#构造线索二叉树" class="headerlink" title="构造线索二叉树"></a>构造线索二叉树</h6><p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/构造线索二叉树.png" alt></p>
<h6 id="遍历线索二叉树"><a href="#遍历线索二叉树" class="headerlink" title="遍历线索二叉树"></a>遍历线索二叉树</h6><p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/遍历线索二叉树.png" alt></p>
<h5 id="哈夫曼树和哈夫曼编码"><a href="#哈夫曼树和哈夫曼编码" class="headerlink" title="哈夫曼树和哈夫曼编码"></a>哈夫曼树和哈夫曼编码</h5><p>概念：</p>
<p>权：树中结点相关的数值</p>
<p>路径长度：从树中某个结点到另一个结点之间的分支数目（经过的边数）</p>
<p>带权路径长度：从树的根节点到任意结点的路径长度（经过的边数）与该结点上权值的乘积称为该结点的带权路径长度</p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树的带权路径长度.png" alt></p>
<p>哈夫曼树：含有N个带权叶子结点的二叉树中，带有带权路径长度（WPL）最小的二叉树，也成为最优二叉树。</p>
<h6 id="设计哈夫曼树"><a href="#设计哈夫曼树" class="headerlink" title="设计哈夫曼树"></a>设计哈夫曼树</h6><ul>
<li>将这N个结点分别作为N颗仅含一个结点的二叉树，构成森林F</li>
<li>构造一个新结点，并从F中选取两颗根节点权值最小的树作为新结点的左右子树，并且将新结点的权值置为左右子树上根节点的权值之和</li>
<li>从F中删除刚才选出的两棵树，同时将新得到的树加入F中</li>
<li>重复步骤2和3，直至F中只剩下一棵树为止</li>
</ul>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/构造哈夫曼树.png" alt></p>
<h6 id="哈夫曼编码"><a href="#哈夫曼编码" class="headerlink" title="哈夫曼编码"></a>哈夫曼编码</h6><p>左子树为0，右子树为1</p>
<p>哈夫曼编码性质</p>
<ul>
<li>哈夫曼编码是前缀编码</li>
<li>哈夫曼编码是最优前缀编码</li>
</ul>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/哈夫曼编码.png" alt></p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/哈夫曼编码2.png" alt></p>
<h5 id="二叉树、树和森林"><a href="#二叉树、树和森林" class="headerlink" title="二叉树、树和森林"></a>二叉树、树和森林</h5><h6 id="树转化成二叉树"><a href="#树转化成二叉树" class="headerlink" title="树转化成二叉树"></a>树转化成二叉树</h6><p>用到一个孩子兄弟表示法（回归本章树的链式存储）</p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树转二叉树1.png" alt></p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树转二叉树2.png" alt></p>
<h6 id="二叉树转树"><a href="#二叉树转树" class="headerlink" title="二叉树转树"></a>二叉树转树</h6><p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/二叉树转树.png" alt></p>
<h6 id="森林转二叉树"><a href="#森林转二叉树" class="headerlink" title="森林转二叉树"></a>森林转二叉树</h6><p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/森林转二叉树.png" alt></p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/森林转二叉树2.png" alt></p>
<h6 id="二叉树转森林"><a href="#二叉树转森林" class="headerlink" title="二叉树转森林"></a>二叉树转森林</h6><p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/二叉树转森林.png" alt></p>
<h6 id="树和森林的遍历"><a href="#树和森林的遍历" class="headerlink" title="树和森林的遍历"></a>树和森林的遍历</h6><p>树的先序遍历</p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树的先序遍历.png" alt></p>
<p>树的后序遍历</p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树的后序遍历.png" alt></p>
<p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/树与二叉树先序后序遍历比较.png" alt></p>
<h6 id="森林遍历"><a href="#森林遍历" class="headerlink" title="森林遍历"></a>森林遍历</h6><p><img src="/2019/05/26/数据结构/4 树和二叉树/树与二叉树/森林先序后序遍历.png" alt></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://benyzheng.github.io/2019/05/26/数据结构/5 图/图/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Beny">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Beny's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/26/数据结构/5 图/图/" class="post-title-link" itemprop="url">图</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

             
                
              

              <time title="创建时间：2019-05-26 12:12:57" itemprop="dateCreated datePublished" datetime="2019-05-26T12:12:57+08:00">2019-05-26 12:12:57</time>
            

            
              
            <!--  old version
              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
              <time title="修改时间：2019-10-06 22:22:43" itemprop="dateModified" datetime="2019-10-06T22:22:43+08:00">2019-10-06</time> 
              -->
              <!-- new version -->
                        
            <span class="post-updated">
                
                  <span class="post-meta-divider">|</span>
                  

                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-check-o"></i>
                  </span>
                  
                    <span class="post-meta-item-text">更新于</span>
                
              <time itemprop="dateUpdated" datetime="2019-10-06T22:22:43+08:00" content="2019-10-06">
                2019-10-06 22:22:43
              </time>
            </span>
          
            
          </span>


          
          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/05/26/数据结构/5 图/图/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/05/26/数据结构/5 图/图/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="图"><a href="#图" class="headerlink" title="图"></a>图</h3><h5 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h5><p>图G由顶点集V和边集E组成，记为G=(V,E)</p>
<p><img src="/2019/05/26/数据结构/5 图/图/1 图的概念1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/2 图的概念2.png" alt></p>
<h6 id="简单图和多重图"><a href="#简单图和多重图" class="headerlink" title="简单图和多重图"></a>简单图和多重图</h6><p>简单图</p>
<ul>
<li>不存在顶点到自身的边</li>
<li>同一条边不重复出现</li>
</ul>
<p>多重图</p>
<p>若图G中某两个结点之间的边数多于一条，又允许顶点通过同一条边和自己关联</p>
<p><img src="/2019/05/26/数据结构/5 图/图/3 简单图和多重图.png" alt></p>
<h6 id="完全图"><a href="#完全图" class="headerlink" title="完全图"></a>完全图</h6><p>无向完全图：如果任意两个顶点之间都存在边</p>
<p>有向完全图：如果任意两个顶点之间都存在方向相反的两条弧</p>
<p><img src="/2019/05/26/数据结构/5 图/图/4 完全图.png" alt></p>
<h6 id="子图"><a href="#子图" class="headerlink" title="子图"></a>子图</h6><p><img src="/2019/05/26/数据结构/5 图/图/5 子图.png" alt></p>
<h6 id="连通图"><a href="#连通图" class="headerlink" title="连通图"></a>连通图</h6><p><img src="/2019/05/26/数据结构/5 图/图/6 连通图.png" alt></p>
<p>强连通</p>
<p><img src="/2019/05/26/数据结构/5 图/图/7 强连通分量.png" alt></p>
<h6 id="连通图的生成树"><a href="#连通图的生成树" class="headerlink" title="连通图的生成树"></a>连通图的生成树</h6><p><img src="/2019/05/26/数据结构/5 图/图/8 连通图生成树.png" alt></p>
<h6 id="度"><a href="#度" class="headerlink" title="度"></a>度</h6><p><img src="/2019/05/26/数据结构/5 图/图/9 度.png" alt></p>
<h6 id="权和网"><a href="#权和网" class="headerlink" title="权和网"></a>权和网</h6><p><img src="/2019/05/26/数据结构/5 图/图/10 权和网.png" alt></p>
<h6 id="基本概念总结"><a href="#基本概念总结" class="headerlink" title="基本概念总结"></a>基本概念总结</h6><p><img src="/2019/05/26/数据结构/5 图/图/11 基本概念总结.png" alt></p>
<h5 id="图的存储结构"><a href="#图的存储结构" class="headerlink" title="图的存储结构"></a>图的存储结构</h5><ul>
<li>邻接矩阵(顺序存储)</li>
<li>邻接表(链式存储)<ul>
<li>十字链表(有向图)</li>
<li>邻接多重表(无向图)</li>
</ul>
</li>
</ul>
<h6 id="邻接矩阵"><a href="#邻接矩阵" class="headerlink" title="邻接矩阵"></a>邻接矩阵</h6><p>顶点：用一维数组来存储</p>
<p>边或弧：用二维数组来存储</p>
<p>二维数组就是一维数组的扩展，相当于一维数组中每个元素也是一维数组，二维数组也叫做邻接矩阵</p>
<p>无向图的邻接矩阵</p>
<p><img src="/2019/05/26/数据结构/5 图/图/12 无向图邻接矩阵.png" alt></p>
<p>有向图的邻接矩阵</p>
<p><img src="/2019/05/26/数据结构/5 图/图/13 有向图邻接矩阵.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/14 矩阵数据结构.png" alt></p>
<h6 id="邻接表"><a href="#邻接表" class="headerlink" title="邻接表"></a>邻接表</h6><p>对于稀疏图(E远小于V)，顺序存储结构存在预先分配内存可能浪费的问题</p>
<p>无向图邻接表</p>
<p><img src="/2019/05/26/数据结构/5 图/图/15 无向图邻接表.png" alt></p>
<p>有向图邻接表</p>
<p><img src="/2019/05/26/数据结构/5 图/图/16 有向图邻接表.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/17 邻接表问题.png" alt></p>
<h6 id="十字链表"><a href="#十字链表" class="headerlink" title="十字链表"></a>十字链表</h6><p>十字链表是针对有向图的存储方式，对应于有向图中的每条弧有一个结点，对应于每个顶点也有一个结点</p>
<p><img src="/2019/05/26/数据结构/5 图/图/18 十字链表.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/19 十字链表实例.png" alt></p>
<p>十字链表数据结构</p>
<p><img src="/2019/05/26/数据结构/5 图/图/20 十字链表结构.png" alt></p>
<h6 id="邻接多重表"><a href="#邻接多重表" class="headerlink" title="邻接多重表"></a>邻接多重表</h6><p><img src="/2019/05/26/数据结构/5 图/图/21 设计邻接多重表.png" alt></p>
<p>边表结构</p>
<p><img src="/2019/05/26/数据结构/5 图/图/22 边表结构.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/23 邻接多重表实例.png" alt></p>
<h5 id="图的遍历"><a href="#图的遍历" class="headerlink" title="图的遍历"></a>图的遍历</h5><p>图的遍历：从图中某一个顶点出发遍历图中其余的顶点，且使每一个顶点仅访问一次，这个过程叫做图的遍历</p>
<p>图中顶点没有特殊性，可能存在沿着某条路径搜索后回到原起点，而有些顶点没有访问到。</p>
<p>解决办法：设置一个访问数组，记录遍历过程中访问过的顶点。</p>
<h6 id="广度优先遍历-BFS"><a href="#广度优先遍历-BFS" class="headerlink" title="广度优先遍历(BFS)"></a>广度优先遍历(BFS)</h6><p><img src="/2019/05/26/数据结构/5 图/图/24 广度优先遍历.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/25 广度优先代码.png" alt></p>
<p>BFS算法实例</p>
<p><img src="/2019/05/26/数据结构/5 图/图/26 广度优先遍历实例.png" alt></p>
<p>BFS空间复杂度</p>
<p>BFS需要借助一个队列，n个顶点均需要入队一次，所以最坏情况下n个顶点在队列，那么则需要O(|V|)的空间复杂度</p>
<p>BFS时间复杂度</p>
<ol>
<li>邻接表：每个顶点入队一次，时间复杂度为O(|V|)，对于每个顶点，搜索它的邻接点，就需要访问这个顶点的所有边，所以时间复杂度为O(|E|)。所以总的时间复杂度为<strong>O(|V|+|E|)</strong>。</li>
<li>邻接矩阵：每个顶点入队一次，时间复杂度为O(|V|)，对于每个顶点，搜索它的邻接点，需要遍历一遍矩阵，所以时间复杂度为O(|V|)，所以总的时间复杂度为<strong>O(|V|<sup>2</sup>)</strong>。</li>
</ol>
<p>BFS应用</p>
<p>BFS解决单源非带权图最短路径问题：按照距离由近到远来遍历图中每个顶点</p>
<p><img src="/2019/05/26/数据结构/5 图/图/27 广度优先应用.png" alt></p>
<p>广度优先生成树</p>
<p><img src="/2019/05/26/数据结构/5 图/图/28 广度优先生成树.png" alt></p>
<h6 id="深度优先遍历-DFS"><a href="#深度优先遍历-DFS" class="headerlink" title="深度优先遍历(DFS)"></a>深度优先遍历(DFS)</h6><p>深度优先遍历（DFS：Depth-First-Serch）：深度优先遍历类似于树的先序遍历算法</p>
<p>遍历过程：首先访问图中某一起始顶点v，然后由v出发，访问与v邻接且未被访问的任一顶点w1，再访问与w1邻接且未被访问的任一顶点w2，。。。。重复上述过程。当不能再继续向下访问时，依次退回到最近被访问的顶点，若它还有邻接顶点未被访问过，则从该点开始继续上述搜索过程，直到图中所有顶点均被访问过为止。</p>
<p><img src="/2019/05/26/数据结构/5 图/图/29 深度优先遍历过程.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/30 深度优先遍历代码.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/31 深度优先遍历实例.png" alt></p>
<p>深度优先复杂度</p>
<p>空间复杂度：</p>
<p>由于DFS是一个递归算法，递归是一个需要工作栈来辅助工作，最多需要图中所有顶点进栈，所以空间复杂度为O(|V|)</p>
<p>时间复杂度：</p>
<ol>
<li>邻接表：遍历过程的主要操作是对顶点遍历它的邻接点，由于通过访问边表来查找邻接点，所以时间复杂度为O(|E|)，访问访问顶点时间为O(|V|)，所以总的时间复杂度为<strong>O(|V|+|E|)</strong>。</li>
<li>邻接矩阵：查找每个顶点的邻接点时间复杂度为O(|V|)，对每个顶点都进行查找，所以总的时间复杂度<strong>O(|V|<sup>2</sup>)</strong>。</li>
</ol>
<p>深度优先生成树</p>
<p><img src="/2019/05/26/数据结构/5 图/图/32 深度优先生成树.png" alt></p>
<h5 id="图的应用"><a href="#图的应用" class="headerlink" title="图的应用"></a>图的应用</h5><h6 id="最小生成树-Prim、Kruskal"><a href="#最小生成树-Prim、Kruskal" class="headerlink" title="最小生成树(Prim、Kruskal)"></a>最小生成树(Prim、Kruskal)</h6><p>连通图的生成树，是一个极小的连通子图。包含图中全部的顶点，但只有足以构成一棵树的n-1条边</p>
<p><img src="/2019/05/26/数据结构/5 图/图/33 生成树不唯一.png" alt></p>
<ul>
<li>普里姆(Prim)算法</li>
<li>克鲁斯卡尔(Kruskal)算法</li>
</ul>
<p>普里姆算法</p>
<p><img src="/2019/05/26/数据结构/5 图/图/34 普利姆算法思路.png" alt></p>
<p>初始化</p>
<p><img src="/2019/05/26/数据结构/5 图/图/35 普利姆算法代码0.png" alt></p>
<p>i=1</p>
<p><img src="/2019/05/26/数据结构/5 图/图/35 普利姆算法代码1.png" alt></p>
<p>i=2</p>
<p><img src="/2019/05/26/数据结构/5 图/图/36 普利姆算法代码2-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/37 普利姆算法代码2-2.png" alt></p>
<p>i=3</p>
<p><img src="/2019/05/26/数据结构/5 图/图/38 普利姆算法代码3-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/39 普利姆算法代码3-2.png" alt></p>
<p>i=4</p>
<p><img src="/2019/05/26/数据结构/5 图/图/40 普利姆算法代码4-1.png" alt></p>
<p>i=5</p>
<p><img src="/2019/05/26/数据结构/5 图/图/41 普利姆算法代码5.png" alt></p>
<p>i=6</p>
<p><img src="/2019/05/26/数据结构/5 图/图/42 普利姆算法代码6.png" alt></p>
<p>Prim算法时间复杂度</p>
<p><img src="/2019/05/26/数据结构/5 图/图/43 普利姆算法复杂度.png" alt></p>
<p>克鲁斯卡尔算法(Kruskal)</p>
<p><img src="/2019/05/26/数据结构/5 图/图/44 克鲁斯卡尔算法思路.png" alt></p>
<p>并查集</p>
<p><img src="/2019/05/26/数据结构/5 图/图/45 并查集.png" alt></p>
<p>算法思路</p>
<p>初始化，将边权值进行排序</p>
<p><img src="/2019/05/26/数据结构/5 图/图/46 克鲁斯算法代码初始化.png" alt></p>
<p>第一次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/47 克鲁斯算法过程1-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/48 克鲁斯算法过程1-2.png" alt></p>
<p>第二次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/49 克鲁斯算法过程2-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/50 克鲁斯算法过程2-2.png" alt></p>
<p>第三次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/51 克鲁斯算法过程3-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/52 克鲁斯算法过程3-2.png" alt></p>
<p>第四次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/53 克鲁斯算法过程4-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/54 克鲁斯算法过程4-2.png" alt></p>
<p>第五次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/55 克鲁斯算法过程5.png" alt></p>
<p>第六次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/56 克鲁斯算法过程6-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/57 克鲁斯算法过程6-2.png" alt></p>
<p>第七次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/58 克鲁斯算法过程7-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/59 克鲁斯算法过程7-2.png" alt></p>
<p>4-6之后的边循环都不进行操作了，已经形成六条边(n-1)，形成最小生成树</p>
<p>克鲁斯卡尔算法复杂度</p>
<p><img src="/2019/05/26/数据结构/5 图/图/60 克鲁斯算法复杂度.png" alt></p>
<h6 id="最短路径-Dijkstra、floyd"><a href="#最短路径-Dijkstra、floyd" class="headerlink" title="最短路径(Dijkstra、floyd)"></a>最短路径(Dijkstra、floyd)</h6><p><img src="/2019/05/26/数据结构/5 图/图/61 最短路径.png" alt></p>
<ul>
<li>迪杰斯特拉算法：一个源点到其余顶点的最短路径</li>
<li>弗洛伊德算法：所有顶点到所有顶点的最短路径</li>
</ul>
<p>迪杰斯特拉算法思路：</p>
<p><img src="/2019/05/26/数据结构/5 图/图/62 迪杰斯特拉算法思路.png" alt></p>
<p>迪杰斯特拉算法实例</p>
<p>第一次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/63 迪杰斯特拉算法实例1-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/64 迪杰斯特拉算法实例1-2.png" alt></p>
<p>第二次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/65 迪杰斯特拉算法实例2.png" alt></p>
<p>第三次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/66 迪杰斯特拉算法实例3.png" alt></p>
<p>第四次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/67 迪杰斯特拉算法实例4.png" alt></p>
<p>第五次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/68 迪杰斯特拉算法实例5.png" alt></p>
<p>迪杰斯特拉算法代码</p>
<p><img src="/2019/05/26/数据结构/5 图/图/69 迪杰斯特拉算法代码1-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/70 迪杰斯特拉算法代码1-2.png" alt></p>
<p>迪杰斯特拉复杂度</p>
<p><img src="/2019/05/26/数据结构/5 图/图/71 迪杰斯特拉算法复杂度.png" alt></p>
<p>弗洛伊德算法</p>
<p>弗洛伊德算法是求图中任意一对顶点间的最短路径的算法</p>
<p>算法思想：</p>
<p><img src="/2019/05/26/数据结构/5 图/图/72 佛洛依德算法思路.png" alt></p>
<p>佛洛依德算法实例</p>
<p>初始化</p>
<p><img src="/2019/05/26/数据结构/5 图/图/73 佛洛依德算法实例初始化.png" alt></p>
<p>第一次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/74 佛洛依德算法实例1.png" alt></p>
<p>第二次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/75 弗洛依德算法实例2.png" alt></p>
<p>第三次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/76 弗洛依德算法实例3.png" alt></p>
<p>第四次</p>
<p><img src="/2019/05/26/数据结构/5 图/图/77 弗洛依德算法实例4.png" alt></p>
<p>弗洛伊德算法代码和复杂度</p>
<p><img src="/2019/05/26/数据结构/5 图/图/78 弗洛依德算法实例5.png" alt></p>
<h6 id="拓扑排序"><a href="#拓扑排序" class="headerlink" title="拓扑排序"></a>拓扑排序</h6><p>AOV网</p>
<p><img src="/2019/05/26/数据结构/5 图/图/79 AOV网.png" alt></p>
<p>拓扑排序算法思路</p>
<p><img src="/2019/05/26/数据结构/5 图/图/80 拓扑排序算法思路.png" alt></p>
<p>第一轮：</p>
<p><img src="/2019/05/26/数据结构/5 图/图/81 拓扑排序算法过程1.png" alt></p>
<p>第二轮：</p>
<p><img src="/2019/05/26/数据结构/5 图/图/82 拓扑排序算法过程2.png" alt></p>
<p>第三轮：</p>
<p><img src="/2019/05/26/数据结构/5 图/图/83 拓扑排序算法过程3.png" alt></p>
<p>第四轮：</p>
<p><img src="/2019/05/26/数据结构/5 图/图/84 拓扑排序算法过程4.png" alt></p>
<p>第五轮：</p>
<p><img src="/2019/05/26/数据结构/5 图/图/85 拓扑排序算法过程5.png" alt></p>
<p>第六轮：</p>
<p><img src="/2019/05/26/数据结构/5 图/图/86 拓扑排序算法过程6.png" alt></p>
<p>第七轮：</p>
<p><img src="/2019/05/26/数据结构/5 图/图/87 拓扑排序算法过程7.png" alt></p>
<p>拓扑排序算法代码</p>
<p><img src="/2019/05/26/数据结构/5 图/图/88 拓扑排序算法代码.png" alt></p>
<p>拓扑排序算法复杂度</p>
<p><img src="/2019/05/26/数据结构/5 图/图/89 拓扑排序算法复杂度.png" alt></p>
<p>拓扑排序规律</p>
<p><img src="/2019/05/26/数据结构/5 图/图/90 拓扑排序算法规律.png" alt></p>
<h6 id="关键路径"><a href="#关键路径" class="headerlink" title="关键路径"></a>关键路径</h6><p>AOE网</p>
<p><img src="/2019/05/26/数据结构/5 图/图/91 AOE网.png" alt></p>
<p>关键路径</p>
<p><img src="/2019/05/26/数据结构/5 图/图/92 关键路径.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/93 关键路径规律.png" alt></p>
<p>寻找关键路径步骤</p>
<p><img src="/2019/05/26/数据结构/5 图/图/94 关键路径步骤1.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/95 关键路径步骤2.png" alt></p>
<p><img src="/2019/05/26/数据结构/5 图/图/96 关键路径步骤3.png" alt></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://benyzheng.github.io/2019/05/26/数据结构/6 查找/查找/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Beny">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Beny's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/26/数据结构/6 查找/查找/" class="post-title-link" itemprop="url">查找</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

             
                
              

              <time title="创建时间：2019-05-26 12:12:57" itemprop="dateCreated datePublished" datetime="2019-05-26T12:12:57+08:00">2019-05-26 12:12:57</time>
            

            
              
            <!--  old version
              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
              <time title="修改时间：2019-10-06 22:23:26" itemprop="dateModified" datetime="2019-10-06T22:23:26+08:00">2019-10-06</time> 
              -->
              <!-- new version -->
                        
            <span class="post-updated">
                
                  <span class="post-meta-divider">|</span>
                  

                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-check-o"></i>
                  </span>
                  
                    <span class="post-meta-item-text">更新于</span>
                
              <time itemprop="dateUpdated" datetime="2019-10-06T22:23:26+08:00" content="2019-10-06">
                2019-10-06 22:23:26
              </time>
            </span>
          
            
          </span>


          
          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/05/26/数据结构/6 查找/查找/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/05/26/数据结构/6 查找/查找/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h3><p>查找：在数据集合中寻找满足某种条件的数据元素的过程</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/1 查找表.png" alt></p>
<p>关键字：数据元素中某个可以唯一标识该元素的数据项</p>
<p>平均查找长度</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/2 平均查找长度.png" alt></p>
<h5 id="顺序查找"><a href="#顺序查找" class="headerlink" title="顺序查找"></a>顺序查找</h5><p><img src="/2019/05/26/数据结构/6 查找/查找/3 顺序查找过程.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/4 顺序查找ASL.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/5 顺序查找时间复杂度.png" alt></p>
<h5 id="折半查找"><a href="#折半查找" class="headerlink" title="折半查找"></a>折半查找</h5><p><img src="/2019/05/26/数据结构/6 查找/查找/6 折半查找.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/7 折半查找判定树.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/8 折半查找时间复杂度.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/9 折半查找成功ASL.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/10 折半查找失败ASL.png" alt></p>
<h5 id="分块查找"><a href="#分块查找" class="headerlink" title="分块查找"></a>分块查找</h5><p>分块查找又称为索引顺序查找</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/11 分块查找概念.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/12 分块查找思路.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/13 分块查找ASL.png" alt></p>
<h5 id="二叉排序树"><a href="#二叉排序树" class="headerlink" title="二叉排序树"></a>二叉排序树</h5><p><img src="/2019/05/26/数据结构/6 查找/查找/14 二叉排序树概念.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/15 二叉排序树查找思路.png" alt></p>
<p>二叉排序树查找递归代码</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/16 二叉排序树查找递归代码.png" alt></p>
<p>二叉排序树查找非递归代码</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/17 二叉排序树非递归代码.png" alt></p>
<p>二叉排序树插入关键字代码</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/18 二叉排序树插入关键字.png" alt></p>
<p>时间复杂度</p>
<p>有n个结点就需要插入n个结点操作，插入一个的时间复杂度为O(log<sub>2</sub>n)，构造复杂度为O(nlog2n)</p>
<p>二叉排序树构造代码</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/19 二叉排序树构造代码.png" alt></p>
<p>二叉排序树删除结点</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/20 二叉排序树删除结点.png" alt></p>
<p>删除叶子结点</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/21 二叉排序树删除叶子结点.png" alt></p>
<p>删除只有左子树或者右子树的结点</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/22 二叉排序树删除只有左子树或右子树结点.png" alt></p>
<p>删除左右子树都有的结点</p>
<p>找到该结点的前驱和后继(即中序遍历的前驱和后继)</p>
<p>前驱替代结点</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/23 二叉排序树删除左右子树都有的结点1.png" alt></p>
<p>后继替代结点</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/24 二叉排序树删除左右子树都有的结点2.png" alt></p>
<p>二叉排序树分析</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/25 二叉排序树分析.png" alt></p>
<h5 id="平衡二叉树-AVL树"><a href="#平衡二叉树-AVL树" class="headerlink" title="平衡二叉树(AVL树)"></a>平衡二叉树(AVL树)</h5><p><img src="/2019/05/26/数据结构/6 查找/查找/26 平衡二叉树.png" alt></p>
<p>最小不平衡子树</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/27 最小不平衡子树.png" alt></p>
<p>不平衡二叉树类型</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/28 最小不平衡子树类型.png" alt></p>
<p>构建平衡二叉树过程</p>
<p>LL调整</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/29 构建平衡二叉树1.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/30 构建平衡二叉树2.png" alt></p>
<p>RR调整</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/31 构建平衡二叉树3.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/32 构建平衡二叉树4.png" alt></p>
<p>RL调整</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/33 构建平衡二叉树5.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/34 构建平衡二叉树6.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/35 构建平衡二叉树7.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/36 构建平衡二叉树8.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/37 构建平衡二叉树9.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/38 构建平衡二叉树10.png" alt></p>
<p>平衡二叉树结点规律</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/39 平衡二叉树结点规律.png" alt></p>
<h5 id="B树和B-树"><a href="#B树和B-树" class="headerlink" title="B树和B+树"></a>B树和B+树</h5><p>2-3树：</p>
<p>2-3是一种多路查找树：2和3的意思就是2-3树包含两种结点</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/40 2-3树.png" alt></p>
<p>2-3-4树：<br><img src="/2019/05/26/数据结构/6 查找/查找/41 2-3-4树.png" alt></p>
<p>B树</p>
<p>磁盘管理系统中的目录管理，以及数据库系统中的索引组织多数都采用B树数据结构</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/42 B树.png" alt></p>
<p>B树查找操作</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/43 B树查找操作.png" alt></p>
<p>B树插入操作</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/44 B树插入操作.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/45 B树插入操作2.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/46 B树插入操作3.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/47 B树插入操作4.png" alt></p>
<p>B树删除操作</p>
<p>删除的关键字在终端结点上(最底层非叶子结点)</p>
<p>第一种情况</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/48 B树删除操作1.png" alt></p>
<p>第二种情况</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/49 B树删除操作2-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/50 B树删除操作2-2.png" alt></p>
<p>第三中情况</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/51 B树删除操作3-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/52 B树删除操作3-2.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/53 B树删除操作3-3.png" alt></p>
<p>删除关键字不在终端结点上(最底层非叶子结点)</p>
<p>第一种情况</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/54 B树删除操作4-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/55 B树删除操作4-2.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/56 B树删除操作4-3.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/57 B树删除操作4-4.png" alt></p>
<p>第二种情况</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/58 B树删除操作5-1.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/59 B树删除操作5-2.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/60 B树删除操作5-3.png" alt></p>
<p>B+树</p>
<p>B+树是B树的变形树，适合用于文件索引系统</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/61 B+树.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/62 B+树与B树区别.png" alt></p>
<h5 id="散列表"><a href="#散列表" class="headerlink" title="散列表"></a>散列表</h5><p>散列表基本概念</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/63 散列表基本概念.png" alt></p>
<p>散列函数和冲突处理方法</p>
<p>常用Hash函数的构造方法</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/64 散列表Hash函数构造方法.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/65 散列表Hash函数构造方法2.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/66 散列表Hash函数构造方法3.png" alt></p>
<p>常用Hash函数的冲突处理方法</p>
<p>开放地址法</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/67 散列表冲突处理.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/68 散列表冲突处理2.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/69 散列表冲突处理3.png" alt></p>
<p>拉链法(链地址法)</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/70 散列表冲突处理4.png" alt></p>
<p>散列表的查找过程和性能</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/71 散列表查找过程和性能.png" alt></p>
<p>散列表实例</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/72 散列表实例.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/73 散列表实例2.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/74 散列表实例3.png" alt></p>
<p>ASL计算方式：查找成功ASL看关键字，查找失败ASL看地址个数</p>
<p>开放地址法(线性探测再散列法)计算ASL：<a href="https://blog.csdn.net/wangran51/article/details/8826633/" target="_blank" rel="noopener">https://blog.csdn.net/wangran51/article/details/8826633/</a></p>
<h5 id="KMP算法"><a href="#KMP算法" class="headerlink" title="KMP算法"></a>KMP算法</h5><p>KMP算法是用于解决字符串模式匹配的问题，字符串的模式匹配，是求一个字符串（模式串）在另一个字符串（主串）中的位置</p>
<p>BF(Brute-Force)算法</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/75 字符串模式匹配.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/76 BF算法代码.png" alt></p>
<p>BF算法效率O(n*m)</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/77 BF算法效率.png" alt></p>
<p>KMP算法</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/78 KMP算法.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/79 KMP算法2.png" alt></p>
<p>KMP算法next数组</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/80 KMP算法next数组.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/81 KMP算法next数组代码.png" alt></p>
<p>next例子情况</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/82 KMP算法next数组例子.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/83 KMP算法next数组例子2.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/84 KMP算法next数组例子3.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/85 KMP算法next数组例子4.png" alt></p>
<p>当P[k] == P[j]时，</p>
<p>有next[j+1] == next[j] + 1</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/86 next数组例子5.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/87 next数组例子6.png" alt></p>
<p>当P[k] != P[j]</p>
<p>像上边的例子，我们已经不可能找到[ A，B，A，B ]这个最长的后缀串了，但我们还是可能找到[ A，B ]、[ B ]这样的前缀串的。所以这个过程像不像在定位[ A，B，A，C ]这个串，当C和主串不一样了（也就是k位置不一样了），那当然是把指针移动到next[k]啦。</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/88 next数组例子7.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/89 next数组例子8.png" alt></p>
<p>KMP算法代码</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/90 KMP算法代码.png" alt></p>
<p>KMP算法效率</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/91 KMP算法效率.png" alt></p>
<p>手动求解next数组的值</p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/92 KMP算法手动next数组1.png" alt></p>
<p><img src="/2019/05/26/数据结构/6 查找/查找/93 KMP算法手动next数组2.png" alt></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://benyzheng.github.io/2019/05/26/数据结构/7 排序/排序/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Beny">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Beny's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/26/数据结构/7 排序/排序/" class="post-title-link" itemprop="url">排序</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

             
                
              

              <time title="创建时间：2019-05-26 12:12:57" itemprop="dateCreated datePublished" datetime="2019-05-26T12:12:57+08:00">2019-05-26 12:12:57</time>
            

            
              
            <!--  old version
              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
              <time title="修改时间：2019-10-23 14:04:58" itemprop="dateModified" datetime="2019-10-23T14:04:58+08:00">2019-10-23</time> 
              -->
              <!-- new version -->
                        
            <span class="post-updated">
                
                  <span class="post-meta-divider">|</span>
                  

                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-check-o"></i>
                  </span>
                  
                    <span class="post-meta-item-text">更新于</span>
                
              <time itemprop="dateUpdated" datetime="2019-10-23T14:04:58+08:00" content="2019-10-23">
                2019-10-23 14:04:58
              </time>
            </span>
          
            
          </span>


          
          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/05/26/数据结构/7 排序/排序/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/05/26/数据结构/7 排序/排序/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p>排序就是将原本无序的序列重新排列成有序的序列</p>
<p>排序的稳定性</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/1 排序稳定性.png" alt></p>
<p>内部排序：指的是待排序记录全部存放在计算机内存中进行排序的过程</p>
<p>外部排序：指的是待排序的记录的数量很大，以致内存一次不能容纳全部记录，在排序过程中尚需要对外存进行访问的排序过程</p>
<p>内部排序分类</p>
<ul>
<li>插入类：将无序子序列中的一个或几个记录插入到有序序列中，从而增加记录的有序子序列的长度，包括直接插入排序、折半插入排序、希尔排序</li>
<li>交换类：通过交换无序序列中的记录从而得到其中关键字最小或最大的记录，并将它加入到有序子序列中，以此方法增加记录的有序子序列的长度，包括冒泡排序和快速排序</li>
<li>选择类：从记录的无序子序列中选择关键字最小或最大的记录，并将它加入到有序子序列中，以此方法增加有序子序列的长度，包括简单选择排序、树形选择排序、堆排序</li>
<li><p>归并类：通过归并两个或两个以上的记录有序子序列，逐步增加记录有序序列的长度，包括2路归并排序</p>
</li>
<li><p>分配类：是唯一一类不需要关键字之间的比较的排序方法，排序时主要利用分配和收集两种基本操作完成。基数排序是主要的分配类排序</p>
</li>
</ul>
<h5 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h5><h6 id="直接插入排序"><a href="#直接插入排序" class="headerlink" title="直接插入排序"></a>直接插入排序</h6><p><img src="/2019/05/26/数据结构/7 排序/排序/2 直接插入排序代码.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> 插入排序;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 直接插入排序</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InsertSort</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">1</span>;</span><br><span class="line">		Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.println(<span class="string">"请输入需要排序的数字"</span>);</span><br><span class="line">		System.out.println(<span class="string">"01 02 03 04 05 06 07 08 09 10"</span>);</span><br><span class="line">		<span class="keyword">int</span> array[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">11</span>];</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">11</span>) &#123;</span><br><span class="line">			array[i] = sc.nextInt();</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">		InsertSort(array);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> a=<span class="number">1</span>;a&lt;<span class="number">11</span>;a++)</span><br><span class="line">			System.out.print(array[a]+<span class="string">","</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">InsertSort</span><span class="params">(<span class="keyword">int</span> array[])</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i,j;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;array.length;i++) &#123;</span><br><span class="line">			<span class="keyword">if</span>(array[i]&lt;array[i-<span class="number">1</span>]) &#123;</span><br><span class="line">				array[<span class="number">0</span>]=array[i];</span><br><span class="line">				<span class="keyword">for</span>(j=i-<span class="number">1</span>;array[j]&gt;array[<span class="number">0</span>];j--) &#123;</span><br><span class="line">					array[j+<span class="number">1</span>] = array[j];</span><br><span class="line">				&#125;</span><br><span class="line">				array[j+<span class="number">1</span>] = array[<span class="number">0</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>空间时间复杂度</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/3 直接插入排序时间复杂度.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/4 直接插入排序时间复杂度2.png" alt></p>
<p>时间复杂度最好O(n)，最坏O(n<sup>2</sup>)</p>
<p>直接插入排序是<strong>稳定</strong>的</p>
<h6 id="折半查找排序"><a href="#折半查找排序" class="headerlink" title="折半查找排序"></a>折半查找排序</h6><p><img src="/2019/05/26/数据结构/7 排序/排序/5 折半插入排序.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/6 折半插入排序例子.png" alt></p>
<p>折半排序代码</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/7 折半插入排序代码.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> 插入排序;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 	折半插入排序</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 11053</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BinaryInsertSort</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">1</span>;</span><br><span class="line">		Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.println(<span class="string">"请输入需要排序的数字"</span>);</span><br><span class="line">		System.out.println(<span class="string">"01 02 03 04 05 06 07 08 09 10"</span>);</span><br><span class="line">		<span class="keyword">int</span> array[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">11</span>];</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">11</span>) &#123;</span><br><span class="line">			array[i] = sc.nextInt();</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">		BinaryInsertSort(array);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> a=<span class="number">1</span>;a&lt;<span class="number">11</span>;a++)</span><br><span class="line">			System.out.print(array[a]+<span class="string">","</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">BinaryInsertSort</span><span class="params">(<span class="keyword">int</span> array[])</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i,j,mid,low,high;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;array.length;i++) &#123;</span><br><span class="line">			<span class="keyword">if</span>(array[i]&lt;array[i-<span class="number">1</span>]) &#123;</span><br><span class="line">				array[<span class="number">0</span>] = array[i];</span><br><span class="line">				low = <span class="number">1</span>;</span><br><span class="line">				high = i-<span class="number">1</span>;</span><br><span class="line">				<span class="keyword">while</span>(low&lt;=high) &#123;</span><br><span class="line">					mid = (low+high)/<span class="number">2</span>;</span><br><span class="line">					<span class="keyword">if</span>(array[mid]&gt;array[<span class="number">0</span>]) high = mid-<span class="number">1</span>;</span><br><span class="line">					<span class="keyword">else</span> low = mid+<span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">for</span>(j=i-<span class="number">1</span>;j&gt;=high+<span class="number">1</span>;j--)</span><br><span class="line">					array[j+<span class="number">1</span>] = array[j];</span><br><span class="line">				array[high+<span class="number">1</span>] = array[<span class="number">0</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>时间复杂度</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/8 折半插入排序时间复杂度.png" alt></p>
<p>时间复杂度O(n<sup>2</sup>)</p>
<p>折半插入排序是<strong>稳定</strong>的</p>
<h6 id="希尔排序"><a href="#希尔排序" class="headerlink" title="希尔排序"></a>希尔排序</h6><p><img src="/2019/05/26/数据结构/7 排序/排序/9 希尔排序.png" alt></p>
<p>希尔排序过程</p>
<p>第一趟：10个元素取增量10/2=5</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/10 希尔排序第一趟.png" alt></p>
<p>第二趟：5/2向下取整=2</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/11 希尔排序第二趟.png" alt></p>
<p>第三趟：最后增量为1</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/12 希尔排序第三趟.png" alt></p>
<p>希尔排序的时间复杂度</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/13 希尔排序时间复杂度.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/14 希尔排序稳定性.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> 插入排序;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  希尔排序</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 11053</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShellSort</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">1</span>;</span><br><span class="line">		Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.println(<span class="string">"请输入需要排序的数字"</span>);</span><br><span class="line">		System.out.println(<span class="string">"01 02 03 04 05 06 07 08 09 10"</span>);</span><br><span class="line">		<span class="keyword">int</span> array[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">11</span>];</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">11</span>) &#123;</span><br><span class="line">			array[i] = sc.nextInt();</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">		ShellSort(array);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> a=<span class="number">1</span>;a&lt;<span class="number">11</span>;a++)</span><br><span class="line">			System.out.print(array[a]+<span class="string">","</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ShellSort</span><span class="params">(<span class="keyword">int</span> array[])</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> d,i,j;</span><br><span class="line">		<span class="keyword">for</span>(d=array.length/<span class="number">2</span>;d&gt;=<span class="number">1</span>;d=d/<span class="number">2</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span>(i=d+<span class="number">1</span>;i&lt;=array.length-<span class="number">1</span>;i++) &#123;</span><br><span class="line">				<span class="keyword">if</span>(array[i]&lt;array[i-d]) &#123;</span><br><span class="line">					array[<span class="number">0</span>] = array[i];</span><br><span class="line">					<span class="keyword">for</span>(j=i-d;j&gt;<span class="number">0</span>&amp;&amp;array[j]&gt;array[<span class="number">0</span>];j-=d) &#123;</span><br><span class="line">						array[j+d] = array[j];</span><br><span class="line">					&#125;</span><br><span class="line">					array[j+d] = array[<span class="number">0</span>];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>时间复杂度最好<strong>O(n<sup>1.3</sup>)，最坏O(n<sup>2</sup>)</strong>.</p>
<p>希尔排序<strong>不稳定</strong></p>
<h5 id="交换排序"><a href="#交换排序" class="headerlink" title="交换排序"></a>交换排序</h5><p>交换类排序：根据序列中两个元素关键字的比较结果来交换它两在序列中的位置</p>
<h6 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h6><p><img src="/2019/05/26/数据结构/7 排序/排序/15 冒泡排序.png" alt></p>
<p>冒泡排序代码</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/16 冒泡排序代码.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> 交换排序;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  冒泡排序</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 11053</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BubbleSort</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">1</span>;</span><br><span class="line">		Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.println(<span class="string">"请输入需要排序的数字"</span>);</span><br><span class="line">		System.out.println(<span class="string">"01 02 03 04 05 06 07 08 09 10"</span>);</span><br><span class="line">		<span class="keyword">int</span> array[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">11</span>];</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">11</span>) &#123;</span><br><span class="line">			array[i] = sc.nextInt();</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">		BubbleSort(array);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> a=<span class="number">1</span>;a&lt;<span class="number">11</span>;a++)</span><br><span class="line">			System.out.print(array[a]+<span class="string">","</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">BubbleSort</span><span class="params">(<span class="keyword">int</span> array[])</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i,j,temp;</span><br><span class="line">		<span class="keyword">boolean</span> flag;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;array.length;i++) &#123;</span><br><span class="line">			flag=<span class="keyword">false</span>;</span><br><span class="line">			<span class="keyword">for</span>(j=array.length-<span class="number">1</span>;j&gt;i;j--) &#123;</span><br><span class="line">				<span class="keyword">if</span>(array[j-<span class="number">1</span>]&gt;array[j]) &#123;</span><br><span class="line">					temp = array[j];</span><br><span class="line">					array[j] = array[j-<span class="number">1</span>];</span><br><span class="line">					array[j-<span class="number">1</span>] = temp;</span><br><span class="line">					flag = <span class="keyword">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(flag==<span class="keyword">false</span>) <span class="keyword">return</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>冒泡排序时间复杂度<strong>最好O(n)，最坏O(n<sup>2</sup>)</strong>.</p>
<p>冒泡排序<strong>稳定</strong>.</p>
<h6 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h6><p>快速排序是一种基于分治法的排序方法</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/17 快速排序.png" alt></p>
<p>快速排序代码</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/18 快速排序代码1.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/19 快速排序代码2.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/20 快速排序最坏时间复杂度.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/21 快速排序最坏时间复杂度2.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/22 快速排序空间复杂度.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> 交换排序;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 快速排序</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 11053</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickSort</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">1</span>;</span><br><span class="line">		Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.println(<span class="string">"请输入需要排序的数字"</span>);</span><br><span class="line">		System.out.println(<span class="string">"01 02 03 04 05 06 07 08 09 10"</span>);</span><br><span class="line">		<span class="keyword">int</span> array[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">11</span>];</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">11</span>) &#123;</span><br><span class="line">			array[i] = sc.nextInt();</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">		QuickSort(array,<span class="number">1</span>,array.length-<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> a=<span class="number">1</span>;a&lt;<span class="number">11</span>;a++)</span><br><span class="line">			System.out.print(array[a]+<span class="string">","</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">QuickSort</span><span class="params">(<span class="keyword">int</span> array[],<span class="keyword">int</span> low,<span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(low&lt;high) &#123;</span><br><span class="line">			<span class="keyword">int</span> pivotloc = Partition(array,low,high);</span><br><span class="line">			QuickSort(array,low,pivotloc-<span class="number">1</span>);</span><br><span class="line">			QuickSort(array,pivotloc+<span class="number">1</span>,high);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Partition</span><span class="params">(<span class="keyword">int</span> array[],<span class="keyword">int</span> low,<span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> pivot = array[low];</span><br><span class="line">		<span class="keyword">while</span>(low&lt;high) &#123;</span><br><span class="line">			<span class="keyword">while</span>(low&lt;high&amp;&amp;array[high]&gt;=pivot) high--;</span><br><span class="line">			array[low] = array[high];</span><br><span class="line">			<span class="keyword">while</span>(low&lt;high&amp;&amp;array[low]&lt;=pivot) low++;</span><br><span class="line">			array[high] = array[low];</span><br><span class="line">		&#125;</span><br><span class="line">		array[low] = pivot;</span><br><span class="line">		<span class="keyword">return</span> low;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>快速排序时间复杂度最好<strong>O(nlogn)，最坏O(n<sup>2</sup>)</strong>.</p>
<p>序列越乱序，效率越高；序列越有序，效率越低</p>
<p>空间复杂度最好<strong>O(logn)，最坏O(n)</strong>.</p>
<p>快速排序<strong>不稳定</strong>.</p>
<h5 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h5><p><img src="/2019/05/26/数据结构/7 排序/排序/23 选择排序.png" alt></p>
<h6 id="简单选择排序"><a href="#简单选择排序" class="headerlink" title="简单选择排序"></a>简单选择排序</h6><p><img src="/2019/05/26/数据结构/7 排序/排序/24 选择排序代码.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/25 选择排序稳定性.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> 选择排序;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 简单选择排序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SelectSort</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">1</span>;</span><br><span class="line">		Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.println(<span class="string">"请输入需要排序的数字"</span>);</span><br><span class="line">		System.out.println(<span class="string">"01 02 03 04 05 06 07 08 09 10"</span>);</span><br><span class="line">		<span class="keyword">int</span> array[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">11</span>];</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">11</span>) &#123;</span><br><span class="line">			array[i] = sc.nextInt();</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">		SelectSort(array);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> a=<span class="number">1</span>;a&lt;<span class="number">11</span>;a++)</span><br><span class="line">			System.out.print(array[a]+<span class="string">","</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SelectSort</span><span class="params">(<span class="keyword">int</span> array[])</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i,j,min;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;array.length-<span class="number">1</span>;i++) &#123;</span><br><span class="line">			min = i;</span><br><span class="line">			<span class="keyword">for</span>(j=i+<span class="number">1</span>;j&lt;array.length;j++) </span><br><span class="line">				<span class="keyword">if</span>(array[min]&gt;array[j]) min = j;</span><br><span class="line">			<span class="keyword">if</span>(min!=i) &#123;</span><br><span class="line">				array[<span class="number">0</span>] = array[min];</span><br><span class="line">				array[min] = array[i];</span><br><span class="line">				array[i] = array[<span class="number">0</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>简单选择排序时间复杂度O(n<sup>2</sup>)</p>
<p>不稳定，交换会打破顺序</p>
<h6 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h6><p>堆的定义</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/26 堆排序.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/27 堆排序形成.png" alt></p>
<p>大顶堆过程</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/28 大顶堆排序1.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/29 大顶堆排序2.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/30 大顶堆排序3.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/31 大顶堆排序4.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/32 大顶堆排序5.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/33 大顶堆排序6.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/34 大顶堆排序7.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/35 大顶堆排序8.png" alt></p>
<p>堆排序算法</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/36 堆排序算法思路.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/37 堆排序算法.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/38 堆排序算法2.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/39 堆排序时间复杂度.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/40 堆排序时间复杂度2.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/41 堆排序时间复杂度3.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/42 堆排序时间复杂度4.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/43 堆排序时间复杂度5.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> 选择排序;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 堆排序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeadSort</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">1</span>;</span><br><span class="line">		Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.println(<span class="string">"请输入需要排序的数字"</span>);</span><br><span class="line">		System.out.println(<span class="string">"01 02 03 04 05 06 07 08 09 10"</span>);</span><br><span class="line">		<span class="keyword">int</span> array[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">11</span>];</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">11</span>) &#123;</span><br><span class="line">			array[i] = sc.nextInt();</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">		HeadSort(array);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> a=<span class="number">1</span>;a&lt;<span class="number">11</span>;a++)</span><br><span class="line">			System.out.print(array[a]+<span class="string">","</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">HeadSort</span><span class="params">(<span class="keyword">int</span> array[])</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> len = array.length-<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">int</span> i;</span><br><span class="line">		BuildMaxHead(array, len);</span><br><span class="line">		<span class="keyword">for</span>(i=len;i&gt;<span class="number">0</span>;i--) &#123;</span><br><span class="line">			Swap(array,<span class="number">1</span>,i);</span><br><span class="line">			HeadAjust(array,<span class="number">1</span>,i-<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">BuildMaxHead</span><span class="params">(<span class="keyword">int</span> array[],<span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//len=10</span></span><br><span class="line">		<span class="keyword">int</span> i;</span><br><span class="line">		<span class="keyword">for</span>(i=len/<span class="number">2</span>;i&gt;<span class="number">0</span>;i--)</span><br><span class="line">			HeadAjust(array,i,len);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">HeadAjust</span><span class="params">(<span class="keyword">int</span> array[],<span class="keyword">int</span> k,<span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i;</span><br><span class="line">		array[<span class="number">0</span>] = array[k];</span><br><span class="line">		<span class="keyword">for</span>(i=k*<span class="number">2</span>;i&lt;=len;i=i*<span class="number">2</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span>(i&lt;len&amp;&amp;array[i]&lt;array[i+<span class="number">1</span>])</span><br><span class="line">				i++;</span><br><span class="line">			<span class="keyword">if</span>(array[i]&lt;array[<span class="number">0</span>]) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				array[k] = array[i];</span><br><span class="line">				k=i;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		array[k] = array[<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Swap</span><span class="params">(<span class="keyword">int</span> array[],<span class="keyword">int</span> top,<span class="keyword">int</span> bottom)</span> </span>&#123;</span><br><span class="line">		array[<span class="number">0</span>] = array[top];</span><br><span class="line">		array[top] = array[bottom];</span><br><span class="line">		array[bottom] = array[<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>堆排序时间复杂度<strong>O(nlog<sub>2</sub>n)，空间复杂度O(1)</strong>。</p>
<p>堆排序<strong>不稳定</strong>.</p>
<h5 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h5><p><img src="/2019/05/26/数据结构/7 排序/排序/44 归并排序.png" alt></p>
<p>归并排序代码</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/45 归并排序代码.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/46 归并排序代码2.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/47 归并排序时间复杂度.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/49 归并排序空间复杂度.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> 归并排序;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  归并排序</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 11053</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MergeSort</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i=<span class="number">1</span>;</span><br><span class="line">		Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		System.out.println(<span class="string">"请输入需要排序的数字"</span>);</span><br><span class="line">		System.out.println(<span class="string">"01 02 03 04 05 06 07 08 09 10"</span>);</span><br><span class="line">		<span class="keyword">int</span> array[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">11</span>];</span><br><span class="line">		<span class="keyword">while</span>(i&lt;<span class="number">11</span>) &#123;</span><br><span class="line">			array[i] = sc.nextInt();</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">		MergeSort(array,<span class="number">1</span>,array.length-<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> a=<span class="number">1</span>;a&lt;<span class="number">11</span>;a++)</span><br><span class="line">			System.out.print(array[a]+<span class="string">","</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MergeSort</span><span class="params">(<span class="keyword">int</span> array[],<span class="keyword">int</span> low,<span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> mid;</span><br><span class="line">		<span class="keyword">if</span>(low&lt;high) &#123;</span><br><span class="line">			mid = (low+high)/<span class="number">2</span>;</span><br><span class="line">			MergeSort(array,low,mid);</span><br><span class="line">			MergeSort(array,mid+<span class="number">1</span>,high);</span><br><span class="line">			Merge(array,low,mid,high);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> array[],<span class="keyword">int</span> low,<span class="keyword">int</span> mid,<span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i,j,k;</span><br><span class="line">		<span class="keyword">int</span> len = array.length;</span><br><span class="line">		<span class="keyword">int</span> temp[] = <span class="keyword">new</span> <span class="keyword">int</span>[len];</span><br><span class="line">		<span class="keyword">for</span>(k=low;k&lt;=high;k++)</span><br><span class="line">			temp[k] = array[k];</span><br><span class="line">		<span class="keyword">for</span>(i=low,j=mid+<span class="number">1</span>,k=i;i&lt;=mid&amp;&amp;j&lt;=high;k++) &#123;</span><br><span class="line">			<span class="keyword">if</span>(temp[i]&lt;temp[j])</span><br><span class="line">				array[k]=temp[i++];</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				array[k]=temp[j++];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span>(i&lt;=mid) array[k++]=temp[i++];</span><br><span class="line">		<span class="keyword">while</span>(j&lt;=high) array[k++]=temp[j++];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>时间复杂度O(nlogn),空间复杂度O(n)</p>
<p>归并排序稳定</p>
<h5 id="非比较排序"><a href="#非比较排序" class="headerlink" title="非比较排序"></a>非比较排序</h5><h6 id="基数排序-桶排序"><a href="#基数排序-桶排序" class="headerlink" title="基数排序(桶排序)"></a>基数排序(桶排序)</h6><p><img src="/2019/05/26/数据结构/7 排序/排序/50 基数排序.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/51 基数排序1.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/52 基数排序2.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/53 基数排序3.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/54 基数排序4.png" alt></p>
<p>MSD</p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/55 基数排序5.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/56 基数排序6.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/57 基数排序7.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/58 基数排序8.png" alt></p>
<p><img src="/2019/05/26/数据结构/7 排序/排序/59 各排序算法复杂度总结.png" alt></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://benyzheng.github.io/2019/05/16/jvm/JVM概述/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Beny">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Beny's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/16/jvm/JVM概述/" class="post-title-link" itemprop="url">JVM概述</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

             
                
              

              <time title="创建时间：2019-05-16 12:12:57" itemprop="dateCreated datePublished" datetime="2019-05-16T12:12:57+08:00">2019-05-16 12:12:57</time>
            

            
              
            <!--  old version
              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
              <time title="修改时间：2019-10-25 01:21:12" itemprop="dateModified" datetime="2019-10-25T01:21:12+08:00">2019-10-25</time> 
              -->
              <!-- new version -->
                        
            <span class="post-updated">
                
                  <span class="post-meta-divider">|</span>
                  

                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-check-o"></i>
                  </span>
                  
                    <span class="post-meta-item-text">更新于</span>
                
              <time itemprop="dateUpdated" datetime="2019-10-25T01:21:12+08:00" content="2019-10-25">
                2019-10-25 01:21:12
              </time>
            </span>
          
            
          </span>


          
          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JVM/" itemprop="url" rel="index"><span itemprop="name">JVM</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/05/16/jvm/JVM概述/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/05/16/jvm/JVM概述/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a>JVM</h1><h2 id="内存区域-运行时数据区"><a href="#内存区域-运行时数据区" class="headerlink" title="内存区域(运行时数据区)"></a>内存区域(运行时数据区)</h2><h3 id="线程私有"><a href="#线程私有" class="headerlink" title="线程私有"></a>线程私有</h3><h4 id="虚拟机栈"><a href="#虚拟机栈" class="headerlink" title="虚拟机栈"></a>虚拟机栈</h4><p>存储着方法出口，局部变量表、动态链接、操作数栈</p>
<p>局部变量表存储的是方法里面的变量<br>操作数栈的作用就是变量和常量或变量和变量之间的计算，</p>
<h5 id="栈帧"><a href="#栈帧" class="headerlink" title="栈帧"></a>栈帧</h5><h5 id="操作数栈"><a href="#操作数栈" class="headerlink" title="操作数栈"></a>操作数栈</h5><p>主要用于方法内对变量与变量之间的计算，用于计算</p>
<h5 id="方法出口"><a href="#方法出口" class="headerlink" title="方法出口"></a>方法出口</h5><h5 id="局部变量表"><a href="#局部变量表" class="headerlink" title="局部变量表"></a>局部变量表</h5><p>主要存放了编译器可知的各种数据类型（boolean、byte、char、short、int、float、long、double）、对象引用（reference 类型，它不同于对象本身，可能是一个指向对象起始地址的引用指针，也可能是指向一个代表对象的句柄或其他与此对象相关的位置）</p>
<h4 id="本地方法栈"><a href="#本地方法栈" class="headerlink" title="本地方法栈"></a>本地方法栈</h4><h4 id="程序计数器"><a href="#程序计数器" class="headerlink" title="程序计数器"></a>程序计数器</h4><p>介绍<br>当前线程所执行的字节码的行号指示器</p>
<p>作用：<br>字节码解释器通过改变程序计数器来依次读取指令，从而实现代码的流程控制，如：顺序执行、选择、循环、异常处理。</p>
<p>在多线程的情况下，程序计数器用于记录当前线程执行的位置，从而当线程被切换回来的时候能够知道该线程上次运行到哪儿了。</p>
<h3 id="线程共享"><a href="#线程共享" class="headerlink" title="线程共享"></a>线程共享</h3><h4 id="堆"><a href="#堆" class="headerlink" title="堆"></a>堆</h4><p>此内存区域的唯一目的就是存放对象实例，几乎所有的对象实例以及数组都在这里分配内存。    </p>
<h5 id="新生区"><a href="#新生区" class="headerlink" title="新生区"></a>新生区</h5><h6 id="eden-80"><a href="#eden-80" class="headerlink" title="eden 80%"></a>eden 80%</h6><h6 id="from-survivor-10"><a href="#from-survivor-10" class="headerlink" title="from survivor 10%"></a>from survivor 10%</h6><h6 id="to-survivor-10"><a href="#to-survivor-10" class="headerlink" title="to survivor 10%"></a>to survivor 10%</h6><h5 id="老年区"><a href="#老年区" class="headerlink" title="老年区"></a>老年区</h5><h4 id="方法区"><a href="#方法区" class="headerlink" title="方法区"></a>方法区</h4><p>它用于存储已被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据</p>
<h5 id="运行时常量池"><a href="#运行时常量池" class="headerlink" title="运行时常量池"></a>运行时常量池</h5><p>包装类和String：<br>是存在常量池还是堆中的问题</p>
<h6 id="字面量"><a href="#字面量" class="headerlink" title="字面量"></a>字面量</h6><p>####### 文本字符串</p>
<p>####### final常量池</p>
<p>####### 基本数据类型</p>
<h6 id="符号引用"><a href="#符号引用" class="headerlink" title="符号引用"></a>符号引用</h6><p>####### 类和结构的完全限定名</p>
<p>####### 字段名称和描述符</p>
<p>####### 方法名称和描述符</p>
<h5 id="类信息"><a href="#类信息" class="headerlink" title="类信息"></a>类信息</h5><h5 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h5><h5 id="静态变量"><a href="#静态变量" class="headerlink" title="静态变量"></a>静态变量</h5><h3 id="直接内存-非运行时数据区"><a href="#直接内存-非运行时数据区" class="headerlink" title="直接内存(非运行时数据区)"></a>直接内存(非运行时数据区)</h3><h2 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h2><h3 id="堆空间基本结构"><a href="#堆空间基本结构" class="headerlink" title="堆空间基本结构"></a>堆空间基本结构</h3><h4 id="新生代"><a href="#新生代" class="headerlink" title="新生代"></a>新生代</h4><p>对象都会首先在 Eden 区域分配，在一次新生代垃圾回收后，如果对象还存活，则会进入 s1(“To”)，并且对象的年龄还会加 1(Eden 区-&gt;Survivor 区后对象的初始年龄变为 1)。<br>当它的年龄增加到一定程度（默认为 15 岁），就会被晋升到老年代中。对象晋升到老年代的年龄阈值，经过这次GC后，Eden区和”From”区已经被清空。<br>这个时候，”From”和”To”会交换他们的角色，也就是新的”To”就是上次GC前的“From”，新的”From”就是上次GC前的”To”。<br>“To”区被填满之后，会将所有对象移动到年老代中。</p>
<h5 id="eden区"><a href="#eden区" class="headerlink" title="eden区"></a>eden区</h5><h5 id="from-survivor"><a href="#from-survivor" class="headerlink" title="from survivor"></a>from survivor</h5><h5 id="to-survivor"><a href="#to-survivor" class="headerlink" title="to survivor"></a>to survivor</h5><h4 id="老年代"><a href="#老年代" class="headerlink" title="老年代"></a>老年代</h4><h3 id="堆内存分配策略"><a href="#堆内存分配策略" class="headerlink" title="堆内存分配策略"></a>堆内存分配策略</h3><h4 id="对象优先在eden区"><a href="#对象优先在eden区" class="headerlink" title="对象优先在eden区"></a>对象优先在eden区</h4><p>mirror GC在新生代<br>Full/Major GC在老年区</p>
<h4 id="大对象直接进入老年区"><a href="#大对象直接进入老年区" class="headerlink" title="大对象直接进入老年区"></a>大对象直接进入老年区</h4><h4 id="长期存活的对象进入老年代"><a href="#长期存活的对象进入老年代" class="headerlink" title="长期存活的对象进入老年代"></a>长期存活的对象进入老年代</h4><h4 id="动态对象年龄判断"><a href="#动态对象年龄判断" class="headerlink" title="动态对象年龄判断"></a>动态对象年龄判断</h4><h3 id="判断对象死亡"><a href="#判断对象死亡" class="headerlink" title="判断对象死亡"></a>判断对象死亡</h3><h4 id="对象无效判断方法"><a href="#对象无效判断方法" class="headerlink" title="对象无效判断方法"></a>对象无效判断方法</h4><h5 id="引用计数法"><a href="#引用计数法" class="headerlink" title="引用计数法"></a>引用计数法</h5><p>难以解决对象相互引用问题</p>
<h5 id="可达性分析"><a href="#可达性分析" class="headerlink" title="可达性分析"></a>可达性分析</h5><p>通过一系列的称为 “GC Roots” 的对象作为起点，从这些节点开始向下搜索，节点所走过的路径称为引用链，当一个对象到 GC Roots 没有任何引用链相连的话，则证明此对象是不可用的。</p>
<h4 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h4><h5 id="强引用"><a href="#强引用" class="headerlink" title="强引用"></a>强引用</h5><p>以前我们使用的大部分引用实际上都是强引用，这是使用最普遍的引用。如果一个对象具有强引用，那就类似于必不可少的生活用品，垃圾回收器绝不会回收它。当内存空间不足，Java 虚拟机宁愿抛出 OutOfMemoryError 错误，使程序异常终止，也不会靠随意回收具有强引用的对象来解决内存不足问题。</p>
<h5 id="软引用"><a href="#软引用" class="headerlink" title="软引用"></a>软引用</h5><p>如果内存空间足够，垃圾回收器就不会回收它，如果内存空间不足了，就会回收这些对象的内存。只要垃圾回收器没有回收它，该对象就可以被程序使用。软引用可用来实现内存敏感的高速缓存。</p>
<h5 id="弱引用"><a href="#弱引用" class="headerlink" title="弱引用"></a>弱引用</h5><p>弱引用与软引用的区别在于：只具有弱引用的对象拥有更短暂的生命周期。在垃圾回收器线程扫描它所管辖的内存区域的过程中，一旦发现了只具有弱引用的对象，不管当前内存空间足够与否，都会回收它的内存。</p>
<h5 id="虚引用"><a href="#虚引用" class="headerlink" title="虚引用"></a>虚引用</h5><p>与其他几种引用都不同，虚引用并不会决定对象的生命周期。如果一个对象仅持有虚引用，那么它就和没有任何引用一样，在任何时候都可能被垃圾回收。<br>虚引用主要用来跟踪对象被垃圾回收的活动。</p>
<h4 id="判断废弃常量"><a href="#判断废弃常量" class="headerlink" title="判断废弃常量"></a>判断废弃常量</h4><p>假如在常量池中存在字符串 “abc”，如果当前没有任何 String 对象引用该字符串常量的话，就说明常量 “abc” 就是废弃常量，如果这时发生内存回收的话而且有必要的话，”abc” 就会被系统清理出常量池。</p>
<h4 id="判断无用的类"><a href="#判断无用的类" class="headerlink" title="判断无用的类"></a>判断无用的类</h4><p>方法区主要回收的是无用的类</p>
<h5 id="堆中不存在该类的任何实例"><a href="#堆中不存在该类的任何实例" class="headerlink" title="堆中不存在该类的任何实例"></a>堆中不存在该类的任何实例</h5><h5 id="加载该类的类加载器被回收"><a href="#加载该类的类加载器被回收" class="headerlink" title="加载该类的类加载器被回收"></a>加载该类的类加载器被回收</h5><h5 id="该类对应的java-lang-Class对象没有在任何地方被引用，无法在任何地方通过反射访问该类的方法"><a href="#该类对应的java-lang-Class对象没有在任何地方被引用，无法在任何地方通过反射访问该类的方法" class="headerlink" title="该类对应的java.lang.Class对象没有在任何地方被引用，无法在任何地方通过反射访问该类的方法"></a>该类对应的java.lang.Class对象没有在任何地方被引用，无法在任何地方通过反射访问该类的方法</h5><h3 id="垃圾回收算法"><a href="#垃圾回收算法" class="headerlink" title="垃圾回收算法"></a>垃圾回收算法</h3><h4 id="标志-清除算法"><a href="#标志-清除算法" class="headerlink" title="标志-清除算法"></a>标志-清除算法</h4><h5 id="效率问题"><a href="#效率问题" class="headerlink" title="效率问题"></a>效率问题</h5><h5 id="空间问题"><a href="#空间问题" class="headerlink" title="空间问题"></a>空间问题</h5><p>产生大量的空间碎片</p>
<h4 id="复制算法"><a href="#复制算法" class="headerlink" title="复制算法"></a>复制算法</h4><p>解决效率问题<br>分成两块，经过GC之后将存活的对象转移到另一块，该块被全部清除</p>
<h4 id="标志-整理算法"><a href="#标志-整理算法" class="headerlink" title="标志-整理算法"></a>标志-整理算法</h4><p>解决了空间碎片问题<br>与标记清除之后，把存活的对象移到一端，直接清理边界以外的对象</p>
<h4 id="分代收集算法"><a href="#分代收集算法" class="headerlink" title="分代收集算法"></a>分代收集算法</h4><h3 id="垃圾收集器"><a href="#垃圾收集器" class="headerlink" title="垃圾收集器"></a>垃圾收集器</h3><h4 id="Serial收集器"><a href="#Serial收集器" class="headerlink" title="Serial收集器"></a>Serial收集器</h4><p>单线程<br>垃圾收集工作的时候必须暂停其他所有的工作线程（ “Stop The World” ）</p>
<h5 id="新生代复制算法"><a href="#新生代复制算法" class="headerlink" title="新生代复制算法"></a>新生代复制算法</h5><h5 id="老年代标记-整理算法"><a href="#老年代标记-整理算法" class="headerlink" title="老年代标记-整理算法"></a>老年代标记-整理算法</h5><h4 id="Parnew收集器"><a href="#Parnew收集器" class="headerlink" title="Parnew收集器"></a>Parnew收集器</h4><p>GC线程多线程并发</p>
<h5 id="新生代复制算法-1"><a href="#新生代复制算法-1" class="headerlink" title="新生代复制算法"></a>新生代复制算法</h5><h5 id="老年代标记-整理算法-1"><a href="#老年代标记-整理算法-1" class="headerlink" title="老年代标记-整理算法"></a>老年代标记-整理算法</h5><h4 id="Paraller-Scavenge收集器"><a href="#Paraller-Scavenge收集器" class="headerlink" title="Paraller Scavenge收集器"></a>Paraller Scavenge收集器</h4><p>Paraller Scavenge和Parnew的区别：<br>Parallel Scavenge 收集器关注点是吞吐量（高效率的利用 CPU）</p>
<h5 id="新生代复制算法-2"><a href="#新生代复制算法-2" class="headerlink" title="新生代复制算法"></a>新生代复制算法</h5><h5 id="老年代标记-整理算法-2"><a href="#老年代标记-整理算法-2" class="headerlink" title="老年代标记-整理算法"></a>老年代标记-整理算法</h5><h4 id="Serial-Old收集器"><a href="#Serial-Old收集器" class="headerlink" title="Serial Old收集器"></a>Serial Old收集器</h4><p>Serial 收集器的老年代版本，它同样是一个单线程收集器。它主要有两大用途：一种用途是在 JDK1.5 以及以前的版本中与 Parallel Scavenge 收集器搭配使用，另一种用途是作为 CMS 收集器的后备方案。</p>
<h4 id="Parallel-Scavenge-收集器"><a href="#Parallel-Scavenge-收集器" class="headerlink" title="Parallel Scavenge 收集器"></a>Parallel Scavenge 收集器</h4><p>Parallel Scavenge 收集器的老年代版本。使用多线程和“标记-整理”算法。在注重吞吐量以及 CPU 资源的场合，都可以优先考虑 Parallel Scavenge 收集器和 Parallel Old 收集器。</p>
<h4 id="CMS收集器"><a href="#CMS收集器" class="headerlink" title="CMS收集器"></a>CMS收集器</h4><p>是什么？<br>CMS（Concurrent Mark Sweep）收集器是一种以获取最短回收停顿时间为目标的收集器</p>
<p>CMS（Concurrent Mark Sweep）收集器是HotSpot虚拟机第一款真正意义上的并发收集器，它第一次实现了让垃圾收集线程与用户线程（基本上）同时工作。<br>CMS 收集器是一种 “标记-清除”算法实现的    </p>
<h5 id="初始标记"><a href="#初始标记" class="headerlink" title="初始标记"></a>初始标记</h5><p> 暂停所有的其他线程，并记录下直接与 root 相连的对象，速度很快 ；</p>
<h5 id="并发标记"><a href="#并发标记" class="headerlink" title="并发标记"></a>并发标记</h5><p>同时开启 GC 和用户线程，用一个闭包结构去记录可达对象。但在这个阶段结束，这个闭包结构并不能保证包含当前所有的可达对象。</p>
<p>因为用户线程可能会不断的更新引用域，所以 GC 线程无法保证可达性分析的实时性。所以这个算法里会跟踪记录这些发生引用更新的地方。</p>
<h5 id="重新标记"><a href="#重新标记" class="headerlink" title="重新标记"></a>重新标记</h5><p>重新标记阶段就是为了修正并发标记期间因为用户程序继续运行而导致标记产生变动的那一部分对象的标记记录，这个阶段的停顿时间一般会比初始标记阶段的时间稍长，远远比并发标记阶段时间短</p>
<h5 id="并发清除"><a href="#并发清除" class="headerlink" title="并发清除"></a>并发清除</h5><p>开启用户线程，同时 GC 线程开始对为标记的区域做清扫。</p>
<h5 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h5><p>主要优点：并发收集、低停顿。</p>
<p>但是它有下面三个明显的缺点：<br>对 CPU 资源敏感；（需要多cpu）<br>无法处理浮动垃圾；<br>它使用的回收算法-“标记-清除”算法会导致收集结束时会有大量空间碎片产生。</p>
<h4 id="G1算法"><a href="#G1算法" class="headerlink" title="G1算法"></a>G1算法</h4><p>G1 (Garbage-First) 是一款面向服务器的垃圾收集器,主要针对配备多颗处理器及大容量内存的机器. 以极高概率满足 GC 停顿时间要求的同时,还具备高吞吐量性能特征.</p>
<p>特点：<br>1.并行与并发<br>2.分代收集<br>3.空间整合（整体看是标记-整理，局部是复制算法）<br>4.可预测停顿</p>
<h5 id="初始标记-1"><a href="#初始标记-1" class="headerlink" title="初始标记"></a>初始标记</h5><h5 id="并发标记-1"><a href="#并发标记-1" class="headerlink" title="并发标记"></a>并发标记</h5><h5 id="最终标记"><a href="#最终标记" class="headerlink" title="最终标记"></a>最终标记</h5><h5 id="筛选回收"><a href="#筛选回收" class="headerlink" title="筛选回收"></a>筛选回收</h5><h2 id="JDK监控和故障处理"><a href="#JDK监控和故障处理" class="headerlink" title="JDK监控和故障处理"></a>JDK监控和故障处理</h2><h2 id="类文件结构"><a href="#类文件结构" class="headerlink" title="类文件结构"></a>类文件结构</h2><p>在 Java 中，JVM 可以理解的代码就叫做字节码（即扩展名为 .class 的文件），它不面向任何特定的处理器，只面向虚拟机。</p>
<h3 id="魔数"><a href="#魔数" class="headerlink" title="魔数"></a>魔数</h3><p>每个 Class 文件的头四个字节称为魔数（Magic Number）,它的唯一作用是确定这个文件是否为一个能被虚拟机接收的 Class 文件。</p>
<h3 id="class文件版本"><a href="#class文件版本" class="headerlink" title="class文件版本"></a>class文件版本</h3><p>紧接着魔数的四个字节存储的是 Class 文件的版本号：第五和第六是次版本号，第七和第八是主版本号。</p>
<p>高版本的 Java 虚拟机可以执行低版本编译器生成的 Class 文件，但是低版本的 Java 虚拟机不能执行高版本编译器生成的 Class 文件</p>
<h3 id="常量池"><a href="#常量池" class="headerlink" title="常量池"></a>常量池</h3><h4 id="字面量-1"><a href="#字面量-1" class="headerlink" title="字面量"></a>字面量</h4><p>字面量比较接近于 Java 语言层面的的常量概念，如文本字符串、声明为 final 的常量值等</p>
<h4 id="符号引用-1"><a href="#符号引用-1" class="headerlink" title="符号引用"></a>符号引用</h4><h5 id="类和接口的全限定名"><a href="#类和接口的全限定名" class="headerlink" title="类和接口的全限定名"></a>类和接口的全限定名</h5><h5 id="字段的名称和描述符"><a href="#字段的名称和描述符" class="headerlink" title="字段的名称和描述符"></a>字段的名称和描述符</h5><h5 id="方法的名称和描述符"><a href="#方法的名称和描述符" class="headerlink" title="方法的名称和描述符"></a>方法的名称和描述符</h5><h3 id="访问标志"><a href="#访问标志" class="headerlink" title="访问标志"></a>访问标志</h3><p>这个标志用于识别一些类或者接口层次的访问信息，包括：这个 Class 是类还是接口，是否为 public 或者 abstract 类型，如果是类的话是否声明为 final </p>
<h3 id="类索引"><a href="#类索引" class="headerlink" title="类索引"></a>类索引</h3><p>类索引用于确定这个类的全限定名，父类索引用于确定这个类的父类的全限定名，由于 Java 语言的单继承，所以父类索引只有一个，除了 java.lang.Object 之外，所有的 java 类都有父类，因此除了 java.lang.Object 外，所有 Java 类的父类索引都不为 0。</p>
<p>接口索引集合用来描述这个类实现了那些接口，这些被实现的接口将按implents(如果这个类本身是接口的话则是extends) 后的接口顺序从左到右排列在接口索引集合中。</p>
<h4 id="当前类索引"><a href="#当前类索引" class="headerlink" title="当前类索引"></a>当前类索引</h4><h4 id="父类索引"><a href="#父类索引" class="headerlink" title="父类索引"></a>父类索引</h4><h4 id="接口索引集合"><a href="#接口索引集合" class="headerlink" title="接口索引集合"></a>接口索引集合</h4><h3 id="字段表集合"><a href="#字段表集合" class="headerlink" title="字段表集合"></a>字段表集合</h3><p>字段表（field info）用于描述接口或类中声明的变量。字段包括类级变量以及实例变量，但不包括在方法内部声明的局部变量。</p>
<h3 id="方法表集合"><a href="#方法表集合" class="headerlink" title="方法表集合"></a>方法表集合</h3><p>Class 文件存储格式中对方法的描述与对字段的描述几乎采用了完全一致的方式。方法表的结构如同字段表一样，依次包括了访问标志、名称索引、描述符索引、属性表集合几项。</p>
<h3 id="属性表集合"><a href="#属性表集合" class="headerlink" title="属性表集合"></a>属性表集合</h3><p>在 Class 文件，字段表，方法表中都可以携带自己的属性表集合，以用于描述某些场景专有的信息。</p>
<h2 id="类加载过程"><a href="#类加载过程" class="headerlink" title="类加载过程"></a>类加载过程</h2><p>Class 文件需要加载到虚拟机中之后才能运行和使用</p>
<p>系统加载 Class 类型的文件主要三步:加载-&gt;连接-&gt;初始化。        </p>
<p>连接过程又可分为三步:验证-&gt;准备-&gt;解析。</p>
<h3 id="加载"><a href="#加载" class="headerlink" title="加载"></a>加载</h3><p>一个非数组类的加载阶段（加载阶段获取类的二进制字节流的动作）是可控性最强的阶段</p>
<p>这一步我们可以去完成还可以自定义类加载器去控制字节流的获取方式（重写一个类加载器的 loadClass() 方法）。数组类型不通过类加载器创建，它由 Java 虚拟机直接创建。</p>
<h4 id="通过全限定名加载字符流"><a href="#通过全限定名加载字符流" class="headerlink" title="通过全限定名加载字符流"></a>通过全限定名加载字符流</h4><h4 id="通过静态的字符流转换方法区运行时的数据结构"><a href="#通过静态的字符流转换方法区运行时的数据结构" class="headerlink" title="通过静态的字符流转换方法区运行时的数据结构"></a>通过静态的字符流转换方法区运行时的数据结构</h4><h4 id="在内存中生成一个代表该类的对象，作为方法区数据访问接口"><a href="#在内存中生成一个代表该类的对象，作为方法区数据访问接口" class="headerlink" title="在内存中生成一个代表该类的对象，作为方法区数据访问接口"></a>在内存中生成一个代表该类的对象，作为方法区数据访问接口</h4><h3 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h3><h4 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h4><h5 id="文件格式验证"><a href="#文件格式验证" class="headerlink" title="文件格式验证"></a>文件格式验证</h5><h5 id="元数据验证"><a href="#元数据验证" class="headerlink" title="元数据验证"></a>元数据验证</h5><h5 id="字节码验证"><a href="#字节码验证" class="headerlink" title="字节码验证"></a>字节码验证</h5><h5 id="符号引用验证"><a href="#符号引用验证" class="headerlink" title="符号引用验证"></a>符号引用验证</h5><h4 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h4><p>准备阶段是正式为类变量分配内存并设置类变量初始值的阶段，这些内存都将在方法区中分配。</p>
<p>对于该阶段有以下几点需要注意：</p>
<p>1.这时候进行内存分配的仅包括类变量（static），而不包括实例变量，实例变量会在对象实例化时随着对象一块分配在 Java 堆中。<br>2.这里所设置的初始值”通常情况”下是数据类型默认的零值（如0、0L、null、false等），比如我们定义了public static int value=111 ，那么 value 变量在准备阶段的初始值就是 0 而不是111（初始化阶段才会复制）。特殊情况：比如给 value 变量加上了 fianl 关键字public static final int value=111 ，那么准备阶段 value 的值就被复制为 111。</p>
<h4 id="解析"><a href="#解析" class="headerlink" title="解析"></a>解析</h4><p>解析阶段是虚拟机将常量池内的符号引用替换为直接引用的过程。</p>
<p>解析动作主要针对类或接口、字段、类方法、接口方法、方法类型、方法句柄和调用限定符7类符号引用进行。</p>
<p>解析阶段是虚拟机将常量池内的符号引用替换为直接引用的过程，也就是得到类或者字段、方法在内存中的指针或者偏移量。</p>
<h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>初始化是类加载的最后一步，也是真正执行类中定义的 Java 程序代码(字节码)，初始化阶段是执行类构造器 <clinit> ()方法的过程。</clinit></p>
<p>对于<clinit>（） 方法的调用，虚拟机会自己确保其在多线程环境中的安全性。因为 <clinit>（） 方法是带锁线程安全，所以在多线程环境下进行类初始化的话可能会引起死锁，并且这种死锁很难被发现。</clinit></clinit></p>
<h4 id="五种情况必须对类初始化"><a href="#五种情况必须对类初始化" class="headerlink" title="五种情况必须对类初始化"></a>五种情况必须对类初始化</h4><p>1.当遇到 new 、 getstatic、putstatic或invokestatic 这4条直接码指令时，比如 new 一个类，读取一个静态字段(未被 final 修饰)、或调用一个类的静态方法时。</p>
<p>2.使用 java.lang.reflect 包的方法对类进行反射调用时 ，如果类没初始化，需要触发其初始化。</p>
<p>3.初始化一个类，如果其父类还未初始化，则先触发该父类的初始化。</p>
<p>4.当虚拟机启动时，用户需要定义一个要执行的主类 (包含 main 方法的那个类)，虚拟机会先初始化这个类。</p>
<p>5.当使用 JDK1.7 的动态动态语言时，如果一个 MethodHandle 实例的最后解析结构为 REF_getStatic、REF_putStatic、REF_invokeStatic、的方法句柄，并且这个句柄没有初始化，则需要先触发器初始化。</p>
<h2 id="类加载器"><a href="#类加载器" class="headerlink" title="类加载器"></a>类加载器</h2><p>JVM 中内置了三个重要的ClassLoader，除了 BootstrapClassLoader 其他类加载器均由 Java 实现且全部继承自java.lang.ClassLoader：</p>
<h3 id="BootstrapClassLoader"><a href="#BootstrapClassLoader" class="headerlink" title="BootstrapClassLoader"></a>BootstrapClassLoader</h3><p>1、BootstrapClassLoader(启动类加载器) ：最顶层的加载类，由C++实现，负责加载 %JAVA_HOME%/lib目录下的jar包和类或者或被 -Xbootclasspath参数指定的路径中的所有类。</p>
<h3 id="ExtensionClassLoader"><a href="#ExtensionClassLoader" class="headerlink" title="ExtensionClassLoader"></a>ExtensionClassLoader</h3><p>2、ExtensionClassLoader(扩展类加载器) ：主要负责加载目录 %JRE_HOME%/lib/ext 目录下的jar包和类，或被 java.ext.dirs 系统变量所指定的路径下的jar包。</p>
<h3 id="AppClassLoader"><a href="#AppClassLoader" class="headerlink" title="AppClassLoader"></a>AppClassLoader</h3><p>3、AppClassLoader(应用程序类加载器) :面向我们用户的加载器，负责加载当前应用classpath下的所有jar包和类。</p>
<h3 id="双亲委派模型"><a href="#双亲委派模型" class="headerlink" title="双亲委派模型"></a>双亲委派模型</h3><p>每一个类都有一个对应它的类加载器。系统中的 ClassLoder 在协同工作的时候会默认使用 双亲委派模型 。</p>
<p>即在类加载的时候，系统会首先判断当前类是否被加载过。已经被加载的类会直接返回，否则才会尝试加载。加载的时候，首先会把该请求委派该父类加载器的 loadClass() 处理，因此所有的请求最终都应该传送到顶层的启动类加载器 BootstrapClassLoader 中。</p>
<p>当父类加载器无法处理时，才由自己来处理。当父类加载器为null时，会使用启动类加载器 BootstrapClassLoader 作为父类加载器。</p>
<h4 id="双亲委派的好处"><a href="#双亲委派的好处" class="headerlink" title="双亲委派的好处"></a>双亲委派的好处</h4><p>1.双亲委派模型保证了Java程序的稳定运行，可以避免类的重复加载<br>（JVM 区分不同类的方式不仅仅根据类名，相同的类文件被不同的类加载器加载产生的是两个不同的类），也保证了 Java 的核心 API 不被篡改。）</p>
<p>2.如果没有使用双亲委派模型，而是每个类加载器加载自己的话就会出现一些问题，比如我们编写一个称为 java.lang.Object 类的话，那么程序运行的时候，系统就会出现多个不同的 Object 类。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Beny">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Beny's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/26/JavaWeb知识/JavaWeb/" class="post-title-link" itemprop="url">JavaWeb知识总结</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

             
                
              

              <time title="创建时间：2019-01-26 00:00:00" itemprop="dateCreated datePublished" datetime="2019-01-26T00:00:00+08:00">2019-01-26 00:00:00</time>
            

            
              
            <!--  old version
              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
              <time title="修改时间：2019-10-26 22:00:58" itemprop="dateModified" datetime="2019-10-26T22:00:58+08:00">2019-10-26</time> 
              -->
              <!-- new version -->
                        
            <span class="post-updated">
                
                  <span class="post-meta-divider">|</span>
                  

                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-check-o"></i>
                  </span>
                  
                    <span class="post-meta-item-text">更新于</span>
                
              <time itemprop="dateUpdated" datetime="2019-10-26T22:00:58+08:00" content="2019-10-26">
                2019-10-26 22:00:58
              </time>
            </span>
          
            
          </span>


          
          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaEE/" itemprop="url" rel="index"><span itemprop="name">JavaEE</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/01/26/JavaWeb知识/JavaWeb/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/01/26/JavaWeb知识/JavaWeb/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h1><p><strong>XML的作用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.可以用来保存数据</span><br><span class="line">2.可以用来配置文件</span><br><span class="line">3.数据传输载体</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/Snipaste_2018-10-19_20-33-45.png" alt></p>
<p><strong>定义xml</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">文档声明</span><br><span class="line">	简单声明，version:解析这个xml使用什么版本的解析器解析</span><br><span class="line">		&lt;?xml version=&quot;1.0&quot; ?&gt;</span><br><span class="line">	encoding:解析xml文字使用什么编码来翻译，电脑上的文件在保存时是存储文字对应的二进制，这些文字对应	  的二进制使用编码解析得到</span><br><span class="line">		&lt;?xml version=&quot;1.0&quot; encoding=&quot;gbk(UTF-8)&quot;?&gt;</span><br><span class="line">	standalone:no---文档会依赖关联其他文档，yes---这是一个独立的文档</span><br><span class="line">		&lt;?xml version=&quot;1.0&quot; encoding=&quot;gbk(UTF-8)&quot; standalone=&quot;no&quot;?&gt;</span><br></pre></td></tr></table></figure>
<p><strong>元素定义</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.&lt;&gt;里面都是元素，成对出现，如：&lt;stu&gt;&lt;/stu&gt;</span><br><span class="line">2.文档声明第一个出现的元素是根元素</span><br><span class="line">3.空标签&lt;age/&gt;,开始也是结束，里面可以写属性</span><br><span class="line">4.标签可以自定义</span><br></pre></td></tr></table></figure>
<p><strong>注释</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- --&gt;与HTML注释一样</span><br></pre></td></tr></table></figure>
<p><strong>CDATA区</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/Snipaste_2018-10-19_20-37-53.png" alt></p>
<p><strong>XML解析方式</strong>(常用两种DOM&amp;SAX)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">获取元素里面的字符或者属性数据</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/parse_type.png" alt></p>
<p><strong>XML解析手段</strong>(DOM4J&amp;JDOM)</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/Snipaste_2018-10-19_20-49-08.png" alt></p>
<p><strong>DOM4J 基本用法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">element.element(&quot;stu&quot;);//返回该元素下的第一个stu元素</span><br><span class="line">element.elements();//返回该元素下的所有子元素</span><br><span class="line">1.创建SAXReader对象</span><br><span class="line">2.指定解析的xml</span><br><span class="line">3.获取根元素</span><br><span class="line">4.根据根元素获取子元素或者下面的子孙元素</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.dom4j.Document;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.Element;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.io.SAXReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainTest</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//1.创建sax读取对象</span></span><br><span class="line">			SAXReader reader = <span class="keyword">new</span> SAXReader();<span class="comment">//jdbc --classloader</span></span><br><span class="line">			<span class="comment">//2.指定解析的xml源 </span></span><br><span class="line">			Document document = reader.read(<span class="keyword">new</span> File(<span class="string">"src/xml/stus.xml"</span>));</span><br><span class="line">			<span class="comment">//3.得到元素</span></span><br><span class="line">			Element rootElement = document.getRootElement();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//获取根元素下面的子元素</span></span><br><span class="line">			<span class="comment">//System.out.println(rootElement.element("stu").element("age").getText()); </span></span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			List&lt;Element&gt; elements = rootElement.elements();</span><br><span class="line">			<span class="keyword">for</span>(Element element : elements) &#123;</span><br><span class="line">				String name = element.element(<span class="string">"name"</span>).getText();</span><br><span class="line">				String age = element.element(<span class="string">"age"</span>).getText();</span><br><span class="line">				String address = element.element(<span class="string">"address"</span>).getText();</span><br><span class="line">				System.out.println(<span class="string">"name:"</span>+name+<span class="string">"--"</span>+<span class="string">"age:"</span>+age+<span class="string">"--"</span>+<span class="string">"address:"</span>+address);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Dom4J的Xpath使用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; dom4j里面支持Xpath的写法。xpath其实是xml的路径语言，支持我们在解析xml的时候定位到一个具体的元素。</span><br><span class="line">1.添加jar包依赖</span><br><span class="line">	jaxen-1.1-beta-6.jar</span><br><span class="line">2.在查找指定节点的时候，根据xpath语法规则来查找</span><br><span class="line">3.后续的代码与以前的解析代码一样</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.dom4j.Document;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.Element;</span><br><span class="line"><span class="keyword">import</span> org.dom4j.io.SAXReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XpathTest</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//1.创建sax读取对象</span></span><br><span class="line">			SAXReader reader = <span class="keyword">new</span> SAXReader();<span class="comment">//jdbc --classloader</span></span><br><span class="line">			<span class="comment">//2.指定解析的xml源 </span></span><br><span class="line">			Document document = reader.read(<span class="keyword">new</span> File(<span class="string">"src/xml/stus.xml"</span>));</span><br><span class="line">			<span class="comment">//3.得到元素</span></span><br><span class="line">			Element rootElement = document.getRootElement();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 要想使用Xpath，还得添加支持的jar 获取第一个只返回第一个</span></span><br><span class="line">			Element nameElement = (Element) rootElement.selectSingleNode(<span class="string">"//name"</span>);</span><br><span class="line">			System.out.println(nameElement.getText());</span><br><span class="line">			</span><br><span class="line">			System.out.println(<span class="string">"####################"</span>);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//获取文档中所有的name元素</span></span><br><span class="line">			List&lt;Element&gt; list = rootElement.selectNodes(<span class="string">"//name"</span>);</span><br><span class="line">			<span class="keyword">for</span>(Element element : list) &#123;</span><br><span class="line">				System.out.println(element.getText());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>约束</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">属性ID规定唯一或者元素只能出现一次</span><br><span class="line">DTD：</span><br><span class="line">	语法可读性差</span><br><span class="line">	1. 引入网络上的DTD</span><br><span class="line"></span><br><span class="line">   &lt;!-- 引入dtd 来约束这个xml --&gt;</span><br><span class="line"></span><br><span class="line">   	&lt;!--    文档类型  根标签名字 网络上的dtd   dtd的名称   dtd的路径</span><br><span class="line"></span><br><span class="line">   	&lt;!DOCTYPE stus PUBLIC &quot;//UNKNOWN/&quot; &quot;unknown.dtd&quot;&gt; --&gt;</span><br><span class="line"></span><br><span class="line">	1. 引入本地的DTD</span><br><span class="line"></span><br><span class="line">   &lt;!-- 引入本地的DTD  ： 根标签名字 引入本地的DTD  dtd的位置 --&gt;</span><br><span class="line">   &lt;!-- &lt;!DOCTYPE stus SYSTEM &quot;stus.dtd&quot;&gt; --&gt;</span><br><span class="line"></span><br><span class="line">	2. 直接在XML里面嵌入DTD的约束规则</span><br><span class="line"></span><br><span class="line">       &lt;!-- xml文档里面直接嵌入DTD的约束法则 --&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!DOCTYPE stus [</span><br><span class="line">            &lt;!ELEMENT stus (stu)&gt;</span><br><span class="line">            &lt;!ELEMENT stu (name,age)&gt;</span><br><span class="line">            &lt;!ELEMENT name (#PCDATA)&gt;</span><br><span class="line">            &lt;!ELEMENT age (#PCDATA)&gt;</span><br><span class="line">        ]&gt;</span><br><span class="line"></span><br><span class="line">        &lt;stus&gt;</span><br><span class="line">            &lt;stu&gt;</span><br><span class="line">                &lt;name&gt;张三&lt;/name&gt;</span><br><span class="line">                &lt;age&gt;18&lt;/age&gt;</span><br><span class="line">            &lt;/stu&gt;</span><br><span class="line">        &lt;/stus&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!ELEMENT stus (stu)&gt;  : stus 下面有一个元素 stu  ， 但是只有一个</span><br><span class="line">	&lt;!ELEMENT stu (name , age)&gt;  stu下面有两个元素 name  ,age  顺序必须name-age</span><br><span class="line">	&lt;!ELEMENT name (#PCDATA)&gt; </span><br><span class="line">	&lt;!ELEMENT age (#PCDATA)&gt;</span><br><span class="line">	&lt;!ATTLIST stu id CDATA #IMPLIED&gt; stu有一个属性 文本类型， 该属性可有可无</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	元素的个数：</span><br><span class="line"></span><br><span class="line">		＋　一个或多个</span><br><span class="line">		*  零个或多个</span><br><span class="line">		? 零个或一个</span><br><span class="line"></span><br><span class="line">	属性的类型定义 </span><br><span class="line"></span><br><span class="line">		CDATA : 属性是普通文字</span><br><span class="line">		ID : 属性的值必须唯一</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!ELEMENT stu (name , age)&gt;		按照顺序来 </span><br><span class="line">	&lt;!ELEMENT stu (name | age)&gt;   两个中只能包含一个子元素</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">Schema：</span><br><span class="line">	其实就是一个xml，使用xml的语法规则，xml解析器解析方便，是为了替代DTD</span><br><span class="line">	但是Scheme约束文本内容比DTD的内容还要多，所以没有真正意思上的替代DTD</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">约束文档：</span><br><span class="line">	&lt;!-- xmlns  :  xml namespace : 名称空间 /  命名空间</span><br><span class="line">	targetNamespace :  目标名称空间 。 下面定义的那些元素都与这个名称空间绑定上。 </span><br><span class="line">	elementFormDefault ： 元素的格式化情况。  --&gt;</span><br><span class="line">	&lt;schema xmlns=&quot;http://www.w3.org/2001/XMLSchema&quot; </span><br><span class="line">		targetNamespace=&quot;http://www.itheima.com/teacher&quot; </span><br><span class="line">		elementFormDefault=&quot;qualified&quot;&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;element name=&quot;teachers&quot;&gt;</span><br><span class="line">			&lt;complexType&gt;</span><br><span class="line">				&lt;sequence maxOccurs=&quot;unbounded&quot;&gt;</span><br><span class="line">					&lt;!-- 这是一个复杂元素 --&gt;</span><br><span class="line">					&lt;element name=&quot;teacher&quot;&gt;</span><br><span class="line">						&lt;complexType&gt;</span><br><span class="line">							&lt;sequence&gt;</span><br><span class="line">								&lt;!-- 以下两个是简单元素 --&gt;</span><br><span class="line">								&lt;element name=&quot;name&quot; type=&quot;string&quot;&gt;&lt;/element&gt;</span><br><span class="line">								&lt;element name=&quot;age&quot; type=&quot;int&quot;&gt;&lt;/element&gt;</span><br><span class="line">							&lt;/sequence&gt;</span><br><span class="line">						&lt;/complexType&gt;</span><br><span class="line">					&lt;/element&gt;</span><br><span class="line">				&lt;/sequence&gt;</span><br><span class="line">			&lt;/complexType&gt;</span><br><span class="line">		&lt;/element&gt;</span><br><span class="line">	&lt;/schema&gt;</span><br><span class="line"></span><br><span class="line">实例文档：</span><br><span class="line">	&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">	&lt;!-- xmlns:xsi : 这里必须是这样的写法，也就是这个值已经固定了。</span><br><span class="line">	xmlns : 这里是名称空间，也固定了，写的是schema里面的顶部目标名称空间</span><br><span class="line">	xsi:schemaLocation : 有两段： 前半段是名称空间，也是目标空间的值 ， 后面是约束文档的路径。</span><br><span class="line">	 --&gt;</span><br><span class="line">	&lt;teachers</span><br><span class="line">		xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">		xmlns=&quot;http://www.itheima.com/teacher&quot;</span><br><span class="line">		xsi:schemaLocation=&quot;http://www.itheima.com/teacher teacher.xsd&quot;</span><br><span class="line">	&gt;</span><br><span class="line">		&lt;teacher&gt;</span><br><span class="line">			&lt;name&gt;zhangsan&lt;/name&gt;</span><br><span class="line">			&lt;age&gt;19&lt;/age&gt;</span><br><span class="line">		&lt;/teacher&gt;</span><br><span class="line">		&lt;teacher&gt;</span><br><span class="line">			&lt;name&gt;lisi&lt;/name&gt;</span><br><span class="line">			&lt;age&gt;29&lt;/age&gt;</span><br><span class="line">		&lt;/teacher&gt;</span><br><span class="line">		&lt;teacher&gt;</span><br><span class="line">			&lt;name&gt;lisi&lt;/name&gt;</span><br><span class="line">			&lt;age&gt;29&lt;/age&gt;</span><br><span class="line">		&lt;/teacher&gt;</span><br><span class="line">	&lt;/teachers&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##名称空间的作用</span><br><span class="line">一个xml如果想指定它的约束规则， 假设使用的是DTD ，那么这个xml只能指定一个DTD，不能指定多个DTD 。 但是如果一个xml的约束是定义在schema里面，并且是多个schema，那么是可以的。简单的说： 一个xml 可以引用多个schema约束。 但是只能引用一个DTD约束。</span><br><span class="line">名称空间的作用就是在 写元素的时候，可以指定该元素使用的是哪一套约束规则。  默认情况下 ，如果只有一套规则，那么都可以这么写</span><br><span class="line">&lt;name&gt;张三&lt;/name&gt;</span><br><span class="line">&lt;aa:name&gt;&lt;/aa:name&gt;</span><br><span class="line">&lt;bb:name&gt;&lt;/bb:name&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h1><p><strong>程序架构</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C/S（Client/Server）</span><br><span class="line">QQ微信</span><br><span class="line">优点：有一部分代码写在客户端，用户体现差</span><br><span class="line">缺点：服务器更新，客户端跟着更新，占用资源大</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">B/S（browser/Server）</span><br><span class="line">优点：客户端只要有浏览器就行，占用资源少，不用更新</span><br><span class="line">缺点：用户体现不佳</span><br></pre></td></tr></table></figure>
<p><strong>Web服务器</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;其实服务器就是一台电脑，配置比一般的好</span><br><span class="line">&gt;客户端在浏览器的地址栏输入地址，然后web服务器软件，接受请求，然后响应消息</span><br><span class="line">&gt;处理客户端的请求，返回资源|信息</span><br><span class="line">web应用 需要服务器支撑 index.html</span><br></pre></td></tr></table></figure>
<p><strong>Tomcat目录</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">bin</span><br><span class="line">&gt;&gt;jar bat  startup.bat</span><br><span class="line">conf</span><br><span class="line">&gt;&gt;tomcat的配置，server.xml  web.xml</span><br><span class="line">lib</span><br><span class="line">&gt;&gt;tomcat运行所需的jar文件</span><br><span class="line">temp</span><br><span class="line">&gt;&gt;临时文件</span><br><span class="line">webapps</span><br><span class="line">&gt;&gt;存放着发布到tomcat服务器上的项目</span><br><span class="line">work</span><br><span class="line">&gt;&gt;jsp翻译成java文件存放地</span><br></pre></td></tr></table></figure>
<p><strong>发布项目到tomcat</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;需求：如何能让其他电脑访问这台电脑上的资源 stu.xml</span><br><span class="line">&gt;&gt;localhost:8080:本地地址</span><br><span class="line">&gt;&gt;1.拷贝文件到这个webapps/root下，在浏览器访问：</span><br><span class="line">	localhost:8080/stu.xml</span><br><span class="line">&gt;&gt;2.在webapps下新建文件夹xml，然后拷贝文件到该文件夹中</span><br><span class="line">	http://localhost:8080/xml/stu.xml</span><br><span class="line">	http://localhost:8080/xml：对应到webapps/xml</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;3.使用localhost：8080/docs 打开tomcat首页，找到configuration点击进入，再进入左侧找到context（http://localhost:8080/docs/config/context.html）</span><br><span class="line">&gt;&gt;&gt;&gt;配置虚拟路径</span><br><span class="line">&gt;&gt;&gt;&gt;1.在conf/server.xml找到host元素节点</span><br><span class="line">	2. 加入以下内容。</span><br><span class="line">   		&lt;!-- docBase ：  项目的路径地址 如： D:\xml02\person.xml</span><br><span class="line">   		path : 对应的虚拟路径 一定要以/打头。</span><br><span class="line">   		对应的访问方式为： http://localhost:8080/a/person.xml --&gt;</span><br><span class="line">   		&lt;Context docBase=&quot;D:\xml02&quot; path=&quot;/a&quot;&gt;&lt;/Context&gt;</span><br><span class="line">	3. 在浏览器地址栏上输入： http://localhost:8080/a/person.xml</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;4. 配置虚拟路径</span><br><span class="line">&gt;&gt;&gt;&gt;1. 在tomcat/conf/catalina/localhost/ 文件夹下新建一个xml文件，名字	可以自己定义。 person.xml</span><br><span class="line">&gt;&gt;&gt;&gt;2. 在这个文件里面写入以下内容</span><br><span class="line">       &lt;?xml version=&apos;1.0&apos; encoding=&apos;utf-8&apos;?&gt;</span><br><span class="line">            &lt;Context docBase=&quot;D:\xml02&quot;&gt;&lt;/Context&gt;</span><br><span class="line">&gt;&gt;&gt;&gt;3. 在浏览器上面访问</span><br><span class="line">       http://localhost:8080/person/xml的名字即可</span><br></pre></td></tr></table></figure>
<p><strong>eclipse配置tomcat</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1. 在server里面 右键新建一个服务器， 选择到apache分类， 找到对应的tomcat版本， 接着一步一步配置即可。</span><br><span class="line">2. 配置完毕后， 在server 里面， 右键刚才的服务器，然后open  ， 找到上面的Server Location , 选择中间的 Use Tomcat installation...</span><br><span class="line">3. 创建web工程， 在WebContent下定义html文件， 右键工程， run as server </span><br><span class="line">##总结：</span><br><span class="line">xml</span><br><span class="line">	1. 会定义xml</span><br><span class="line">	2. 会解析xml</span><br><span class="line">		dom4j  基本解析</span><br><span class="line">		Xpath手法</span><br><span class="line">tomcat</span><br><span class="line">	1. 会安装 ，会启动 ， 会访问。</span><br><span class="line">	2. 会设置虚拟路径</span><br><span class="line">	3. 给eclipse配置tomcat</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><p><strong>JDBC</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JAVA DataBase Connectivity：java数据库连接</span><br><span class="line">&gt;&gt;为什么出现JDBC</span><br><span class="line">&gt;&gt;&gt;&gt;sun公司规定的一种数据访问规范，由于数据库种类较多，java语言使用广泛，sun公司提供一种，让其他的数据库提供商去实现底层的访问规则。我们的Java程序只要使用sun公司提供的jdbc驱动即可</span><br></pre></td></tr></table></figure>
<p><strong>JDBC入门</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">package com.itheima.test;</span><br><span class="line"></span><br><span class="line">import java.net.URI;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.Driver;</span><br><span class="line">import java.sql.DriverManager;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.sql.Statement;</span><br><span class="line"></span><br><span class="line">public class MainTest &#123;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">	</span><br><span class="line">		 </span><br><span class="line">		try &#123;</span><br><span class="line">			//1.注册驱动</span><br><span class="line">			DriverManager.registerDriver(new com.mysql.jdbc.Driver());</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			//2.建立连接 参数一：协议+访问的数据库， 参数二：用户名，参数三：密码</span><br><span class="line">			//DriverManager.getConnection(&quot;jdbc:mysql://localhost/test?			   user=monty&amp;password=greatsqldb);</span><br><span class="line">			</span><br><span class="line">			Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost/student&quot;,&quot;root&quot;,&quot;123456&quot;);</span><br><span class="line">			</span><br><span class="line">			//3.创建statement，跟数据库读取一定需要这个对象</span><br><span class="line">			Statement st = conn.createStatement();</span><br><span class="line">			</span><br><span class="line">			//4.执行查询，得到结果集</span><br><span class="line">			String sql = &quot;select * from t_stu&quot;;</span><br><span class="line">			ResultSet rs = st.executeQuery(sql);</span><br><span class="line">			</span><br><span class="line">			while(rs.next()) &#123;</span><br><span class="line">				int id = rs.getInt(&quot;id&quot;);</span><br><span class="line">				String name = rs.getString(&quot;name&quot;);</span><br><span class="line">				int age = rs.getInt(&quot;age&quot;);</span><br><span class="line">				</span><br><span class="line">				System.out.println(&quot;id&quot;+id+&quot;----&quot;+&quot;name&quot;+name+&quot;----&quot;+age+&quot;age&quot;);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			rs.close();</span><br><span class="line">			st.close();</span><br><span class="line">			conn.close();</span><br><span class="line">			</span><br><span class="line">		&#125; catch (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>JDBC工具类</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">JDBCUtil.java</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">package com.itheima.util;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.sql.Statement;</span><br><span class="line"></span><br><span class="line">/**释放资源</span><br><span class="line"> * @author Administrator</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">public class JDBCUtil &#123;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	public static void release(Connection conn, Statement st, ResultSet rs) &#123;</span><br><span class="line">		closeRs(rs);</span><br><span class="line">		closeSt(st);</span><br><span class="line">		closeConn(conn);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	private static void closeRs(ResultSet rs) &#123;</span><br><span class="line">		</span><br><span class="line">		try &#123;</span><br><span class="line">			if(rs != null) &#123;</span><br><span class="line">				rs.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (SQLException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			rs = null;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	private static void closeSt(Statement st) &#123;</span><br><span class="line">		</span><br><span class="line">		try &#123;</span><br><span class="line">			if(st != null) &#123;</span><br><span class="line">				st.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (SQLException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			st = null;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	private static void closeConn(Connection conn) &#123;</span><br><span class="line">		</span><br><span class="line">		try &#123;</span><br><span class="line">			if(conn != null) &#123;</span><br><span class="line">				conn.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (SQLException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			conn = null;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">MainTest.java</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">package com.itheima.test;</span><br><span class="line">import java.net.URI;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.Driver;</span><br><span class="line">import java.sql.DriverManager;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.sql.Statement;</span><br><span class="line"></span><br><span class="line">import com.itheima.util.JDBCUtil;</span><br><span class="line"></span><br><span class="line">public class MainTest &#123;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		Connection conn = null;</span><br><span class="line">		Statement st = null;</span><br><span class="line">		ResultSet rs = null;</span><br><span class="line">	</span><br><span class="line">		try &#123;</span><br><span class="line">			//1.注册驱动</span><br><span class="line">			DriverManager.registerDriver(new com.mysql.jdbc.Driver());</span><br><span class="line">			</span><br><span class="line">			//2.建立连接 参数一：协议+访问的数据库， 参数二：用户名，参数三：密码</span><br><span class="line">			//DriverManager.getConnection(&quot;jdbc:mysql://localhost/test?user=monty&amp;password=greatsqldb);</span><br><span class="line">			conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost/student&quot;,&quot;root&quot;,&quot;123456&quot;);</span><br><span class="line">			</span><br><span class="line">			//3.创建statement，跟数据库读取一定需要这个对象</span><br><span class="line">			st = conn.createStatement();</span><br><span class="line">			</span><br><span class="line">			//4.执行查询，得到结果集</span><br><span class="line">			String sql = &quot;select * from t_stu&quot;;</span><br><span class="line">			rs = st.executeQuery(sql);</span><br><span class="line">			</span><br><span class="line">			System.out.println(&quot;id&quot;+&quot;---- &quot;+&quot;name&quot;+&quot;---- &quot;+&quot;age&quot;);</span><br><span class="line">			while(rs.next()) &#123;</span><br><span class="line">				int id = rs.getInt(&quot;id&quot;);</span><br><span class="line">				String name = rs.getString(&quot;name&quot;);</span><br><span class="line">				int age = rs.getInt(&quot;age&quot;);</span><br><span class="line">				</span><br><span class="line">				System.out.println(+id+&quot;----&quot;+name+&quot;----&quot;+age);</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">		&#125; catch (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			JDBCUtil.release(conn, st, rs);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>JDBC使用步骤</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">1. 注册驱动</span><br><span class="line"></span><br><span class="line">   DriverManager.registerDriver(new com.mysql.jdbc.Driver());</span><br><span class="line"></span><br><span class="line">2. 建立连接</span><br><span class="line"></span><br><span class="line">   //DriverManager.getConnection(&quot;jdbc:mysql://localhost/test?user=monty&amp;password=greatsqldb&quot;);</span><br><span class="line">      		//2. 建立连接 参数一： 协议 + 访问的数据库 ， 参数二： 用户名 ， 参数三： 密码。</span><br><span class="line">      		conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost/student&quot;, &quot;root&quot;, &quot;root&quot;);</span><br><span class="line"></span><br><span class="line">3. 创建statement</span><br><span class="line"></span><br><span class="line">   //3. 创建statement ， 跟数据库打交道，一定需要这个对象</span><br><span class="line">      	st = conn.createStatement();</span><br><span class="line"></span><br><span class="line">4. 执行sql ，得到ResultSet</span><br><span class="line"></span><br><span class="line">   //4. 执行查询 ， 得到结果集</span><br><span class="line">      		String sql = &quot;select * from t_stu&quot;;</span><br><span class="line">      		rs = st.executeQuery(sql);</span><br><span class="line"></span><br><span class="line">5. 遍历结果集</span><br><span class="line"></span><br><span class="line">   //5. 遍历查询每一条记录</span><br><span class="line">      		while(rs.next())&#123;</span><br><span class="line">      			int id = rs.getInt(&quot;id&quot;);</span><br><span class="line">      			String name = rs.getString(&quot;name&quot;);</span><br><span class="line">      			int age = rs.getInt(&quot;age&quot;);</span><br><span class="line">      			System.out.println(&quot;id=&quot;+id + &quot;===name=&quot;+name+&quot;==age=&quot;+age);</span><br><span class="line">   		&#125;</span><br><span class="line">   		</span><br><span class="line">6. 释放资源</span><br><span class="line">	if (rs != null) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            rs.close();</span><br><span class="line">        &#125; catch (SQLException sqlEx) &#123; &#125; // ignore </span><br><span class="line">        rs = null;</span><br><span class="line">    &#125;</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p><strong>JDBC工具类构建</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;注册驱动</span><br><span class="line">1. 资源释放工作的整合</span><br><span class="line">2. 驱动防二次注册</span><br><span class="line">   	DriverManager.registerDriver(new com.mysql.jdbc.Driver());</span><br><span class="line">   	Driver 这个类里面有静态代码块，一上来就执行了，所以等同于我们注册了两次驱动。 其实没这个必要的。</span><br><span class="line">   	//静态代码块 ---&gt; 类加载了，就执行。 //java.sql.DriverManager.registerDriver(new Driver());</span><br><span class="line">3.最后形成以下代码即可。</span><br><span class="line">	Class.forName(&quot;com.mysql.jdbc.Driver&quot;);	</span><br><span class="line">&gt;&gt;连接对象整合</span><br><span class="line">	代码重整</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;使用properties配置文件</span><br><span class="line"><span class="number">1</span>. 在src底下声明一个文件 xxx.properties ，里面的内容吐下：</span><br><span class="line"></span><br><span class="line">   driverClass=com.mysql.jdbc.Driver</span><br><span class="line">      	url=jdbc:mysql:<span class="comment">//localhost/student</span></span><br><span class="line">      	name=root</span><br><span class="line">      	password=root</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>. 在工具类里面，使用静态代码块，读取属性</span><br><span class="line">&gt;&gt;&gt;&gt;<span class="keyword">static</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//1. 创建一个属性配置对象</span></span><br><span class="line">			Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">			InputStream is = <span class="keyword">new</span> FileInputStream(<span class="string">"jdbc.properties"</span>); <span class="comment">//对应文件位于工程根目录</span></span><br><span class="line">			 </span><br><span class="line">			<span class="comment">//使用类加载器，去读取src底下的资源文件。 后面在servlet  //对应文件位于src目录底下</span></span><br><span class="line">			<span class="comment">//InputStream is = JDBCUtil.class.getClassLoader().getResourceAsStream("jdbc.properties");</span></span><br><span class="line">			<span class="comment">//导入输入流。</span></span><br><span class="line">			properties.load(is);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//读取属性</span></span><br><span class="line">			driverClass = properties.getProperty(<span class="string">"driverClass"</span>);</span><br><span class="line">			url = properties.getProperty(<span class="string">"url"</span>);</span><br><span class="line">			name = properties.getProperty(<span class="string">"name"</span>);</span><br><span class="line">			password = properties.getProperty(<span class="string">"password"</span>);</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>SQL的CRUD语句</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;insert</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_stu (<span class="keyword">NAME</span> , age) <span class="keyword">VALUES</span> (<span class="string">'wangqiang'</span>,<span class="number">28</span>)</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_stu <span class="keyword">VALUES</span> (<span class="literal">NULL</span>,<span class="string">'wangqiang2'</span>,<span class="number">28</span>)</span><br><span class="line">&gt;&gt;<span class="keyword">delete</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_stu <span class="keyword">WHERE</span> <span class="keyword">id</span> = <span class="number">6</span></span><br><span class="line">&gt;&gt;<span class="keyword">query</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_stu</span><br><span class="line">&gt;&gt;<span class="keyword">update</span></span><br><span class="line"><span class="keyword">UPDATE</span> t_stu <span class="keyword">SET</span> age = <span class="number">38</span> <span class="keyword">WHERE</span> <span class="keyword">id</span> = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;使用单元测试，测试代码</span><br><span class="line"><span class="number">1</span>. 定义一个类， TestXXX , 里面定义方法 testXXX.</span><br><span class="line"><span class="number">2</span>. 添加junit的支持。 </span><br><span class="line">   右键工程 --- add Library --- Junit --- Junit4</span><br><span class="line"><span class="number">3</span>. 在方法的上面加上注解 ， 其实就是一个标记。</span><br><span class="line">   		<span class="meta">@Test</span></span><br><span class="line">      	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuery</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      		...</span><br><span class="line">      	&#125;</span><br><span class="line"><span class="number">4</span>. 光标选中方法名字，然后右键执行单元测试。  或者是打开outline视图， 然后选择方法右键执行。</span><br></pre></td></tr></table></figure>
<p><strong>Dao模式</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">新建一个dao的接口， 里面声明数据库访问规则</span><br><span class="line">&gt;&gt;<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 定义操作数据库的方法</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * 查询所有</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">新建一个dao的实现类，具体实现早前定义的规则</span><br><span class="line">&gt;&gt;<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Connection conn = <span class="keyword">null</span>;</span><br><span class="line">		Statement st = <span class="keyword">null</span>;</span><br><span class="line">		ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//1. 获取连接对象</span></span><br><span class="line">			conn = JDBCUtil.getConn();</span><br><span class="line">			<span class="comment">//2. 创建statement对象</span></span><br><span class="line">			st = conn.createStatement();</span><br><span class="line">			String sql = <span class="string">"select * from t_user"</span>;</span><br><span class="line">			rs = st.executeQuery(sql);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">				String userName = rs.getString(<span class="string">"username"</span>);</span><br><span class="line">				String password = rs.getString(<span class="string">"password"</span>);</span><br><span class="line">				</span><br><span class="line">				System.out.println(userName+<span class="string">"="</span>+password);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			JDBCUtil.release(conn, st, rs);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">直接使用实现</span><br><span class="line">&gt;&gt;<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">		UserDao dao = <span class="keyword">new</span> UserDaoImpl();</span><br><span class="line">		dao.findAll();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Statement安全问题</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Statement执行 ，其实是拼接sql语句的。  先拼接sql语句，然后在一起执行。 </span><br><span class="line">&gt;&gt;String sql = &quot;select * from t_user where username=&apos;&quot;+ username  +&quot;&apos; and 		password=&apos;&quot;+ password +&quot;&apos;&quot;;</span><br><span class="line"></span><br><span class="line">	UserDao dao = new UserDaoImpl();</span><br><span class="line">	dao.login(&quot;admin&quot;, &quot;100234khsdf88&apos; or &apos;1=1&quot;);</span><br><span class="line"></span><br><span class="line">	SELECT * FROM t_user WHERE username=&apos;admin&apos; AND PASSWORD=&apos;100234khsdf88&apos; or &apos;1=1&apos; </span><br><span class="line"></span><br><span class="line">	前面先拼接sql语句， 如果变量里面带有了 数据库的关键字，那么一并认为是关键字。 不认为是普通的字符串。 </span><br><span class="line">	rs = st.executeQuery(sql);</span><br></pre></td></tr></table></figure>
<p><strong>PreparedStatement</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;该对象就是替换前面的statement对象。</span><br><span class="line"></span><br><span class="line">&gt;&gt;相比较以前的statement， 预先处理给定的sql语句，对其执行语法检查。 在sql语句里面使用 ? 占位符来替代后续要传递进来的变量。 后面进来的变量值，将会被看成是字符串，不会产生任何的关键字。</span><br><span class="line">&gt;&gt;&gt;&gt;String sql = &quot;insert into t_user values(null , ? , ?)&quot;;</span><br><span class="line">		 ps = conn.prepareStatement(sql);</span><br><span class="line">		 </span><br><span class="line">		 //给占位符赋值 从左到右数过来，1 代表第一个问号， 永远你是1开始。</span><br><span class="line">		 ps.setString(1, userName);</span><br><span class="line">		 ps.setString(2, password);</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="HTTP-amp-Servlet"><a href="#HTTP-amp-Servlet" class="headerlink" title="HTTP&amp;Servlet"></a>HTTP&amp;Servlet</h1><p><strong>Http协议</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">什么是协议</span><br><span class="line">&gt;&gt;双方在交互、通讯的时候， 遵守的一种规范、规则。</span><br><span class="line">http协议</span><br><span class="line">&gt;&gt;针对网络上的客户端 与 服务器端在执行http请求的时候，遵守的一种规范。 其实就是规定了客户端在访问服务器端的时候，要带上哪些东西， 服务器端返回数据的时候，也要带上什么东西。 </span><br><span class="line">&gt;&gt;版本</span><br><span class="line">  1.0	请求数据，服务器返回后， 将会断开连接</span><br><span class="line">  1.1	请求数据，服务器返回后， 连接还会保持着。 除非服务器 | 客户端 关掉。 有一定的时间限制，如果都空着这个连接，那么后面会自己断掉。</span><br></pre></td></tr></table></figure>
<p><strong>演示客户端如何与服务器端通讯</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">在地址栏中键入网络地址 回车  或者是平常注册的时候，点击了注册按钮 ， 浏览器都能显示出来一些东西。那么背地里到底浏览器和服务器是怎么通讯。 它们都传输了哪些数据。</span><br><span class="line"></span><br><span class="line">1. 安装抓包工具 HttpWatch (IE插件)</span><br><span class="line">2. 打开tomcat. 输入localhost:8080 打开首页</span><br><span class="line">3. 在首页上找到Example 字样 </span><br><span class="line">&gt; 6.x 和 7.x 的文档页面有所不同，但是只要找到example就能够找到例子工程</span><br><span class="line">1. 选择 servlet 例子 ---&gt; Request Parameter</span><br><span class="line">接着点击Request  Parameters 的 Execute超链接</span><br><span class="line">执行tomcat的例子，然后查看浏览器和 tomcat服务器的对接细节</span><br></pre></td></tr></table></figure>
<p><strong>Http请求数据解释 </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">请求的数据里面包含三个部分内容 ： 请求行 、 请求头 、请求体</span><br><span class="line"></span><br><span class="line">&gt;&gt;请求行</span><br><span class="line">POST /examples/servlets/servlet/RequestParamExample HTTP/1.1 </span><br><span class="line">POST ： 请求方式 ，以post去提交数据</span><br><span class="line">/examples/servlets/servlet/RequestParamExample</span><br><span class="line">请求的地址路径 ， 就是要访问哪个地方。</span><br><span class="line">HTTP/1.1 协议版本</span><br><span class="line"></span><br><span class="line">&gt;&gt;请求头</span><br><span class="line">Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, */*</span><br><span class="line">	Referer: http://localhost:8080/examples/servlets/servlet/RequestParamExample</span><br><span class="line">	Accept-Language: zh-CN</span><br><span class="line">	User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)</span><br><span class="line">	Content-Type: application/x-www-form-urlencoded</span><br><span class="line">	Accept-Encoding: gzip, deflate</span><br><span class="line">	Host: localhost:8080</span><br><span class="line">	Content-Length: 31</span><br><span class="line">	Connection: Keep-Alive</span><br><span class="line">	Cache-Control: no-cache</span><br><span class="line"></span><br><span class="line">Accept: 客户端向服务器端表示，我能支持什么类型的数据。 </span><br><span class="line">Referer ： 真正请求的地址路径，全路径</span><br><span class="line">Accept-Language: 支持语言格式</span><br><span class="line">User-Agent: 用户代理 向服务器表明，当前来访的客户端信息。 </span><br><span class="line">Content-Type： 提交的数据类型。经过urlencoding编码的form表单的数据</span><br><span class="line">Accept-Encoding： gzip, deflate ： 压缩算法 。 </span><br><span class="line">Host ： 主机地址</span><br><span class="line">Content-Length： 数据长度</span><br><span class="line">Connection : Keep-Alive 保持连接</span><br><span class="line">Cache-Control ： 对缓存的操作</span><br><span class="line"></span><br><span class="line">&gt;&gt;请求体</span><br><span class="line">浏览器真正发送给服务器的数据 </span><br><span class="line">	发送的数据呈现的是key=value ,如果存在多个数据，那么使用 &amp;</span><br><span class="line"></span><br><span class="line">	firstname=zhang&amp;lastname=sansan</span><br></pre></td></tr></table></figure>
<p><strong>Http响应数据解析</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">请求的数据里面包含三个部分内容 ： 响应行 、 响应头 、响应体</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: Apache-Coyote/1.1</span><br><span class="line">Content-Type: text/html;charset=ISO-8859-1</span><br><span class="line">Content-Length: 673</span><br><span class="line">Date: Fri, 17 Feb 2017 02:53:02 GMT</span><br><span class="line"></span><br><span class="line">...这里还有很多数据...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;响应行</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">协议版本  </span><br><span class="line">状态码 </span><br><span class="line">	咱们这次交互到底是什么样结果的一个code. </span><br><span class="line">	200 : 成功，正常处理，得到数据。</span><br><span class="line">	403  : for bidden  拒绝</span><br><span class="line">	404 ： Not Found</span><br><span class="line">	500 ： 服务器异常</span><br><span class="line">OK</span><br><span class="line">	对应前面的状态码  </span><br><span class="line">	</span><br><span class="line">&gt;&gt;响应头</span><br><span class="line">Server:  服务器是哪一种类型。  Tomcat</span><br><span class="line">Content-Type ： 服务器返回给客户端你的内容类型</span><br><span class="line">Content-Length ： 返回的数据长度</span><br><span class="line">Date ： 通讯的日期，响应的时间</span><br></pre></td></tr></table></figure>
<p><strong>Get和Post请求区别</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img04.png" alt="img04"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;post</span><br><span class="line">数据是以流的方式写过去，不会在地址栏上面显示。  现在一般提交数据到服务器使用的都是POST</span><br><span class="line">以流的方式写数据，所以数据没有大小限制。</span><br><span class="line">&gt;&gt;get</span><br><span class="line">会在地址栏后面拼接数据，所以有安全隐患。 一般从服务器获取数据，并且客户端也不用提交上面数据的时候，可以使用GET</span><br><span class="line">能够带的数据有限， 1kb大小</span><br></pre></td></tr></table></figure>
<p><strong>Web资源</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">在http协议当中，规定了请求和响应双方， 客户端和服务器端。与web相关的资源。 </span><br><span class="line">有两种分类</span><br><span class="line">&gt;&gt;静态资源</span><br><span class="line">  html 、 js、 css</span><br><span class="line">&gt;&gt;动态资源</span><br><span class="line">  servlet/jsp</span><br><span class="line">Servlet</span><br><span class="line">&gt;&gt;servlet是什么?</span><br><span class="line">&gt;&gt;&gt;&gt;其实就是一个java程序，运行在我们的web服务器上，用于接收和响应 客户端的http请求。 </span><br><span class="line">&gt;&gt;&gt;&gt;更多的是配合动态资源来做。 当然静态资源也需要使用到servlet，只不过是Tomcat里面已经定义好了一个 DefaultServlet</span><br></pre></td></tr></table></figure>
<p><strong>Hello Servlet</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1. 得写一个Web工程 ， 要有一个服务器。</span><br><span class="line">2. 测试运行Web工程</span><br><span class="line">   1. 新建一个类， 实现Servlet接口</span><br><span class="line">      1. 配置Servlet ， 用意： 告诉服务器，我们的应用有这么些个servlet。</span><br><span class="line">         在webContent/WEB-INF/web.xml里面写上以下内容。</span><br><span class="line">         </span><br><span class="line"> &lt;!-- 向tomcat报告， 我这个应用里面有这个servlet， 名字叫做HelloServlet , 具体的路径是com.itheima.servlet.HelloServlet --&gt;</span><br><span class="line">	  &lt;servlet&gt;</span><br><span class="line">	  	&lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;</span><br><span class="line">	  	&lt;servlet-class&gt;com.itheima.servlet.HelloServlet&lt;/servlet-class&gt;</span><br><span class="line">	  &lt;/servlet&gt;</span><br><span class="line">	  &lt;!-- 注册servlet的映射。  servletName : 找到上面注册的具体servlet，  url-pattern: 在地址栏上的path 一定要以/打头 --&gt;</span><br><span class="line">	  &lt;servlet-mapping&gt;</span><br><span class="line">	  	&lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;</span><br><span class="line">	  	&lt;url-pattern&gt;/a&lt;/url-pattern&gt;</span><br><span class="line">	  &lt;/servlet-mapping&gt;</span><br><span class="line">	3. 在地址栏上输入 http://localhost:8080/项目名称/a</span><br></pre></td></tr></table></figure>
<p><strong>Servlet执行过程</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img05.png" alt="img05"></p>
<p><strong>Servlet的通用写法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Servlet (接口)</span><br><span class="line">	|</span><br><span class="line">	|</span><br><span class="line">GenericServlet</span><br><span class="line">	|</span><br><span class="line">	|</span><br><span class="line">HttpServlet （用于处理http的请求）</span><br></pre></td></tr></table></figure>
<p>定义一个类，继承HttpServlet 复写doGet和doPost</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img06.png" alt="img06"></p>
<p><strong>Servlet的生命周期</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">生命周期</span><br><span class="line">&gt;&gt;从创建到销毁的一段时间</span><br><span class="line">生命周期方法</span><br><span class="line">&gt;&gt;从创建到销毁，所调用的那些方法。</span><br><span class="line">- init方法</span><br><span class="line">  在创建该servlet的实例时，就执行该方法。</span><br><span class="line">  	一个servlet只会初始化一次， init方法只会执行一次</span><br><span class="line">  	默认情况下是 ： 初次访问该servlet，才会创建实例。 </span><br><span class="line">- service方法</span><br><span class="line">  只要客户端来了一个请求，那么就执行这个方法了。</span><br><span class="line">   	 该方法可以被执行很多次。 一次请求，对应一次service方法的调用</span><br><span class="line">- destroy方法</span><br><span class="line">  servlet销毁的时候，就会执行该方法</span><br><span class="line">  		1. 该项目从tomcat的里面移除。</span><br><span class="line">  		2. 正常关闭tomcat就会执行 shutdown.bat</span><br><span class="line">  		</span><br><span class="line">doGet 和 doPost不算生命周期方法，所谓的生命周期方法是指，从对象的创建到销毁一定会执行的方法， 但是这两个方法，不一定会执行。</span><br></pre></td></tr></table></figure>
<p><strong>让Servlet创建实例的时机提前</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. 默认情况下，只有在初次访问servlet的时候，才会执行init方法。 有的时候，我们可能需要在这个方法里面执行一些初始化工作，甚至是做一些比较耗时的逻辑。 </span><br><span class="line">2. 那么这个时候，初次访问，可能会在init方法中逗留太久的时间。 那么有没有方法可以让这个初始化的时机提前一点。 </span><br><span class="line">3. 在配置的时候， 使用load-on-startup元素来指定， 给定的数字越小，启动的时机就越早。 一般不写负数， 从2开始即可。 </span><br><span class="line">&lt;servlet&gt;</span><br><span class="line">	  	&lt;servlet-name&gt;HelloServlet04&lt;/servlet-name&gt;</span><br><span class="line">	  	&lt;servlet-class&gt;com.itheima.servlet.HelloServlet04&lt;/servlet-class&gt;</span><br><span class="line">	  	&lt;load-on-startup&gt;2&lt;/load-on-startup&gt;</span><br><span class="line">	  &lt;/servlet&gt;</span><br></pre></td></tr></table></figure>
<p><strong>ServletConfig</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;Servlet的配置，通过这个对象，可以获取servlet在配置的时候一些信息</span><br><span class="line">&gt;&gt;先说 ， 在写怎么用， 最后说有什么用。</span><br><span class="line"></span><br><span class="line">//1. 得到servlet配置对象 专门用于在配置servlet的信息</span><br><span class="line">	ServletConfig config = getServletConfig();</span><br><span class="line">//获取到的是配置servlet里面servlet-name 的文本内容</span><br><span class="line">	String servletName = config.getServletName();</span><br><span class="line">	System.out.println(&quot;servletName=&quot;+servletName);</span><br><span class="line">	</span><br><span class="line">//2、。 可以获取具体的某一个参数。 </span><br><span class="line">	String address = config.getInitParameter(&quot;address&quot;);</span><br><span class="line">	System.out.println(&quot;address=&quot;+address);</span><br><span class="line"></span><br><span class="line">//3.获取所有的参数名称</span><br><span class="line">	Enumeration&lt;String&gt; names = config.getInitParameterNames();</span><br><span class="line">	//遍历取出所有的参数名称</span><br><span class="line">	while (names.hasMoreElements()) &#123;</span><br><span class="line">		String key = (String) names.nextElement();</span><br><span class="line">		String value = config.getInitParameter(key);</span><br><span class="line">		System.out.println(&quot;key===&quot;+key + &quot;   value=&quot;+value);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>为什么需要有这个ServletConfig</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1. 未来我们自己开发的一些应用，使用到了一些技术，或者一些代码，我们不会。 但是有人写出来了。它的代码放置在了自己的servlet类里面。 </span><br><span class="line">2. 刚好这个servlet 里面需要一个数字或者叫做变量值。 但是这个值不能是固定了。 所以要求使用到这个servlet的公司，在注册servlet的时候，必须要在web.xml里面，声明init-params</span><br><span class="line">在开发当中比较少用。</span><br><span class="line"></span><br><span class="line">##总结</span><br><span class="line">- Http协议</span><br><span class="line">  1. 使用HttpWacht 抓包看一看http请求背后的细节。 </span><br><span class="line">     1. 基本了解 请求和响应的数据内容</span><br><span class="line">        请求行、 请求头 、请求体</span><br><span class="line">        	响应行、响应头、响应体</span><br><span class="line">     2. Get和Post的区别</span><br><span class="line">- Servlet【重点】</span><br><span class="line">  1. 会使用简单的servlet</span><br><span class="line">     1.写一个类，实现接口Servlet</span><br><span class="line">     	2. 配置Servlet</span><br><span class="line">     	3. 会访问Setvlet</span><br><span class="line">     1. Servlet的生命周期</span><br><span class="line">        init 一次 创建对象 默认初次访问就会调用或者可以通过配置，让它提前 load-on-startup</span><br><span class="line">        service	多次，一次请求对应一次service</span><br><span class="line">        destory 一次 销毁的时候 从服务器移除 或者 正常关闭服务器</span><br><span class="line">     2. ServletConfig</span><br><span class="line">        获取配置的信息， params</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="HTTPServletReauest-amp-HTTPServletResponse"><a href="#HTTPServletReauest-amp-HTTPServletResponse" class="headerlink" title="HTTPServletReauest&amp;HTTPServletResponse"></a>HTTPServletReauest&amp;HTTPServletResponse</h1><p><strong>Servlet配置方式</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--全路径匹配</span><br><span class="line">&gt; 以 / 开始   /a /aa/bb</span><br><span class="line">&gt; localhost:8080/项目名称/aa/bb </span><br><span class="line">--路径匹配 , 前半段匹配</span><br><span class="line">&gt; 以  / 开始 ， 但是以 * 结束  /a/* /*  </span><br><span class="line">&gt; - 其实是一个通配符，匹配任意文字</span><br><span class="line">&gt; localhost:8080/项目名称/aa/bb </span><br><span class="line">--以扩展名匹配</span><br><span class="line">&gt; 写法： 没有/  以 * 开始   *.扩展名    *.aa *.bb</span><br></pre></td></tr></table></figure>
<p><strong>ServletContext</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; Servlet 上下文</span><br><span class="line">&gt; 每个web工程都只有一个ServletContext对象。 说白了也就是不管在哪个servlet里面，获取到的这个类的对象都是同一个。</span><br></pre></td></tr></table></figure>
<p><strong>如何得到对象</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//1. 获取对象</span><br><span class="line">	ServletContext context = getServletContext();</span><br></pre></td></tr></table></figure>
<p><strong>有什么作用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 获取全局配置参数</span><br><span class="line">2. 获取web工程中的资源</span><br><span class="line">3. 存取数据，servlet间共享数据  域对象</span><br></pre></td></tr></table></figure>
<p><strong>可以获取全局配置参数</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img01.png" alt="img01"></p>
<p>获取全局参数</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img02.png" alt="img02"></p>
<p><strong>可以获取Web应用中的资源</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. 获取资源在tomcat里面的绝对路径</span><br><span class="line">	先得到路径，然后自己new InpuStream</span><br><span class="line">		context.getRealPath(&quot;&quot;) //这里得到的是项目在tomcat里面的根目录。</span><br><span class="line">		D:\tomcat\apache-tomcat-7.0.52\apache-tomcat-7.0.52\wtpwebapps\Demo03\</span><br><span class="line">	 	String path = context.getRealPath(&quot;file/config.properties&quot;);</span><br><span class="line">		D:\tomcat\apache-tomcat-7.0.52\apache-tomcat-7.0.52\wtpwebapps\Demo03\file\config.properties</span><br><span class="line">		</span><br><span class="line">2. getResourceAsStream 获取资源 流对象</span><br><span class="line">	直接给相对的路径，然后获取流对象。</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img03.png" alt="img03"></p>
<p><strong>通过classloader去获取web工程下的资源</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img07.png" alt="img07"></p>
<p><strong>使用ServletContext存取数据</strong></p>
<p>1.定义一个登陆的html页面， 定义一个form表单</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img08.png" alt="img08"></p>
<p>2.定义一个Servlet，名为LoginServlet</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img09.png" alt="img09"></p>
<p>3.针对成功或者失败，进行判断，然后跳转到不一样的网页</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img10.png" alt="img10"></p>
<p><strong>ServletContext存取值分析</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img11.png" alt="img11"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 	</span><br><span class="line">A路径： Servlet的路径</span><br><span class="line">	http://localhost:8080/Demo4/login</span><br><span class="line">B路径： 当前这个html的路径：</span><br><span class="line">	http://localhost:8080/Demo4/login.html --&gt;</span><br><span class="line"></span><br><span class="line">&lt;form action=&quot;login&quot; method=&quot;get&quot;&gt;</span><br><span class="line">	账号:&lt;input type=&quot;text&quot; name=&quot;username&quot;/&gt;&lt;br&gt;</span><br><span class="line">	密码:&lt;input type=&quot;text&quot; name=&quot;password&quot;/&gt;&lt;br&gt;</span><br><span class="line">	&lt;input type=&quot;submit&quot; value=&quot;登录&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p><strong>ServletContext 何时创建， 何时销毁?</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">服务器启动的时候，会为托管的每一个web应用程序，创建一个ServletContext对象</span><br><span class="line">从服务器移除托管，或者是关闭服务器。</span><br></pre></td></tr></table></figure>
<p><strong>HttpServletRequest</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">这个对象封装了客户端提交过来的一切数据。</span><br><span class="line">可以获取客户端请求头信息</span><br><span class="line"></span><br><span class="line">1.获取客户端提交过来的数据</span><br><span class="line">//得到一个枚举集合  </span><br><span class="line">	Enumeration&lt;String&gt; headerNames = request.getHeaderNames();</span><br><span class="line">	while (headerNames.hasMoreElements()) &#123;</span><br><span class="line">		String name = (String) headerNames.nextElement();</span><br><span class="line">		String value = request.getHeader(name);</span><br><span class="line">		System.out.println(name+&quot;=&quot;+value);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">2.获取客户端提交过来的数据</span><br><span class="line">	String name = request.getParameter(&quot;name&quot;);</span><br><span class="line">	String address = request.getParameter(&quot;address&quot;);</span><br><span class="line">	System.out.println(&quot;name=&quot;+name);</span><br><span class="line">	System.out.println(&quot;address=&quot;+address);</span><br><span class="line"></span><br><span class="line">	-------------------------------------------------</span><br><span class="line"></span><br><span class="line">	//name=zhangsan&amp;name=lisi&amp;name=wangwu 一个key可以对应多个值。</span><br><span class="line"></span><br><span class="line">	Map&lt;String, String[]&gt; map = request.getParameterMap();</span><br><span class="line">	</span><br><span class="line">	Set&lt;String&gt; keySet = map.keySet();</span><br><span class="line">	Iterator&lt;String&gt; iterator = keySet.iterator();</span><br><span class="line">	while (iterator.hasNext()) &#123;</span><br><span class="line">		String key = (String) iterator.next();</span><br><span class="line">		System.out.println(&quot;key=&quot;+key + &quot;--的值总数有：&quot;+map.get(key).length);</span><br><span class="line">		String value = map.get(key)[0];</span><br><span class="line">		String value1 = map.get(key)[1];</span><br><span class="line">		String value2 = map.get(key)[2];</span><br><span class="line">		</span><br><span class="line">		System.out.println(key+&quot; ======= &quot;+ value + &quot;=&quot; + value1 + &quot;=&quot;+ value2);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">3.获取中文数据</span><br><span class="line">客户端提交数据给服务器端，如果数据中带有中文的话，有可能会出现乱码情况，那么可以参照以下方法解决。</span><br><span class="line"></span><br><span class="line">如果是GET方式</span><br><span class="line"></span><br><span class="line">1. 代码转码</span><br><span class="line">   String username = request.getParameter(&quot;username&quot;);</span><br><span class="line">   	String password = request.getParameter(&quot;password&quot;);</span><br><span class="line">   	</span><br><span class="line">&gt;&gt;System.out.println(&quot;userName=&quot;+username+&quot;==password=&quot;+password);</span><br><span class="line">//get请求过来的数据，在url地址栏上就已经经过编码了，所以我们取到的就是乱码，</span><br><span class="line">//tomcat收到了这批数据，getParameter 默认使用ISO-8859-1去解码</span><br><span class="line">//先让文字回到ISO-8859-1对应的字节数组 ， 然后再按utf-8组拼字符串</span><br><span class="line">username = new String(username.getBytes(&quot;ISO-8859-1&quot;) , &quot;UTF-8&quot;);</span><br><span class="line">System.out.println(&quot;userName=&quot;+username+&quot;==password=&quot;+password);</span><br><span class="line">直接在tomcat里面做配置，以后get请求过来的数据永远都是用UTF-8编码。 </span><br><span class="line"></span><br><span class="line">2.可以在tomcat里面做设置处理 conf/server.xml 加上URIEncoding=&quot;utf-8&quot;</span><br><span class="line">   &lt;Connector connectionTimeout=&quot;20000&quot; port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot; redirectPort=&quot;8443&quot; URIEncoding=&quot;UTF-8&quot;/&gt;</span><br><span class="line">   </span><br><span class="line">如果是POST方式</span><br><span class="line"></span><br><span class="line">这个说的是设置请求体里面的文字编码。  get方式，用这行，有用吗？ ---&gt; 没用</span><br><span class="line">	request.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">	这行设置一定要写在getParameter之前。</span><br></pre></td></tr></table></figure>
<p><strong>HttpServletResponse</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">负责返回数据给客户端。</span><br><span class="line">输出数据到页面上</span><br><span class="line"></span><br><span class="line">	//以字符流的方式写数据	</span><br><span class="line">	//response.getWriter().write(&quot;&lt;h1&gt;hello response...&lt;/h1&gt;&quot;);</span><br><span class="line">	</span><br><span class="line">	//以字节流的方式写数据 </span><br><span class="line">	response.getOutputStream().write(&quot;hello response2222...&quot;.getBytes());</span><br></pre></td></tr></table></figure>
<p><strong>响应的数据中有中文，那么有可能出现中文乱码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">--以字符流输出</span><br><span class="line">&gt; response.getWriter()</span><br><span class="line">//1. 指定输出到客户端的时候，这些文字使用UTF-8编码</span><br><span class="line">	response.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">	</span><br><span class="line">	//2. 直接规定浏览器看这份数据的时候，使用什么编码来看。</span><br><span class="line">	response.setHeader(&quot;Content-Type&quot;, &quot;text/html; charset=UTF-8&quot;);</span><br><span class="line">	</span><br><span class="line">	response.getWriter().write(&quot;我爱黑马训练营...&quot;);</span><br><span class="line"></span><br><span class="line">--以字节流输出</span><br><span class="line">&gt; response.getOutputStream()</span><br><span class="line">	//1. 指定浏览器看这份数据使用的码表</span><br><span class="line">	response.setHeader(&quot;Content-Type&quot;, &quot;text/html;charset=UTF-8&quot;);</span><br><span class="line">	</span><br><span class="line">	//2. 指定输出的中文用的码表</span><br><span class="line">	response.getOutputStream().write(&quot;我爱深圳黑马训练营..&quot;.getBytes(&quot;UTF-8&quot;));</span><br></pre></td></tr></table></figure>
<p><strong>不管是字节流还是字符流，直接使用一行代码就可以了。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(&quot;text/html;charset=UTF-8&quot;);</span><br><span class="line">然后在写数据即可。</span><br></pre></td></tr></table></figure>
<p><strong>演练下载资源</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.直接以超链接的方式下载，不写任何代码。 也能够下载东西下来。 </span><br><span class="line">让tomcat的默认servlet去提供下载：&lt;br&gt;</span><br><span class="line">&lt;a href=&quot;download/aa.jpg&quot;&gt;aa.jpg&lt;/a&gt;&lt;br&gt;</span><br><span class="line">&lt;a href=&quot;download/bb.txt&quot;&gt;bb.txt&lt;/a&gt;&lt;br&gt;</span><br><span class="line">&lt;a href=&quot;download/cc.rar&quot;&gt;cc.rar&lt;/a&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">原因是tomcat里面有一个默认的Servlet -- DefaultServlet 。这个DefaultServlet 专门用于处理放在tomcat服务器上的静态资源。</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img12.png" alt="img12"></p>
<p><strong>总结</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1. Servlet注册方式 </span><br><span class="line">2. ServletContext【重点】</span><br><span class="line">&gt;&gt;作用：</span><br><span class="line">1. 获取全局参数</span><br><span class="line">2. 获取工程里面的资源。</span><br><span class="line">3. 资源共享。  ServletContext 域对象</span><br><span class="line">&gt;&gt;有几个 一个 </span><br><span class="line">&gt;&gt;什么时候创建 ？ 什么时候销毁</span><br><span class="line">服务器启动的时候给每一个应用都创建一个ServletContext对象， 服务器关闭的时候销毁</span><br><span class="line"></span><br><span class="line">简单登录</span><br><span class="line">3. HttpServletRequest【重点】</span><br><span class="line">   1. 获取请求头</span><br><span class="line">      1. 获取提交过来的数据</span><br><span class="line">4. HttpServletResponse【重点】</span><br><span class="line">   负责输出数据到客户端，其实就是对之前的请求作出响应</span><br><span class="line">5. 中文乱码问题。【重点】</span><br><span class="line">6. 下载</span><br></pre></td></tr></table></figure>
<p><strong>作业：</strong></p>
<ol>
<li><p>完成注册 </p>
</li>
<li><p>完成登录</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img13.png" alt="img13"></p>
<p>V1.1 最好配合上数据库，完成注册和登录的功能。 </p>
</li>
</ol>
<hr>
<h1 id="Cookie-amp-amp-Session"><a href="#Cookie-amp-amp-Session" class="headerlink" title="Cookie&amp;&amp;Session"></a>Cookie&amp;&amp;Session</h1><p>   <strong>中文文件下载</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">针对浏览器类型，对文件名字做编码处理 Firefox (Base64) , IE、Chrome ... 使用的是URLEncoder</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 如果文件的名字带有中文，那么需要对这个文件名进行编码处理</span><br><span class="line">	 * 如果是IE ，或者  Chrome （谷歌浏览器） ，使用URLEncoding 编码</span><br><span class="line">	 * 如果是Firefox ， 使用Base64编码</span><br><span class="line">	 */</span><br><span class="line">	//获取来访的客户端类型</span><br><span class="line">	String clientType = request.getHeader(&quot;User-Agent&quot;);</span><br><span class="line">	</span><br><span class="line">	if(clientType.contains(&quot;Firefox&quot;))&#123;</span><br><span class="line">		fileName = DownLoadUtil.base64EncodeFileName(fileName);</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		//IE ，或者  Chrome （谷歌浏览器） ，</span><br><span class="line">		//对中文的名字进行编码处理</span><br><span class="line">		fileName = URLEncoder.encode(fileName,&quot;UTF-8&quot;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>   <strong>请求转发和重定向</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">重定向</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">		之前的写法</span><br><span class="line">		response.setStatus(302);</span><br><span class="line">		response.setHeader(&quot;Location&quot;, &quot;login_success.html&quot;);*/</span><br><span class="line">		</span><br><span class="line">		//重定向写法： 重新定位方向 参数即跳转的位置</span><br><span class="line">	response.sendRedirect(&quot;login_success.html&quot;);</span><br><span class="line"></span><br><span class="line">	1. 地址上显示的是最后的那个资源的路径地址</span><br><span class="line"></span><br><span class="line">	2. 请求次数最少有两次， 服务器在第一次请求后，会返回302 以及一个地址， 浏览器在根据这个地址，执行第二次访问。</span><br><span class="line"></span><br><span class="line">	3. 可以跳转到任意路径。 不是自己的工程也可以跳。</span><br><span class="line"></span><br><span class="line">	4. 效率稍微低一点， 执行两次请求。 </span><br><span class="line"></span><br><span class="line">	5. 后续的请求，没法使用上一次的request存储的数据，或者 没法使用上一次的request对象，因为这是两次不同的请求。</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line">请求转发</span><br><span class="line"></span><br><span class="line">	//请求转发的写法： 参数即跳转的位置</span><br><span class="line">	request.getRequestDispatcher(&quot;login_success.html&quot;).forward(request, response);</span><br><span class="line"></span><br><span class="line">	1. 地址上显示的是请求servlet的地址。  返回200 ok</span><br><span class="line"></span><br><span class="line">	2. 请求次数只有一次， 因为是服务器内部帮客户端执行了后续的工作。 </span><br><span class="line"></span><br><span class="line">	3. 只能跳转自己项目的资源路径 。  </span><br><span class="line"></span><br><span class="line">	4. 效率上稍微高一点，因为只执行一次请求。 </span><br><span class="line"></span><br><span class="line">	5. 可以使用上一次的request对象。</span><br></pre></td></tr></table></figure>
<p>   <img src="/2019/01/26/JavaWeb知识/JavaWeb/img14.png" alt="img14"></p>
<p>   <strong>Cookie</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">饼干. 其实是一份小数据， 是服务器给客户端，并且存储在客户端上的一份小数据</span><br><span class="line"></span><br><span class="line">### 应用场景</span><br><span class="line">&gt; 自动登录、浏览记录、购物车。</span><br></pre></td></tr></table></figure>
<p>   <strong>为什么要有这个Cookie</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http的请求是无状态。 客户端与服务器在通讯的时候，是无状态的，其实就是客户端在第二次来访的时候，服务器根本就不知道这个客户端以前有没有来访问过。 为了更好的用户体验，更好的交互 [自动登录]，其实从公司层面讲，就是为了更好的收集用户习惯[大数据]</span><br></pre></td></tr></table></figure>
<p>   <strong>Cookie怎么用</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#### 简单使用：</span><br><span class="line">- 添加Cookie给客户端</span><br><span class="line">  1. 在响应的时候，添加cookie</span><br><span class="line">     Cookie cookie = new Cookie(&quot;aa&quot;, &quot;bb&quot;);</span><br><span class="line"></span><br><span class="line">//给响应，添加一个cookie</span><br><span class="line">response.addCookie(cookie);</span><br><span class="line">  2.客户端收到的信息里面，响应头中多了一个字段 Set-Cookie</span><br></pre></td></tr></table></figure>
<p>   3.<img src="/2019/01/26/JavaWeb知识/JavaWeb/img15.png" alt="img15"></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">获取客户端带过来的Cookie</span><br><span class="line"></span><br><span class="line">//获取客户端带过来的cookie</span><br><span class="line">	Cookie[] cookies = request.getCookies();</span><br><span class="line">	if(cookies != null)&#123;</span><br><span class="line">		for (Cookie c : cookies) &#123;</span><br><span class="line">			String cookieName = c.getName();</span><br><span class="line">			String cookieValue = c.getValue();</span><br><span class="line">			System.out.println(cookieName + &quot; = &quot;+ cookieValue);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">常用方法</span><br><span class="line">	//关闭浏览器后，cookie就没有了。 ---&gt; 针对没有设置cookie的有效期。</span><br><span class="line">	//	expiry： 有效 以秒计算。</span><br><span class="line">	//正值 ： 表示 在这个数字过后，cookie将会失效。</span><br><span class="line">	//负值： 关闭浏览器，那么cookie就失效， 默认值是 -1</span><br><span class="line">	cookie.setMaxAge(60 * 60 * 24 * 7);</span><br><span class="line">	</span><br><span class="line">	//赋值新的值</span><br><span class="line">	//cookie.setValue(newValue);</span><br><span class="line">	</span><br><span class="line">	//用于指定只有请求了指定的域名，才会带上该cookie</span><br><span class="line">	cookie.setDomain(&quot;.itheima.com&quot;);</span><br><span class="line">	</span><br><span class="line">	//只有访问该域名下的cookieDemo的这个路径地址才会带cookie</span><br><span class="line">	cookie.setPath(&quot;/CookieDemo&quot;);</span><br></pre></td></tr></table></figure>
<p>   <strong>例子一 显示最近访问的时间。</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">1.判断账号是否正确</span><br><span class="line">2. 如果正确，则获取cookie。 但是得到的cookie是一个数组， 我们要从数组里面找到我们想要的对象。</span><br><span class="line">3. 如果找到的对象为空，表明是第一次登录。那么要添加cookie</span><br><span class="line">4. 如果找到的对象不为空， 表明不是第一次登录。 </span><br><span class="line"></span><br><span class="line">	if(&quot;admin&quot;.equals(userName) &amp;&amp; &quot;123&quot;.equals(password))&#123;</span><br><span class="line">		//获取cookie last-name --- &gt;</span><br><span class="line">		Cookie [] cookies = request.getCookies();</span><br><span class="line">		</span><br><span class="line">		//从数组里面找出我们想要的cookie</span><br><span class="line">		Cookie cookie = CookieUtil.findCookie(cookies, &quot;last&quot;);</span><br><span class="line">		</span><br><span class="line">		//是第一次登录，没有cookie</span><br><span class="line">		if(cookie == null)&#123;</span><br><span class="line">			</span><br><span class="line">			Cookie c = new Cookie(&quot;last&quot;, System.currentTimeMillis()+&quot;&quot;);</span><br><span class="line">			c.setMaxAge(60*60); //一个小时</span><br><span class="line">			response.addCookie(c);</span><br><span class="line">			</span><br><span class="line">			response.getWriter().write(&quot;欢迎您, &quot;+userName);</span><br><span class="line">			</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			//1. 去以前的cookie第二次登录，有cookie</span><br><span class="line">			long lastVisitTime = Long.parseLong(cookie.getValue());</span><br><span class="line">			</span><br><span class="line">			//2. 输出到界面，</span><br><span class="line">			response.getWriter().write(&quot;欢迎您, &quot;+userName +&quot;,上次来访时间是：&quot;+new Date(lastVisitTime));</span><br><span class="line">			</span><br><span class="line">			//3. 重置登录的时间</span><br><span class="line">			cookie.setValue(System.currentTimeMillis()+&quot;&quot;);</span><br><span class="line">			response.addCookie(cookie);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		response.getWriter().write(&quot;登陆失败 &quot;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>   <strong>例子二： 显示商品浏览记录。</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">###准备工作</span><br><span class="line"></span><br><span class="line">1. 拷贝基础课第一天的 htmll原型文件，到工程的WebContent里面。</span><br><span class="line"></span><br><span class="line">2. 在WebContent目录下新建一个jsp文件， product_list.jsp, 然后拷贝原来product_list.html的内容到jsp里面。 建好之后，jsp里面的所有ISO-8859-1 改成 UTF-8</span><br><span class="line"></span><br><span class="line">   拷贝html标签的所有内容。 替换jsp的html标签即可</span><br><span class="line"></span><br><span class="line">3. 修改product_info.htm里面的手机数码超链接地址</span><br><span class="line"></span><br><span class="line">   &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;product_list.jsp&quot;&gt;手机数码&lt;span class=&quot;sr-only&quot;&gt;(current)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line"></span><br><span class="line">4. 修改首页(index.html)顶部的手机数码跳转的位置为 product_list.jsp</span><br><span class="line"></span><br><span class="line">   &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;product_list.jsp&quot;&gt;手机数码&lt;span class=&quot;sr-only&quot;&gt;(current)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line"></span><br><span class="line">###分析</span><br></pre></td></tr></table></figure>
<p>   <img src="/2019/01/26/JavaWeb知识/JavaWeb/img16.png" alt="img16"></p>
<p>   <strong>Jsp 里面使用Java代码</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- jsp</span><br><span class="line">&gt; Java Server Pager ---&gt; 最终会翻译成一个类， 就是一个Servlet</span><br><span class="line">- 定义全局变量</span><br><span class="line">  &lt;%! int a = 99; %&gt;</span><br><span class="line">- 定义局部变量</span><br><span class="line">  &lt;% int b = 999; %&gt;</span><br><span class="line">- 在jsp页面上，显示 a 和 b的值，</span><br><span class="line">  &lt;%=a %&gt; </span><br><span class="line">  &lt;%=b %&gt;</span><br></pre></td></tr></table></figure>
<p>   <strong>jsp显示浏览记录</strong></p>
<p>   <img src="/2019/01/26/JavaWeb知识/JavaWeb/img17.png" alt="img17"></p>
<p>   <strong>清除浏览记录</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">其实就是清除Cookie， 删除cookie是没有什么delete方法的。只有设置maxAge 为0 。</span><br><span class="line"></span><br><span class="line">	Cookie cookie = new Cookie(&quot;history&quot;,&quot;&quot;);</span><br><span class="line">	cookie.setMaxAge(0); //设置立即删除</span><br><span class="line">	cookie.setPath(&quot;/CookieDemo02&quot;);</span><br><span class="line">	response.addCookie(cookie);</span><br></pre></td></tr></table></figure>
<p>   <strong>Cookie总结</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1. 服务器给客户端发送过来的一小份数据，并且存放在客户端上。</span><br><span class="line"></span><br><span class="line">2. 获取cookie， 添加cookie</span><br><span class="line"></span><br><span class="line">   request.getCookie();</span><br><span class="line"></span><br><span class="line">   response.addCookie();</span><br><span class="line"></span><br><span class="line">3. Cookie分类</span><br><span class="line"></span><br><span class="line">   会话Cookie</span><br><span class="line">   	默认情况下，关闭了浏览器，那么cookie就会消失。</span><br><span class="line"></span><br><span class="line">   持久Cookie</span><br><span class="line">   </span><br><span class="line">在一定时间内，都有效，并且会保存在客户端上。 </span><br><span class="line">cookie.setMaxAge(0); //设置立即删除</span><br><span class="line">cookie.setMaxAge(100); //100 秒</span><br><span class="line"></span><br><span class="line">4. Cookie的安全问题。</span><br><span class="line">由于Cookie会保存在客户端上，所以有安全隐患问题。  还有一个问题， Cookie的大小与个数有限制。 为了解决这个问题 ---&gt; Session .</span><br></pre></td></tr></table></figure>
<p>   <strong>Session</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">会话 ， Session是基于Cookie的一种会话机制。 Cookie是服务器返回一小份数据给客户端，并且存放在客户端上。 Session是，数据存放在服务器端。</span><br><span class="line"></span><br><span class="line">常用API</span><br><span class="line"></span><br><span class="line">	//得到会话ID</span><br><span class="line">	String id = session.getId();</span><br><span class="line">	//存值</span><br><span class="line">	session.setAttribute(name, value);</span><br><span class="line">	//取值</span><br><span class="line">	session.getAttribute(name);</span><br><span class="line">	//移除值</span><br><span class="line">	session.removeAttribute(name);</span><br><span class="line">	</span><br><span class="line">	- Session何时创建  ， 何时销毁?</span><br><span class="line">- 创建</span><br><span class="line">&gt; 如果有在servlet里面调用了 request.getSession()</span><br><span class="line">- 销毁</span><br><span class="line">&gt; session 是存放在服务器的内存中的一份数据。 当然可以持久化. Redis . 即使关了浏览器，session也不会销毁。</span><br><span class="line">&gt; 1. 关闭服务器</span><br><span class="line">&gt; 1. session会话时间过期。 有效期过了，默认有效期： 30分钟。</span><br></pre></td></tr></table></figure>
<p>   <strong>简单购物车</strong></p>
<p>   <img src="/2019/01/26/JavaWeb知识/JavaWeb/img18.png" alt="img18"></p>
<p>   <strong>CartServlet 代码</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(&quot;text/html;charset=utf-8&quot;);</span><br><span class="line">	</span><br><span class="line">	//1. 获取要添加到购物车的商品id</span><br><span class="line">	int id = Integer.parseInt(request.getParameter(&quot;id&quot;)); // 0 - 1- 2 -3 -4 </span><br><span class="line">	String [] names = &#123;&quot;Iphone7&quot;,&quot;小米6&quot;,&quot;三星Note8&quot;,&quot;魅族7&quot; , &quot;华为9&quot;&#125;;</span><br><span class="line">	//取到id对应的商品名称</span><br><span class="line">	String name = names[id];</span><br><span class="line">	</span><br><span class="line">	//2. 获取购物车存放东西的session  Map&lt;String , Integer&gt;  iphoen7 3</span><br><span class="line">	//把一个map对象存放到session里面去，并且保证只存一次。 </span><br><span class="line">	Map&lt;String, Integer&gt; map = (Map&lt;String, Integer&gt;) request.getSession().getAttribute(&quot;cart&quot;);</span><br><span class="line">	//session里面没有存放过任何东西。</span><br><span class="line">	if(map == null)&#123;</span><br><span class="line">		map = new LinkedHashMap&lt;String , Integer&gt;();</span><br><span class="line">		request.getSession().setAttribute(&quot;cart&quot;, map);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//3. 判断购物车里面有没有该商品</span><br><span class="line">	if(map.containsKey(name))&#123;</span><br><span class="line">		//在原来的值基础上  + 1 </span><br><span class="line">		map.put(name, map.get(name) + 1 );</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		//没有购买过该商品，当前数量为1 。</span><br><span class="line">		map.put(name, 1);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//4. 输出界面。（跳转）</span><br><span class="line">	response.getWriter().write(&quot;&lt;a href=&apos;product_list.jsp&apos;&gt;&lt;h3&gt;继续购物&lt;/h3&gt;&lt;/a&gt;&lt;br&gt;&quot;);</span><br><span class="line">	response.getWriter().write(&quot;&lt;a href=&apos;cart.jsp&apos;&gt;&lt;h3&gt;去购物车结算&lt;/h3&gt;&lt;/a&gt;&quot;);</span><br></pre></td></tr></table></figure>
<p>   <strong>移除Session中的元素</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//强制干掉会话，里面存放的任何数据就都没有了。</span><br><span class="line">session.invalidate();</span><br><span class="line"></span><br><span class="line">//从session中移除某一个数据</span><br><span class="line">//session.removeAttribute(&quot;cart&quot;);</span><br></pre></td></tr></table></figure>
<p>   <strong>总结：</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">- 请求转发和重定向（面试经常问。）</span><br><span class="line">- Cookie</span><br><span class="line">  服务器给客户端发送一小份数据， 存放在客户端上。</span><br><span class="line">  基本用法：</span><br><span class="line">  	添加cookie</span><br><span class="line">	获取cookie。</span><br><span class="line">演练例子：</span><br><span class="line">1. 获取上一次访问时间</span><br><span class="line">2. 获取商品浏览记录。</span><br><span class="line">- 什么时候有cookie</span><br><span class="line">  response.addCookie(new Cookie())</span><br><span class="line">- Cookie 分类</span><br><span class="line">&gt;&gt;会话Cookie </span><br><span class="line">  	关闭浏览器，就失效</span><br><span class="line">&gt;&gt;持久cookie</span><br><span class="line">	存放在客户端上。 在指定的期限内有效。 </span><br><span class="line">	setMaxAge();</span><br><span class="line">	</span><br><span class="line">- Session</span><br><span class="line">也是基于cookie的一种会话技术，  数据存放存放在服务器端</span><br><span class="line">会在cookie里面添加一个字段 JSESSIONID . 是tomcat服务器生成。 </span><br><span class="line"></span><br><span class="line">&gt;&gt;setAttribute 存数据</span><br><span class="line">&gt;&gt;getAttribute 取数据</span><br><span class="line">&gt;&gt;removeAttribute  移除数据</span><br><span class="line">&gt;&gt;getSessionId();  获取会话id</span><br><span class="line">&gt;&gt;invalidate() 强制让会话失效。</span><br><span class="line"></span><br><span class="line">- 创建和销毁</span><br><span class="line">  ，调用request.getSesion创建 </span><br><span class="line">   服务器关闭 ， 会话超时（30分）</span><br><span class="line">   setAttribute 存放的值， 在浏览器关闭后，还有没有。  有！，就算客户端把电脑砸了也还有。</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="JSP-amp-EL-amp-JSTL"><a href="#JSP-amp-EL-amp-JSTL" class="headerlink" title="JSP &amp; EL &amp; JSTL"></a>JSP &amp; EL &amp; JSTL</h1><p>   <strong>jsp</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Java Server Page </span><br><span class="line"></span><br><span class="line">- 什么是jsp</span><br><span class="line">&gt; 从用户角度看待 ，就是是一个网页 ， 从程序员角度看待 ， 其实是一个java类， 它继承了servlet，所以可以直接说jsp 就是一个Servlet.</span><br><span class="line"></span><br><span class="line">- 为什么会有jsp?</span><br><span class="line">&gt; html 多数情况下用来显示静态内容 ， 一成不变的。 但是有时候我们需要在网页上显示一些动态数据， 比如： 查询所有的学生信息， 根据姓名去查询具体某个学生。  这些动作都需要去查询数据库，然后在网页上显示。 html是不支持写java代码  ， jsp里面可以写java代码。</span><br></pre></td></tr></table></figure>
<p>   <strong>怎么用JSP</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">指令写法</span><br><span class="line">&lt;%@ 指令名字 %&gt;</span><br></pre></td></tr></table></figure>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">page指令</span><br><span class="line">- language</span><br><span class="line">&gt;&gt;&gt;&gt;表明jsp页面中可以写java代码</span><br><span class="line">- contentType</span><br><span class="line">&gt;&gt;&gt;&gt;其实即使说这个文件是什么类型，告诉浏览器我是什么内容类型，以及使用什么编码</span><br><span class="line">	contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">	text/html  MIMEType 这是一个文本，html网页</span><br><span class="line">- pageEncoding  jsp内容编码</span><br><span class="line">- extends 用于指定jsp翻译成java文件后，继承的父类是谁，一般不用改。</span><br><span class="line">- import 导包使用的，一般不用手写。</span><br><span class="line">- session </span><br><span class="line">&gt;&gt;&gt;&gt;值可选的有true or false .</span><br><span class="line"> 	用于控制在这个jsp页面里面，能够直接使用session对象。</span><br><span class="line"> 	具体的区别是，请看翻译后的java文件   如果该值是true , 那么在代码里面会有getSession（）的	调用，如果是false :  那么就不会有该方法调用，也就是没有session对象了。在页面上自然也就不	能使用session了。</span><br><span class="line">- errorPage</span><br><span class="line">&gt;&gt;&gt;&gt;指的是错误的页面， 值需要给错误的页面路径</span><br><span class="line">- isErrorPage</span><br><span class="line">&gt;&gt;&gt;&gt;上面的errorPage 用于指定错误的时候跑到哪一个页面去。 那么这个isErroPage , 就是声明某一个	页面到底是不是错误的页面。</span><br></pre></td></tr></table></figure>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">include指令</span><br><span class="line">&gt; 包含另外一个jsp的内容进来。</span><br><span class="line">	&lt;%@ include file=&quot;other02.jsp&quot;%&gt;</span><br><span class="line">- 背后细节:</span><br><span class="line">&gt; 把另外一个页面的所有内容拿过来一起输出。 所有的标签元素都包含进来。</span><br></pre></td></tr></table></figure>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">taglib指令</span><br><span class="line">&lt;%@ taglib prefix=&quot;&quot;  uri=&quot;&quot;%&gt;  </span><br><span class="line">uri: 标签库路径</span><br><span class="line">prefix : 标签库的别名</span><br></pre></td></tr></table></figure>
<p>   <strong>JSP 动作标签</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:include page=&quot;&quot;&gt;&lt;/jsp:include&gt;</span><br><span class="line">&lt;jsp:param value=&quot;&quot; name=&quot;&quot;/&gt;</span><br><span class="line">&lt;jsp:forward page=&quot;&quot;&gt;&lt;/jsp:forward&gt;</span><br><span class="line"></span><br><span class="line">jsp:include</span><br><span class="line">&lt;jsp:include page=&quot;other02.jsp&quot;&gt;&lt;/jsp:include&gt;</span><br><span class="line">包含指定的页面， 这里是动态包含。 也就是不把包含的页面所有元素标签全部拿过来输出，而是把它的运行结果拿过来。 </span><br><span class="line"></span><br><span class="line">jsp:forward</span><br><span class="line">&lt;jsp:forward page=&quot;&quot;&gt;&lt;/jsp:forward&gt;</span><br><span class="line">前往哪一个页面。</span><br><span class="line">&lt;% </span><br><span class="line">	//请求转发</span><br><span class="line">	request.getRequestDispatcher(&quot;other02.jsp&quot;).forward(request, response);</span><br><span class="line">%&gt;	</span><br><span class="line"></span><br><span class="line">jsp:param</span><br><span class="line">意思是： 在包含某个页面的时候，或者在跳转某个页面的时候，加入这个参数。</span><br><span class="line">	&lt;jsp:forward page=&quot;other02.jsp&quot;&gt;</span><br><span class="line">		&lt;jsp:param value=&quot;beijing&quot; name=&quot;address&quot;/&gt;</span><br><span class="line">	&lt;/jsp:forward&gt;</span><br><span class="line">	在other02.jsp中获取参数</span><br><span class="line">	&lt;br&gt;收到的参数是：&lt;br&gt;</span><br><span class="line">&lt;%= request.getParameter(&quot;address&quot;)%&gt;</span><br></pre></td></tr></table></figure>
<p>   <strong>JSP内置对象</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&gt; 所谓内置对象，就是我们可以直接在jsp页面中使用这些对象。 不用创建。</span><br><span class="line"></span><br><span class="line">- pageContext</span><br><span class="line">- request</span><br><span class="line">- session</span><br><span class="line">- application</span><br><span class="line">以上4个是作用域对象,</span><br><span class="line"></span><br><span class="line">- 作用域 </span><br><span class="line">表示这些对象可以存值，他们的取值范围有限定。  setAttribute   和  getAttribute</span><br><span class="line">使用作用域来存储数据&lt;br&gt;</span><br><span class="line"></span><br><span class="line">	&lt;%</span><br><span class="line">		pageContext.setAttribute(&quot;name&quot;, &quot;page&quot;);</span><br><span class="line">		request.setAttribute(&quot;name&quot;, &quot;request&quot;);</span><br><span class="line">		session.setAttribute(&quot;name&quot;, &quot;session&quot;);</span><br><span class="line">		application.setAttribute(&quot;name&quot;, &quot;application&quot;);</span><br><span class="line">	%&gt;</span><br><span class="line">	</span><br><span class="line">	取出四个作用域中的值&lt;br&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;%=pageContext.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%=request.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%=session.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%=application.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	</span><br><span class="line">- 作用域范围大小：</span><br><span class="line">pageContext -- request --- session -- application</span><br></pre></td></tr></table></figure>
<p>   <strong>四个作用域的区别</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- pageContext 【PageContext】</span><br><span class="line">&gt; 作用域仅限于当前的页面。  </span><br><span class="line">&gt; 还可以获取到其他八个内置对象。</span><br><span class="line"></span><br><span class="line">- request 【HttpServletRequest】</span><br><span class="line">&gt; 作用域仅限于一次请求， 只要服务器对该请求做出了响应。 这个域中存的值就没有了。</span><br><span class="line"></span><br><span class="line">- session 【HttpSession】</span><br><span class="line">&gt; 作用域限于一次会话（多次请求与响应） 当中。 </span><br><span class="line"></span><br><span class="line">- application 【ServletContext】</span><br><span class="line">&gt; 整个工程都可以访问， 服务器关闭后就不能访问了。 </span><br><span class="line"></span><br><span class="line">- out		 【JspWriter】</span><br><span class="line"></span><br><span class="line">- response  【HttpServletResponse】</span><br><span class="line"></span><br><span class="line">- exception  【Throwable】</span><br><span class="line"></span><br><span class="line">- page	 【Object】 ---就是这个jsp翻译成的java类的实例对象</span><br><span class="line"></span><br><span class="line">- config 【ServletConfig】</span><br></pre></td></tr></table></figure>
<p>   <img src="/2019/01/26/JavaWeb知识/JavaWeb/img19.png" alt="img19"></p>
<p>   <strong>EL表达式</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; 是为了简化咱们的jsp代码，具体一点就是为了简化在jsp里面写的那些java代码。</span><br><span class="line">- 写法格式</span><br><span class="line">$&#123;表达式 &#125;</span><br><span class="line">&gt; 如果从作用域中取值，会先从小的作用域开始取，如果没有，就往下一个作用域取。  一直把四个作用域取完都没有， 就没有显示。</span><br></pre></td></tr></table></figure>
<p>   <strong>如何使用</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">1. 取出4个作用域中存放的值。</span><br><span class="line">&lt;%</span><br><span class="line">		pageContext.setAttribute(&quot;name&quot;, &quot;page&quot;);</span><br><span class="line">		request.setAttribute(&quot;name&quot;, &quot;request&quot;);</span><br><span class="line">		session.setAttribute(&quot;name&quot;, &quot;session&quot;);</span><br><span class="line">		application.setAttribute(&quot;name&quot;, &quot;application&quot;);</span><br><span class="line">	%&gt;</span><br><span class="line">	</span><br><span class="line">	按普通手段取值&lt;br&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;%= pageContext.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%= request.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%= session.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%= application.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;br&gt;使用EL表达式取出作用域中的值&lt;br&gt;</span><br><span class="line">	</span><br><span class="line">	$&#123; pageScope.name &#125;</span><br><span class="line">	$&#123; requestScope.name &#125;</span><br><span class="line">	$&#123; sessionScope.name &#125;</span><br><span class="line">	$&#123; applicationScope.name &#125;</span><br><span class="line">	</span><br><span class="line">2.如果域中所存的是数组</span><br><span class="line">&lt;%</span><br><span class="line">			String [] a = &#123;&quot;aa&quot;,&quot;bb&quot;,&quot;cc&quot;,&quot;dd&quot;&#125;;</span><br><span class="line">			pageContext.setAttribute(&quot;array&quot;, a);</span><br><span class="line">%&gt;</span><br><span class="line">使用EL表达式取出作用域中数组的值&lt;br&gt;	</span><br><span class="line">$&#123;array[0] &#125; , $&#123;array[1] &#125;,$&#123;array[2] &#125;,$&#123;array[3] &#125;</span><br><span class="line"></span><br><span class="line">3.如果域中锁存的是集合</span><br><span class="line">	使用EL表达式取出作用域中集合的值&lt;br&gt;</span><br><span class="line"></span><br><span class="line">	$&#123;li[0] &#125; , $&#123;li[1] &#125;,$&#123;li[2] &#125;,$&#123;li[3] &#125;</span><br><span class="line"></span><br><span class="line">	&lt;br&gt;-------------Map数据----------------&lt;br&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">		Map map = new HashMap();</span><br><span class="line">		map.put(&quot;name&quot;, &quot;zhangsna&quot;);</span><br><span class="line">		map.put(&quot;age&quot;,18);</span><br><span class="line">		map.put(&quot;address&quot;,&quot;北京..&quot;);</span><br><span class="line">		</span><br><span class="line">		map.put(&quot;address.aa&quot;,&quot;深圳..&quot;);</span><br><span class="line">		</span><br><span class="line">		pageContext.setAttribute(&quot;map&quot;, map);</span><br><span class="line">	%&gt;</span><br><span class="line">	</span><br><span class="line">4.取出Map集合的值</span><br><span class="line">&lt;%</span><br><span class="line">		Map map = new HashMap();</span><br><span class="line">		map.put(&quot;name&quot;, &quot;zhangsna&quot;);</span><br><span class="line">		map.put(&quot;age&quot;,18);</span><br><span class="line">		map.put(&quot;address&quot;,&quot;北京..&quot;);</span><br><span class="line">		map.put(&quot;address.aa&quot;,&quot;深圳..&quot;);</span><br><span class="line">		pageContext.setAttribute(&quot;map&quot;, map);</span><br><span class="line">   	%&gt;</span><br><span class="line">   	使用EL表达式取出作用域中Map的值&lt;br&gt;</span><br><span class="line">   	$&#123;map.name &#125; , $&#123;map.age &#125; , $&#123;map.address &#125;  , $&#123;map[&quot;address.aa&quot;] &#125;</span><br></pre></td></tr></table></figure>
<p>   <strong>取值细节：</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">1. 从域中取值。得先存值。</span><br><span class="line">   &lt;%</span><br><span class="line">   //pageContext.setAttribute(&quot;name&quot;, &quot;zhangsan&quot;);</span><br><span class="line">   session.setAttribute(&quot;name&quot;, &quot;lisi...&quot;);</span><br><span class="line">   %&gt;</span><br><span class="line"></span><br><span class="line">   &lt;br&gt;直接指定说了，到这个作用域里面去找这个name&lt;br&gt;</span><br><span class="line">   $&#123; pageScope.name &#125; </span><br><span class="line"></span><br><span class="line">   &lt;br&gt;//先从page里面找，没有去request找，去session，去application &lt;br&gt;</span><br><span class="line">   $&#123; name &#125;</span><br><span class="line"></span><br><span class="line">   &lt;br&gt;指定从session中取值&lt;br&gt;</span><br><span class="line">   $&#123; sessionScope.name &#125;  </span><br><span class="line"></span><br><span class="line">2. 取值方式</span><br><span class="line">如果这份值是有下标的，那么直接使用[]</span><br><span class="line">&lt;%</span><br><span class="line">	String [] array = &#123;&quot;aa&quot;,&quot;bb&quot;,&quot;cc&quot;&#125;</span><br><span class="line">	session.setAttribute(&quot;array&quot;,array);</span><br><span class="line">%&gt;</span><br><span class="line">$&#123; array[1] &#125; --&gt; 这里array说的是attribute的name </span><br><span class="line">如果没有下标， 直接使用 .的方式去取</span><br><span class="line">&lt;%</span><br><span class="line">	User user = new User(&quot;zhangsan&quot;,18);</span><br><span class="line">	session.setAttribute(&quot;u&quot;, user);</span><br><span class="line">%&gt;</span><br><span class="line">$&#123; u.name &#125;  , $&#123; u.age &#125; </span><br><span class="line">一般使用EL表达式，用的比较多的，都是从一个对象中取出它的属性值，比如取出某一个学生的姓名。</span><br></pre></td></tr></table></figure>
<p>   <strong>EL表达式 的11个内置对象。</strong> </p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$&#123; 对象名.成员 &#125;</span><br><span class="line"></span><br><span class="line">- pageContext </span><br><span class="line">作用域相关对象</span><br><span class="line"></span><br><span class="line">- pageScope</span><br><span class="line">- requestScope</span><br><span class="line">- sessionScope</span><br><span class="line">- applicationScope</span><br><span class="line"></span><br><span class="line">头信息相关对象</span><br><span class="line">- header</span><br><span class="line">- headerValues</span><br><span class="line"></span><br><span class="line">参数信息相关对象</span><br><span class="line">- param</span><br><span class="line">- paramValues</span><br><span class="line"></span><br><span class="line">- cookie</span><br><span class="line">  全局初始化参数</span><br><span class="line">- initParam</span><br></pre></td></tr></table></figure>
<p>   <strong>JSTL</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; 全称 ： JSP Standard Tag Library  jsp标准标签库</span><br><span class="line"></span><br><span class="line">&gt; 简化jsp的代码编写。 替换 &lt;%%&gt; 写法。 一般与EL表达式配合</span><br><span class="line"></span><br><span class="line">###怎么使用</span><br><span class="line">1. 导入jar文件到工程的WebContent/Web-Inf/lib  jstl.jar standard.jar</span><br><span class="line">2. 在jsp页面上，使用taglib 指令，来引入标签库</span><br><span class="line">3. 注意： 如果想支持 EL表达式，那么引入的标签库必须选择1.1的版本，1.0的版本不支持EL表达式。</span><br><span class="line">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;</span><br></pre></td></tr></table></figure>
<p>   <strong>常用标签</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:set&gt;&lt;/c:set&gt;</span><br><span class="line">&lt;c:if test=&quot;&quot;&gt;&lt;/c:if&gt;</span><br><span class="line">&lt;c:forEach&gt;&lt;/c:forEach&gt;</span><br><span class="line"></span><br><span class="line">- c:set</span><br><span class="line">	&lt;!-- 声明一个对象name， 对象的值 zhangsan , 存储到了page（默认） ， 指定是session --&gt;</span><br><span class="line">	&lt;c:set var=&quot;name&quot; value=&quot;zhangsan&quot; scope=&quot;session&quot;&gt;&lt;/c:set&gt;</span><br><span class="line">	$&#123;sessionScope.name &#125;</span><br><span class="line">	</span><br><span class="line">- c:if</span><br><span class="line">&gt; 判断test里面的表达式是否满足，如果满足，就执行c:if标签中的输出 ， c:if 是没有else的。 </span><br><span class="line">&lt;c:set var=&quot;age&quot; value=&quot;18&quot; &gt;&lt;/c:set&gt;</span><br><span class="line">	&lt;c:if test=&quot;$&#123; age &gt; 26 &#125;&quot;&gt;</span><br><span class="line">		年龄大于了26岁...</span><br><span class="line">	&lt;/c:if&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;c:if test=&quot;$&#123; age &lt;= 26 &#125;&quot;&gt;</span><br><span class="line">		年龄小于了26岁...</span><br><span class="line">	&lt;/c:if&gt;</span><br><span class="line">	</span><br><span class="line">		------------------------------</span><br><span class="line"></span><br><span class="line">	定义一个变量名 flag  去接收前面表达式的值，然后存在session域中</span><br><span class="line"></span><br><span class="line">	&lt;c:if test=&quot;$&#123; age &gt; 26 &#125;&quot; var=&quot;flag&quot; scope=&quot;session&quot;&gt;</span><br><span class="line">		年龄大于了26岁...</span><br><span class="line">	&lt;/c:if&gt;</span><br><span class="line">	</span><br><span class="line">- c:forEach</span><br><span class="line">	从1 开始遍历到10 ，得到的结果 ，赋值给 i ,并且会存储到page域中， step , 增幅为2， </span><br><span class="line">	&lt;c:forEach begin=&quot;1&quot; end=&quot;10&quot; var=&quot;i&quot; step=&quot;2&quot;&gt;</span><br><span class="line">		$&#123;i &#125;</span><br><span class="line">	&lt;/c:forEach&gt;</span><br><span class="line">	</span><br><span class="line">		-----------------------------------------------</span><br><span class="line"></span><br><span class="line">	&lt;!-- items : 表示遍历哪一个对象，注意，这里必须写EL表达式。 </span><br><span class="line">	var: 遍历出来的每一个元素用user 去接收。 --&gt;</span><br><span class="line">	&lt;c:forEach var=&quot;user&quot; items=&quot;$&#123;list &#125;&quot;&gt;</span><br><span class="line">		$&#123;user.name &#125; ----$&#123;user.age &#125;</span><br><span class="line">	&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<p><strong>学生信息管理系统</strong></p>
<p>需求分析</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img20.png" alt="img20"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">1. 先写 login.jsp , 并且搭配一个LoginServlet 去获取登录信息。</span><br><span class="line">2. 创建用户表， 里面只要有id , username  和 password</span><br><span class="line">3. 创建UserDao, 定义登录的方法 </span><br><span class="line">     	/**</span><br><span class="line"></span><br><span class="line">   - 该dao定义了对用户表的访问规则</span><br><span class="line">      */</span><br><span class="line">     public interface UserDao &#123;</span><br><span class="line">     1. - - 这里简单就返回一个Boolean类型， 成功或者失败即可。</span><br><span class="line">       - </span><br><span class="line">       - 但是开发的时候，登录的方法，一旦成功。这里应该返回该用户的个人信息</span><br><span class="line">       - @param userName </span><br><span class="line">       - @param password</span><br><span class="line">       - </span><br><span class="line">       - @return true : 登录成功， false : 登录失败。</span><br><span class="line">         */</span><br><span class="line">           boolean login(String userName , String password);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">4. 创建UserDaoImpl , 实现刚才定义的登录方法。</span><br><span class="line"> 	public class UserDaoImpl implements UserDao &#123;</span><br><span class="line"></span><br><span class="line">		@Override</span><br><span class="line">		public boolean login(String userName , String password) &#123;</span><br><span class="line">			</span><br><span class="line">			Connection conn = null;</span><br><span class="line">			PreparedStatement ps = null;</span><br><span class="line">			ResultSet rs   = null;</span><br><span class="line">			try &#123;</span><br><span class="line">				//1. 得到连接对象</span><br><span class="line">				conn = JDBCUtil.getConn();</span><br><span class="line">				</span><br><span class="line">				String sql = &quot;select * from t_user where username=? and password=?&quot;;</span><br><span class="line">				</span><br><span class="line">				//2. 创建ps对象</span><br><span class="line">				ps = conn.prepareStatement(sql);</span><br><span class="line">				ps.setString(1, userName);</span><br><span class="line">				ps.setString(2, password);</span><br><span class="line">				</span><br><span class="line">					//3. 开始执行。</span><br><span class="line">				rs = ps.executeQuery();</span><br><span class="line">				</span><br><span class="line">				//如果能够成功移到下一条记录，那么表明有这个用户。 </span><br><span class="line">				return rs.next();</span><br><span class="line">				</span><br><span class="line">			&#125; catch (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;finally &#123;</span><br><span class="line">				JDBCUtil.release(conn, ps, rs);</span><br><span class="line">			&#125;</span><br><span class="line">			return false;</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">5. 在LoginServlet里面访问UserDao， 判断登录结果。 以区分对待</span><br><span class="line">6. 创建stu_list.jsp , 让登录成功的时候跳转过去。</span><br><span class="line">7. 创建学生表 ， 里面字段随意。 </span><br><span class="line">8. 定义学生的Dao . StuDao  </span><br><span class="line">		public interface StuDao &#123;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * 查询出来所有的学生信息</span><br><span class="line">		 * @return List集合</span><br><span class="line">		 */</span><br><span class="line">		List&lt;Student&gt; findAll();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">9.对上面定义的StuDao 做出实现 StuDaoImpl</span><br><span class="line">public class StuDaoImpl implements StuDao &#123;</span><br><span class="line">	@Override</span><br><span class="line">	public List&lt;Student&gt; findAll() &#123;</span><br><span class="line">		List&lt;Student&gt; list = new ArrayList&lt;Student&gt;();</span><br><span class="line">		Connection conn = null;</span><br><span class="line">		PreparedStatement ps = null;</span><br><span class="line">		ResultSet rs   = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			//1. 得到连接对象</span><br><span class="line">			conn = JDBCUtil.getConn();</span><br><span class="line">			</span><br><span class="line">			String sql = &quot;select * from t_stu&quot;;</span><br><span class="line">			</span><br><span class="line">			ps = conn.prepareStatement(sql);</span><br><span class="line">			</span><br><span class="line">			rs = ps.executeQuery();</span><br><span class="line">			   				</span><br><span class="line">   				//数据多了，用对象装， 对象也多了呢？ 用集合装。 </span><br><span class="line">   				while(rs.next())&#123; //10 次 ，10个学生</span><br><span class="line">   					</span><br><span class="line">   					Student stu = new Student();</span><br><span class="line">   					</span><br><span class="line">   					stu.setId(rs.getInt(&quot;id&quot;));</span><br><span class="line">   					stu.setAge(rs.getInt(&quot;age&quot;));</span><br><span class="line">   					stu.setName(rs.getString(&quot;name&quot;));</span><br><span class="line">   					stu.setGender(rs.getString(&quot;gender&quot;));</span><br><span class="line">   					stu.setAddress(rs.getString(&quot;address&quot;));</span><br><span class="line">   					</span><br><span class="line">   					list.add(stu);</span><br><span class="line">   					</span><br><span class="line">   				&#125;</span><br><span class="line">   			&#125; catch (SQLException e) &#123;</span><br><span class="line">   				e.printStackTrace();</span><br><span class="line">   			&#125;finally &#123;</span><br><span class="line">   				JDBCUtil.release(conn, ps, rs);</span><br><span class="line">   			&#125;</span><br><span class="line">   			</span><br><span class="line">   			return list;</span><br><span class="line">   		&#125;</span><br><span class="line">   	</span><br><span class="line">   	&#125;</span><br><span class="line">   	</span><br><span class="line">10. 在登录成功的时候，完成三件事情。</span><br><span class="line">11. 查询所有的学生</span><br><span class="line">   1. 把这个所有的学生集合存储到作用域中。</span><br><span class="line">   2. 跳转到stu_list.jsp</span><br><span class="line">   </span><br><span class="line">   		protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">		//提交的数据有可能有中文， 怎么处理。</span><br><span class="line">		request.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">		response.setContentType(&quot;text/html;charset=utf-8&quot;);</span><br><span class="line">		</span><br><span class="line">		//1. 获取客户端提交的信息</span><br><span class="line">		String userName = request.getParameter(&quot;username&quot;);</span><br><span class="line">		String password = request.getParameter(&quot;password&quot;);</span><br><span class="line">		</span><br><span class="line">		//2. 去访问dao ， 看看是否满足登录。</span><br><span class="line">		UserDao dao = new UserDaoImpl();</span><br><span class="line">		boolean isSuccess = dao.login(userName, password);</span><br><span class="line">		</span><br><span class="line">		//3. 针对dao的返回结果，做出响应</span><br><span class="line">		if(isSuccess)&#123;</span><br><span class="line">			//response.getWriter().write(&quot;登录成功.&quot;);</span><br><span class="line">			</span><br><span class="line">			//1. 查询出来所有的学生信息。</span><br><span class="line">			StuDao stuDao = new StuDaoImpl();</span><br><span class="line">			List&lt;Student&gt; list = stuDao.findAll();</span><br><span class="line">			</span><br><span class="line">			//2. 先把这个集合存到作用域中。</span><br><span class="line">			request.getSession().setAttribute(&quot;list&quot;, list);</span><br><span class="line">			</span><br><span class="line">			//2. 重定向</span><br><span class="line">			response.sendRedirect(&quot;stu_list.jsp&quot;);</span><br><span class="line">			</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			response.getWriter().write(&quot;用户名或者密码错误！&quot;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">11.在stu_list.jsp中，取出域中的集合，然后使用c标签 去遍历集合。 </span><br><span class="line">	&lt;table border=&quot;1&quot; width=&quot;700&quot;&gt;</span><br><span class="line">	&lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">		&lt;td&gt;编号&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;姓名&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;年龄&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;性别&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;住址&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;操作&lt;/td&gt;</span><br><span class="line">	&lt;/tr&gt;</span><br><span class="line"></span><br><span class="line">	&lt;c:forEach items=&quot;$&#123;list &#125;&quot; var=&quot;stu&quot;&gt;</span><br><span class="line">		&lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">			&lt;td&gt;$&#123;stu.id &#125;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;$&#123;stu.name &#125;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;$&#123;stu.age &#125;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;$&#123;stu.gender &#125;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;$&#123;stu.address &#125;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;a href=&quot;#&quot;&gt;更新&lt;/a&gt;   &lt;a href=&quot;#&quot;&gt;删除&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">	&lt;/c:forEach&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">JSP</span><br><span class="line">三大指令</span><br><span class="line">	page</span><br><span class="line">	include</span><br><span class="line">	taglib</span><br><span class="line">三个动作标签</span><br><span class="line">	&lt;jsp:include&gt;</span><br><span class="line">	&lt;jsp:forward&gt;</span><br><span class="line">	&lt;jsp:param&gt;</span><br><span class="line">	</span><br><span class="line">&gt;&gt;&gt;&gt;九个内置对象</span><br><span class="line"></span><br><span class="line">&gt;&gt;四个作用域</span><br><span class="line">pageContext</span><br><span class="line">request</span><br><span class="line">session</span><br><span class="line">application</span><br><span class="line"></span><br><span class="line">out</span><br><span class="line">exception</span><br><span class="line">response</span><br><span class="line">page</span><br><span class="line">config</span><br><span class="line"></span><br><span class="line">&gt;&gt;EL</span><br><span class="line">$&#123; 表达式 &#125;</span><br><span class="line">取4个作用域中的值</span><br><span class="line">$&#123; name &#125;</span><br><span class="line">&gt;&gt;&gt;有11个内置对象。			</span><br><span class="line">pageContext</span><br><span class="line"></span><br><span class="line">pageScope</span><br><span class="line">requestScope</span><br><span class="line">sessionScope</span><br><span class="line">applicationScope</span><br><span class="line"></span><br><span class="line">header</span><br><span class="line">headerValues</span><br><span class="line"></span><br><span class="line">param</span><br><span class="line">paramValues</span><br><span class="line"></span><br><span class="line">cookie</span><br><span class="line">initParam</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">JSTL</span><br><span class="line">&gt; 使用1.1的版本， 支持EL表达式， 1.0不支持EL表达式</span><br><span class="line"></span><br><span class="line">&gt; 拷贝jar包， 通过taglib 去引入标签库</span><br><span class="line">&lt;c:set&gt;</span><br><span class="line">&lt;c:if&gt;</span><br><span class="line">&lt;c:forEach&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="事务-amp-数据库连接池-amp-DBUtils"><a href="#事务-amp-数据库连接池-amp-DBUtils" class="headerlink" title="事务&amp;数据库连接池&amp;DBUtils"></a>事务&amp;数据库连接池&amp;DBUtils</h1><p><strong>事务</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; Transaction  其实指的一组操作，里面包含许多个单一的逻辑。只要有一个逻辑没有执行成功，那么都算失败。 所有的数据都回归到最初的状态(回滚)</span><br><span class="line"> </span><br><span class="line">- 为什么要有事务?</span><br><span class="line">为了确保逻辑的成功。 例子： 银行的转账。</span><br></pre></td></tr></table></figure>
<p><strong>使用命令行方式演示事务。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- 开启事务</span><br><span class="line">  start transaction;</span><br><span class="line">- 提交或者回滚事务</span><br><span class="line">  commit; 提交事务， 数据将会写到磁盘上的数据库</span><br><span class="line">  rollback ;  数据回滚，回到最初的状态。</span><br></pre></td></tr></table></figure>
<p>1.关闭自动提交功能。</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img21.png" alt="img21"></p>
<p>2.演示事务</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img22.png" alt="img22"></p>
<p><strong>使用代码方式演示事务</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&gt; 代码里面的事务，主要是针对连接来的。 </span><br><span class="line">&gt; 1. 通过conn.setAutoCommit（false ）来关闭自动提交的设置。</span><br><span class="line">&gt; 2. 提交事务  conn.commit();</span><br><span class="line">&gt; 3. 回滚事务 conn.rollback();</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">public void testTransaction()&#123;</span><br><span class="line">	</span><br><span class="line">	Connection conn = null;</span><br><span class="line">	PreparedStatement ps = null;</span><br><span class="line">	ResultSet rs = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		conn = JDBCUtil.getConn();</span><br><span class="line">		</span><br><span class="line">		//连接，事务默认就是自动提交的。 关闭自动提交。</span><br><span class="line">		conn.setAutoCommit(false);</span><br><span class="line">		</span><br><span class="line">		String sql = &quot;update account set money = money - ? where id = ?&quot;;</span><br><span class="line">		ps = conn.prepareStatement(sql);</span><br><span class="line">		</span><br><span class="line">		//扣钱， 扣ID为1 的100块钱</span><br><span class="line">		ps.setInt(1, 100);</span><br><span class="line">		ps.setInt(2, 1);</span><br><span class="line">		ps.executeUpdate();</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		int a = 10 /0 ;</span><br><span class="line">		</span><br><span class="line">		//加钱， 给ID为2 加100块钱</span><br><span class="line">		ps.setInt(1, -100);</span><br><span class="line">		ps.setInt(2, 2);</span><br><span class="line">		ps.executeUpdate();</span><br><span class="line">		</span><br><span class="line">		//成功： 提交事务。</span><br><span class="line">		conn.commit();</span><br><span class="line">		</span><br><span class="line">	&#125; catch (SQLException e) &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			//事变： 回滚事务</span><br><span class="line">			conn.rollback();</span><br><span class="line">		&#125; catch (SQLException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		</span><br><span class="line">	&#125;finally &#123;</span><br><span class="line">		JDBCUtil.release(conn, ps, rs);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>事务的特性</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- 原子性</span><br><span class="line">&gt; 指的是 事务中包含的逻辑，不可分割。 </span><br><span class="line"></span><br><span class="line">- 一致性</span><br><span class="line">&gt; 指的是 事务执行前后。数据完整性</span><br><span class="line"></span><br><span class="line">- 隔离性</span><br><span class="line">&gt; 指的是 事务在执行期间不应该受到其他事务的影响</span><br><span class="line"></span><br><span class="line">- 持久性</span><br><span class="line">&gt; 指的是 事务执行成功，那么数据应该持久保存到磁盘上。</span><br></pre></td></tr></table></figure>
<p><strong>事务的安全隐患 </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; 不考虑隔离级别设置，那么会出现以下问题。</span><br><span class="line"></span><br><span class="line">- 读</span><br><span class="line"></span><br><span class="line">&gt; 脏读 不可重读读  幻读.</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;脏读</span><br><span class="line">&gt; 一个事务读到另外一个事务还未提交的数据</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;不可重复读 </span><br><span class="line">&gt; 一个事务读到了另外一个事务提交的数据 ，造成了前后两次查询结果不一致。</span><br><span class="line"></span><br><span class="line">写</span><br><span class="line">丢失更新</span><br></pre></td></tr></table></figure>
<p><strong>读未提交 演示</strong></p>
<p>1.设置A窗口的隔离级别为 读未提交 </p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img23.png" alt="img23"></p>
<p>2.两个窗口都分别开启事务</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img24.png" alt="img24"></p>
<p><strong>读已提交演示</strong></p>
<p>1.设置A窗口的隔离级别为 读已提交</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img25.png" alt="img25"></p>
<p>2.A B 两个窗口都开启事务， 在B窗口执行更新操作</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img26.png" alt="img26"></p>
<p>3.在A窗口执行的查询结果不一致。 一次是在B窗口提交事务之前，一次是在B窗口提交事务之后。</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img27.png" alt="img27"></p>
<blockquote>
<p>这个隔离级别能够屏蔽 脏读的现象， 但是引发了另一个问题  ，不可重复读。</p>
</blockquote>
<p><strong>可串行化</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; 如果有一个连接的隔离级别设置为了串行化 ，那么谁先打开了事务， 谁就有了先执行的权利， 谁后打开事务，谁就只能得着，等前面的那个事务，提交或者回滚后，才能执行。  但是这种隔离级别一般比较少用。 容易造成性能上的问题。 效率比较低。</span><br><span class="line"></span><br><span class="line">- 按效率划分，从高到低</span><br><span class="line">&gt; 读未提交  &gt; 读已提交  &gt; 可重复读  &gt; 可串行化</span><br><span class="line"></span><br><span class="line">- 按拦截程度 ，从高到底</span><br><span class="line">&gt; 可串行化 &gt; 可重复读 &gt; 读已提交 &gt;  读未提交</span><br></pre></td></tr></table></figure>
<p><strong>事务总结</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">需要掌握的</span><br><span class="line"></span><br><span class="line">1.在代码里面会使用事务 </span><br><span class="line">conn.setAutoCommit(false);</span><br><span class="line"></span><br><span class="line">	conn.commit();</span><br><span class="line">	conn.rollback();</span><br><span class="line">	</span><br><span class="line">2 事务只是针对连接连接对象，如果再开一个连接对象，那么那是默认的提交。</span><br><span class="line">3. 事务是会自动提交的。 </span><br><span class="line"></span><br><span class="line">需要了解的</span><br><span class="line">&gt;&gt;安全隐患</span><br><span class="line">	读</span><br><span class="line">	脏读</span><br><span class="line">		一个事务读到了另一个事务未提交的数据</span><br><span class="line">	不可重复读</span><br><span class="line">		一个事务读到了另一个事务已提交的数据，造成前后两次查询结果不一致</span><br><span class="line">	幻读</span><br><span class="line">		一个事务读到了另一个事务insert的数据 ，造成前后查询结果不一致 。</span><br><span class="line"></span><br><span class="line">	写</span><br><span class="line"></span><br><span class="line">	丢失更新。</span><br><span class="line"></span><br><span class="line">&gt;&gt;隔离级别</span><br><span class="line">读未提交</span><br><span class="line"></span><br><span class="line">&gt; 引发问题： 脏读 </span><br><span class="line">读已提交</span><br><span class="line"></span><br><span class="line">&gt; 解决： 脏读 ， 引发： 不可重复读</span><br><span class="line">可重复读</span><br><span class="line"></span><br><span class="line">&gt; 解决： 脏读 、 不可重复读 ， 未解决： 幻读</span><br><span class="line">可串行化</span><br><span class="line"></span><br><span class="line">&gt; 解决： 脏读、 不可重复读 、 幻读。</span><br><span class="line">	</span><br><span class="line">mySql 默认的隔离级别是 可重复读</span><br><span class="line">Oracle 默认的隔离级别是  读已提交</span><br><span class="line"></span><br><span class="line">&gt;&gt;丢失更新</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img28.png" alt="img28"></p>
<p><strong>解决丢失更新</strong></p>
<ul>
<li>悲观锁</li>
</ul>
<blockquote>
<p>可以在查询的时候，加入 for update</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img29.png" alt="img29"></p>
</blockquote>
<ul>
<li>乐观锁</li>
</ul>
<blockquote>
<p>要求程序员自己控制。 </p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img30.png" alt="img30"></p>
</blockquote>
<p><strong>数据库连接池</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; 1. 数据库的连接对象创建工作，比较消耗性能。 </span><br><span class="line"></span><br><span class="line">&gt; 2.一开始现在内存中开辟一块空间（集合） ， 一开先往池子里面放置 多个连接对象。  后面需要连接的话，直接从池子里面去。不要去自己创建连接了。  使用完毕， 要记得归还连接。确保连接对象能循环利用。</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img31.png" alt="img31"></p>
<p><strong>自定义数据库连接池 </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- 代码实现</span><br><span class="line">- 出现的问题：</span><br><span class="line">  1. 需要额外记住 addBack方法</span><br><span class="line"></span><br><span class="line">  2. 单例。</span><br><span class="line"></span><br><span class="line">  3. 无法面向接口编程。 </span><br><span class="line">        UserDao dao = new UserDaoImpl();</span><br><span class="line">        dao.insert();</span><br><span class="line"> 		DataSource dataSource = new MyDataSource();</span><br><span class="line"> 		因为接口里面没有定义addBack方法。 </span><br><span class="line"></span><br><span class="line"> 4.怎么解决?   以addBack 为切入点。</span><br></pre></td></tr></table></figure>
<p><strong>解决自定义数据库连接池出现的问题。 </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; 由于多了一个addBack 方法，所以使用这个连接池的地方，需要额外记住这个方法，并且还不能面向接口编程。</span><br><span class="line"></span><br><span class="line">&gt; 我们打算修改接口中的那个close方法。  原来的Connection对象的close方法，是真的关闭连接。 </span><br><span class="line">&gt; 打算修改这个close方法，以后在调用close， 并不是真的关闭，而是归还连接对象。</span><br><span class="line"></span><br><span class="line">###如何扩展某一个方法?</span><br><span class="line"></span><br><span class="line">&gt; 原有的方法逻辑，不是我们想要的。 想修改自己的逻辑</span><br><span class="line"></span><br><span class="line">1. 直接改源码  无法实现。</span><br><span class="line">2. 继承， 必须得知道这个接口的具体实现是谁。 </span><br><span class="line">3. 使用装饰者模式。</span><br></pre></td></tr></table></figure>
<p><strong>开源连接池</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">#### DBCP</span><br><span class="line"></span><br><span class="line">1. 导入jar文件</span><br><span class="line">2. 不使用配置文件：</span><br><span class="line">public void testDBCP01()&#123;</span><br><span class="line">	Connection conn = null;</span><br><span class="line">		PreparedStatement ps = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			</span><br><span class="line">			//1. 构建数据源对象</span><br><span class="line">			BasicDataSource dataSource = new BasicDataSource();</span><br><span class="line">			//连的是什么类型的数据库， 访问的是哪个数据库 ， 用户名， 密码。。</span><br><span class="line">			//jdbc:mysql://localhost/bank 主协议：子协议 ://本地/数据库</span><br><span class="line">			dataSource.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">			dataSource.setUrl(&quot;jdbc:mysql://localhost/bank&quot;);</span><br><span class="line">			dataSource.setUsername(&quot;root&quot;);</span><br><span class="line">			dataSource.setPassword(&quot;root&quot;);</span><br><span class="line">				//2. 得到连接对象</span><br><span class="line">			conn = dataSource.getConnection();</span><br><span class="line">			String sql = &quot;insert into account values(null , ? , ?)&quot;;</span><br><span class="line">			ps = conn.prepareStatement(sql);</span><br><span class="line">			ps.setString(1, &quot;admin&quot;);</span><br><span class="line">			ps.setInt(2, 1000);</span><br><span class="line">			</span><br><span class="line">			ps.executeUpdate();</span><br><span class="line">			</span><br><span class="line">		&#125; catch (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			JDBCUtil.release(conn, ps);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">2.使用配置文件方式：</span><br><span class="line">	Connection conn = null;</span><br><span class="line">	PreparedStatement ps = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		BasicDataSourceFactory factory = new BasicDataSourceFactory();</span><br><span class="line">		Properties properties = new Properties();</span><br><span class="line">		InputStream is = new FileInputStream(&quot;src//dbcpconfig.properties&quot;);</span><br><span class="line">		properties.load(is);</span><br><span class="line">		DataSource dataSource = factory.createDataSource(properties);</span><br><span class="line">		</span><br><span class="line">		//2. 得到连接对象</span><br><span class="line">		conn = dataSource.getConnection();</span><br><span class="line">		String sql = &quot;insert into account values(null , ? , ?)&quot;;</span><br><span class="line">		ps = conn.prepareStatement(sql);</span><br><span class="line">		ps.setString(1, &quot;liangchaowei&quot;);</span><br><span class="line">		ps.setInt(2, 100);</span><br><span class="line">		</span><br><span class="line">		ps.executeUpdate();</span><br><span class="line">		</span><br><span class="line">	&#125; catch (Exception e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;finally &#123;</span><br><span class="line">		JDBCUtil.release(conn, ps);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>C3P0</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">拷贝jar文件 到 lib目录</span><br><span class="line"></span><br><span class="line">不使用配置文件方式	</span><br><span class="line">Connection conn = null;</span><br><span class="line">	PreparedStatement ps = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		//1. 创建datasource</span><br><span class="line">		ComboPooledDataSource dataSource = new ComboPooledDataSource();</span><br><span class="line">		//2. 设置连接数据的信息</span><br><span class="line">		dataSource.setDriverClass(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">		</span><br><span class="line">		//忘记了---&gt; 去以前的代码 ---&gt; jdbc的文档</span><br><span class="line">		dataSource.setJdbcUrl(&quot;jdbc:mysql://localhost/bank&quot;);</span><br><span class="line">		dataSource.setUser(&quot;root&quot;);</span><br><span class="line">		dataSource.setPassword(&quot;root&quot;);</span><br><span class="line">		</span><br><span class="line">		//2. 得到连接对象</span><br><span class="line">		conn = dataSource.getConnection();</span><br><span class="line">		String sql = &quot;insert into account values(null , ? , ?)&quot;;</span><br><span class="line">		ps = conn.prepareStatement(sql);</span><br><span class="line">		ps.setString(1, &quot;admi234n&quot;);</span><br><span class="line">		ps.setInt(2, 103200);</span><br><span class="line">		</span><br><span class="line">		ps.executeUpdate();</span><br><span class="line">		</span><br><span class="line">	&#125; catch (Exception e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;finally &#123;</span><br><span class="line">		JDBCUtil.release(conn, ps);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">使用配置文件方式</span><br><span class="line">		//默认会找 xml 中的 default-config 分支。 </span><br><span class="line">		ComboPooledDataSource dataSource = new ComboPooledDataSource();</span><br><span class="line">		//2. 设置连接数据的信息</span><br><span class="line">		dataSource.setDriverClass(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">		</span><br><span class="line">		//忘记了---&gt; 去以前的代码 ---&gt; jdbc的文档</span><br><span class="line">		dataSource.setJdbcUrl(&quot;jdbc:mysql://localhost/bank&quot;);</span><br><span class="line">		dataSource.setUser(&quot;root&quot;);</span><br><span class="line">		dataSource.setPassword(&quot;root&quot;);</span><br><span class="line">		</span><br><span class="line">		//2. 得到连接对象</span><br><span class="line">		conn = dataSource.getConnection();</span><br><span class="line">		String sql = &quot;insert into account values(null , ? , ?)&quot;;</span><br><span class="line">		ps = conn.prepareStatement(sql);</span><br><span class="line">		ps.setString(1, &quot;admi234n&quot;);</span><br><span class="line">		ps.setInt(2, 103200);</span><br></pre></td></tr></table></figure>
<p><strong>DBUtils</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">增删改</span><br><span class="line">	//dbutils 只是帮我们简化了CRUD 的代码， 但是连接的创建以及获取工作。 不在他的考虑范围</span><br><span class="line">	QueryRunner queryRunner = new QueryRunner(new ComboPooledDataSource());	</span><br><span class="line">	</span><br><span class="line">	//增加</span><br><span class="line">	//queryRunner.update(&quot;insert into account values (null , ? , ? )&quot;, &quot;aa&quot; ,1000);</span><br><span class="line">	</span><br><span class="line">	//删除</span><br><span class="line">	//queryRunner.update(&quot;delete from account where id = ?&quot;, 5);</span><br><span class="line">	</span><br><span class="line">	//更新</span><br><span class="line">	//queryRunner.update(&quot;update account set money = ? where id = ?&quot;, 10000000 , 6);</span><br><span class="line">	</span><br><span class="line">查询</span><br><span class="line">1.直接new接口的匿名实现类</span><br><span class="line">	QueryRunner queryRunner = new QueryRunner(new ComboPooledDataSource());</span><br><span class="line">	</span><br><span class="line">	Account  account =  queryRunner.query(&quot;select * from account where id = ?&quot;, new ResultSetHandler&lt;Account&gt;()&#123;</span><br><span class="line"></span><br><span class="line">		@Override</span><br><span class="line">		public Account handle(ResultSet rs) throws SQLException &#123;</span><br><span class="line">			Account account  =  new Account();</span><br><span class="line">			while(rs.next())&#123;</span><br><span class="line">				String name = rs.getString(&quot;name&quot;);</span><br><span class="line">				int money = rs.getInt(&quot;money&quot;);</span><br><span class="line">				</span><br><span class="line">				account.setName(name);</span><br><span class="line">				account.setMoney(money);</span><br><span class="line">			&#125;</span><br><span class="line">			return account;</span><br><span class="line">		&#125;</span><br><span class="line">		 </span><br><span class="line">	 &#125;, 6);</span><br><span class="line">	</span><br><span class="line">	System.out.println(account.toString());</span><br><span class="line">	</span><br><span class="line">2.直接使用框架已经写好的实现类。</span><br><span class="line"></span><br><span class="line">* 查询单个对象</span><br><span class="line">	QueryRunner queryRunner = new QueryRunner(new ComboPooledDataSource());</span><br><span class="line">	//查询单个对象</span><br><span class="line">	Account account = queryRunner.query(&quot;select * from account where id = ?&quot;, </span><br><span class="line">			new BeanHandler&lt;Account&gt;(Account.class), 8);</span><br><span class="line"></span><br><span class="line">* 查询多个对象</span><br><span class="line">	QueryRunner queryRunner = new QueryRunner(new ComboPooledDataSource());</span><br><span class="line">	List&lt;Account&gt; list = queryRunner.query(&quot;select * from account &quot;,</span><br><span class="line">			new BeanListHandler&lt;Account&gt;(Account.class));</span><br></pre></td></tr></table></figure>
<p><strong>ResultSetHandler 常用的实现类</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">以下两个是使用频率最高的</span><br><span class="line">BeanHandler,  查询到的单个数据封装成一个对象</span><br><span class="line">BeanListHandler, 查询到的多个数据封装 成一个List&lt;对象&gt;</span><br><span class="line"></span><br><span class="line">ArrayHandler,  查询到的单个数据封装成一个数组</span><br><span class="line">ArrayListHandler,  查询到的多个数据封装成一个集合 ，集合里面的元素是数组。</span><br><span class="line"></span><br><span class="line">MapHandler,  查询到的单个数据封装成一个map</span><br><span class="line">MapListHandler,查询到的多个数据封装成一个集合 ，集合里面的元素是map。 </span><br><span class="line"></span><br><span class="line">ColumnListHandler</span><br><span class="line">KeyedHandler</span><br><span class="line">ScalarHandler</span><br></pre></td></tr></table></figure>
<p><strong>总结</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">事务</span><br><span class="line"></span><br><span class="line">使用命令行演示</span><br><span class="line">使用代码演示</span><br><span class="line">脏读、</span><br><span class="line">不可重复读、</span><br><span class="line">幻读</span><br><span class="line">丢失更新</span><br><span class="line"></span><br><span class="line">悲观锁</span><br><span class="line">乐观锁</span><br><span class="line"><span class="number">4</span>个隔离级别</span><br><span class="line">	读未提交</span><br><span class="line">	读已提交</span><br><span class="line">	可重复读</span><br><span class="line">	可串行化</span><br><span class="line">	</span><br><span class="line">数据连接池</span><br><span class="line">- DBCP</span><br><span class="line">  不使用配置</span><br><span class="line">  使用配置</span><br><span class="line"></span><br><span class="line">- C3P0</span><br><span class="line">  不使用配置</span><br><span class="line">  使用配置 （必须掌握）</span><br><span class="line"></span><br><span class="line">- 自定义连接池 </span><br><span class="line">  装饰者模式</span><br><span class="line">  </span><br><span class="line">  DBUtils</span><br><span class="line">&gt; 简化了我们的CRUD ， 里面定义了通用的CRUD方法。 </span><br><span class="line">queryRunner.update();</span><br><span class="line">queryRunner.query</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="MVC设计模式"><a href="#MVC设计模式" class="headerlink" title="MVC设计模式"></a>MVC设计模式</h1><p><strong>元数据</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Meata data </span><br><span class="line">描述数据的数据 String sql , 描述这份sql字符串的数据叫做元数据</span><br><span class="line">数据库元数据  DatabaseMetaData</span><br><span class="line">参数元数据  ParameterMetaData</span><br><span class="line">结果集元数据  ResultSetMetaData</span><br></pre></td></tr></table></figure>
<p><strong>JSP的开发模式</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img32.png" alt="img32"></p>
<p><strong>三层架构&amp;MVC练习</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img33.png" alt="img33"></p>
<p><strong>学生信息管理系统–数据库准备–查询</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE stus;</span><br><span class="line">USE stus;</span><br><span class="line">CREATE TABLE stu (</span><br><span class="line">	sid INT PRIMARY KEY  AUTO_INCREMENT,</span><br><span class="line">	sname VARCHAR (20),</span><br><span class="line">	gender VARCHAR (5),</span><br><span class="line">	phone VARCHAR (20),</span><br><span class="line">	birthday DATE,</span><br><span class="line">	hobby VARCHAR(50),</span><br><span class="line">	info VARCHAR(200)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">查询</span><br><span class="line">1. 先写一个JSP 页面， 里面放一个超链接 。 </span><br><span class="line">   &lt;a href=&quot;StudentListServlet&quot;&gt; 学生列表显示&lt;/a&gt;</span><br><span class="line">2. 写Servlet， 接收请求， 去调用 Service  , 由service去调用dao</span><br><span class="line">3. 先写Dao , 做Dao实现。</span><br><span class="line">public interface StudentDao &#123;</span><br><span class="line">/**</span><br><span class="line">- 查询所有学生</span><br><span class="line">  - @return  List&lt;Student&gt;</span><br><span class="line">    */</span><br><span class="line">      List&lt;Student&gt; findAll()  throws SQLException ;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      public class StudentDaoImpl implements StudentDao &#123;</span><br><span class="line">      		/**</span><br><span class="line">			 * 查询所有学生</span><br><span class="line">			 * @throws SQLException </span><br><span class="line">			 */</span><br><span class="line">			@Override</span><br><span class="line">			public List&lt;Student&gt; findAll() throws SQLException &#123;</span><br><span class="line">				QueryRunner runner = new QueryRunner(JDBCUtil02.getDataSource());</span><br><span class="line">				return runner.query(&quot;select * from stu&quot;, new BeanListHandler&lt;Student&gt;(Student.class));</span><br><span class="line">				&#125;</span><br><span class="line">	&#125;</span><br><span class="line">4.再Service , 做Service的实现。</span><br><span class="line">/**</span><br><span class="line">	 * 这是学生的业务处理规范</span><br><span class="line">	 * @author xiaomi</span><br><span class="line">	 *</span><br><span class="line">	 */</span><br><span class="line">	public interface StudentService &#123;</span><br><span class="line">	</span><br><span class="line">		/**</span><br><span class="line">		 * 查询所有学生</span><br><span class="line">		 * @return  List&lt;Student&gt;</span><br><span class="line">		 */</span><br><span class="line">		List&lt;Student&gt; findAll()  throws SQLException ;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	------------------------------------------</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 这是学生业务实现</span><br><span class="line">	 * @author xiaomi</span><br><span class="line">	 *</span><br><span class="line">	 */</span><br><span class="line">	public class StudentServiceImpl implements StudentService&#123;</span><br><span class="line">	</span><br><span class="line">		@Override</span><br><span class="line">		public List&lt;Student&gt; findAll() throws SQLException &#123;</span><br><span class="line">			StudentDao dao = new StudentDaoImpl();</span><br><span class="line">			return dao.findAll();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">5.在servlet 存储数据，并且做出页面响应。</span><br><span class="line">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			//1. 查询出来所有的学生</span><br><span class="line">			StudentService service = new StudentServiceImpl();</span><br><span class="line">			List&lt;Student&gt; list = service.findAll();</span><br><span class="line">			//2. 先把数据存储到作用域中</span><br><span class="line">		request.setAttribute(&quot;list&quot;, list);</span><br><span class="line">		//3. 跳转页面</span><br><span class="line">		request.getRequestDispatcher(&quot;list.jsp&quot;).forward(request, response);</span><br><span class="line">		</span><br><span class="line">	&#125; catch (SQLException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line">在list.jsp上显示数据</span><br><span class="line">EL + JSTL  + 表格</span><br></pre></td></tr></table></figure>
<p><strong>增加 </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1. 先跳转到增加的页面 ， 编写增加的页面</span><br><span class="line"></span><br><span class="line">2. 点击添加，提交数据到AddServlet . 处理数据。</span><br><span class="line"></span><br><span class="line">3. 调用service</span><br><span class="line"></span><br><span class="line">4. 调用dao, 完成数据持久化。</span><br><span class="line"></span><br><span class="line">5. 完成了这些存储工作后，需要跳转到列表页面。 这里不能直接跳转到列表页面，否则没有什么内容显示。 应该先跳转到查询所有学生信息的那个Servlet， 由那个Servlet再去跳转到列表页面。</span><br><span class="line"></span><br><span class="line">6. 爱好的value 值有多个。 </span><br><span class="line"></span><br><span class="line">   request.getParameter(&quot;hobby&quot;);</span><br><span class="line">   String[] hobby = 	request.getParameterValues(&quot;hobby&quot;) ---&gt; String[] </span><br><span class="line">   String value = Arrays.toString(hobby): // [爱好， 篮球， 足球]</span><br></pre></td></tr></table></figure>
<p><strong>删除</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1.点击超链接，弹出一个询问是否删除的对话框，如果点击了确定，那么就真的删除。</span><br><span class="line">&lt;a href=&quot;#&quot; onclick=&quot;doDelete($&#123;stu.sid&#125;)&quot;&gt;删除&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">2.让超链接，执行一个js方法</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">function doDelete(sid) &#123;</span><br><span class="line">		/* 如果这里弹出的对话框，用户点击的是确定，就马上去请求Servlet。 </span><br><span class="line">		如何知道用户点击的是确定。</span><br><span class="line">		如何在js的方法中请求servlet。 */</span><br><span class="line">		var flag = confirm(&quot;是否确定删除?&quot;);</span><br><span class="line">		if(flag)&#123;</span><br><span class="line">			//表明点了确定。 访问servlet。 在当前标签页上打开 超链接，</span><br><span class="line">			//window.location.href=&quot;DeleteServlet?sid=&quot;+sid;</span><br><span class="line">			location.href=&quot;DeleteServlet?sid=&quot;+sid;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">3.在js访问里面判断点击的选项，然后跳转到servlet。</span><br><span class="line">4.servlet收到了请求，然后去调用service ， service去调用dao</span><br></pre></td></tr></table></figure>
<p><strong>更新</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">1. 点击列表上的更新， 先跳转到一个EditServlet </span><br><span class="line"></span><br><span class="line">&gt; 在这个Servlet里面，先根据ID 去查询这个学生的所有信息出来。</span><br><span class="line"></span><br><span class="line">2. 跳转到更新的页面。 ，然后在页面上显示数据</span><br><span class="line">	 &lt;tr&gt;</span><br><span class="line">		&lt;td&gt;姓名&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;sname&quot; value=&quot;$&#123;stu.sname &#125;&quot;&gt;&lt;/td&gt;</span><br><span class="line">	  &lt;/tr&gt;</span><br><span class="line">	  	   &lt;tr&gt;</span><br><span class="line">		&lt;td&gt;性别&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;</span><br><span class="line">			&lt;!-- 如果性别是男的，  可以在男的性别 input标签里面， 出现checked ,</span><br><span class="line">			如果性别是男的，  可以在女的性别 input标签里面，出现checked --&gt;</span><br><span class="line">			&lt;input type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;男&quot; &lt;c:if test=&quot;$&#123;stu.gender == &apos;男&apos;&#125;&quot;&gt;checked&lt;/c:if&gt;&gt;男</span><br><span class="line">			&lt;input type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;女&quot; &lt;c:if test=&quot;$&#123;stu.gender == &apos;女&apos;&#125;&quot;&gt;checked&lt;/c:if&gt;&gt;女</span><br><span class="line">		&lt;/td&gt;</span><br><span class="line">	  &lt;/tr&gt;</span><br><span class="line">	   &lt;tr&gt;</span><br><span class="line">		&lt;td&gt;爱好&lt;/td&gt;</span><br><span class="line">				&lt;td&gt;</span><br><span class="line">			&lt;!-- 爱好： 篮球 ， 足球 ， 看书 </span><br><span class="line">			因为爱好有很多个，  里面存在包含的关系 --&gt;</span><br><span class="line">			&lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;游泳&quot; &lt;c:if test=&quot;$&#123;fn:contains(stu.hobby,&apos;游泳&apos;) &#125;&quot;&gt;checked&lt;/c:if&gt;&gt;游泳</span><br><span class="line">			&lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;篮球&quot; &lt;c:if test=&quot;$&#123;fn:contains(stu.hobby,&apos;篮球&apos;) &#125;&quot;&gt;checked&lt;/c:if&gt;&gt;篮球</span><br><span class="line">			&lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;足球&quot; &lt;c:if test=&quot;$&#123;fn:contains(stu.hobby,&apos;足球&apos;) &#125;&quot;&gt;checked&lt;/c:if&gt;&gt;足球</span><br><span class="line">			&lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;看书&quot; &lt;c:if test=&quot;$&#123;fn:contains(stu.hobby,&apos;看书&apos;) &#125;&quot;&gt;checked&lt;/c:if&gt;&gt;看书</span><br><span class="line">			&lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;写字&quot; &lt;c:if test=&quot;$&#123;fn:contains(stu.hobby,&apos;写字&apos;) &#125;&quot;&gt;checked&lt;/c:if&gt;&gt;写字</span><br><span class="line">		</span><br><span class="line">		&lt;/td&gt;</span><br><span class="line">	  &lt;/tr&gt;</span><br><span class="line">	  </span><br><span class="line">3.修改完毕后，提交数据到UpdateServlet</span><br><span class="line">提交上来的数据是没有带id的，所以我们要手动创建一个隐藏的输入框， 在这里面给定id的值， 以便提交表单，带上id。</span><br><span class="line">	&lt;form method=&quot;post&quot; action=&quot;UpdateServlet&quot;&gt;</span><br><span class="line">		&lt;input type=&quot;hidden&quot; name=&quot;sid&quot; value=&quot;$&#123;stu.sid &#125;&quot;&gt;</span><br><span class="line">	</span><br><span class="line">		...</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">	</span><br><span class="line">4.获取数据，调用service， 调用dao.</span><br></pre></td></tr></table></figure>
<p><strong>分页功能</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- 物理分页 （真分页）</span><br><span class="line"></span><br><span class="line">&gt; 来数据库查询的时候，只查一页的数据就返回了。  </span><br><span class="line"> 	优点 内存中的数据量不会太大</span><br><span class="line">	缺点：对数据库的访问频繁了一点。</span><br><span class="line">	SELECT * FROM stu LIMIT	5 OFFSET 2 </span><br><span class="line">	</span><br><span class="line">- 逻辑分页 （假分页）</span><br><span class="line">&gt; 一口气把所有的数据全部查询出来，然后放置在内存中。 </span><br><span class="line">优点： 访问速度快。</span><br><span class="line">缺点： 数据库量过大，内存溢出。</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Ajax-amp-Jquery"><a href="#Ajax-amp-Jquery" class="headerlink" title="Ajax &amp; Jquery"></a>Ajax &amp; Jquery</h1><p><strong>Ajax</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- 是什么?</span><br><span class="line">&gt; “Asynchronous Javascript And XML”（异步JavaScript和XML），</span><br><span class="line">&gt; 并不是新的技术，只是把原有的技术，整合到一起而已。 </span><br><span class="line">	   1.使用CSS和XHTML来表示。</span><br><span class="line">	   2. 使用DOM模型来交互和动态显示。</span><br><span class="line">	   3.使用XMLHttpRequest来和服务器进行异步通信。</span><br><span class="line">	   4.使用javascript来绑定和调用。</span><br><span class="line">	   </span><br><span class="line">- 有什么用?</span><br><span class="line">&gt; 咱们的网页如果想要刷新局部内容。 那么需要重新载入整个网页。用户体验不是很好。  就是为了解决局部刷新的问题。 保持其他部分不动，只刷新某些地方。</span><br></pre></td></tr></table></figure>
<p><strong>数据请求 Get</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">1.创建对象</span><br><span class="line"></span><br><span class="line">		function  ajaxFunction()&#123;</span><br><span class="line">		   var xmlHttp;</span><br><span class="line">		   try&#123; // Firefox, Opera 8.0+, Safari</span><br><span class="line">		        xmlHttp=new XMLHttpRequest();</span><br><span class="line">		    &#125;</span><br><span class="line">		    catch (e)&#123;</span><br><span class="line">			   try&#123;// Internet Explorer</span><br><span class="line">			         xmlHttp=new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);</span><br><span class="line">			      &#125;</span><br><span class="line">			    catch (e)&#123;</span><br><span class="line">			      try&#123;</span><br><span class="line">			         xmlHttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</span><br><span class="line">			      &#125;</span><br><span class="line">			      catch (e)&#123;&#125;</span><br><span class="line">			      &#125;</span><br><span class="line">		    &#125;</span><br><span class="line">	</span><br><span class="line">			return xmlHttp;</span><br><span class="line">		 &#125;</span><br><span class="line">		 </span><br><span class="line">2. 发送请求</span><br><span class="line">	//执行get请求</span><br><span class="line">function get() &#123;</span><br><span class="line">	</span><br><span class="line">	//1. 创建xmlhttprequest 对象</span><br><span class="line">	var request = ajaxFunction();</span><br><span class="line">	</span><br><span class="line">	//2. 发送请求。</span><br><span class="line">	// http://localhost:8080/day16/demo01.jsp</span><br><span class="line">	//http://localhost:8080/day16/DemoServlet01</span><br><span class="line">	</span><br><span class="line">	/*	</span><br><span class="line">		参数一： 请求类型  GET or  POST</span><br><span class="line">		参数二： 请求的路径</span><br><span class="line">		参数三： 是否异步， true  or false</span><br><span class="line">	*/</span><br><span class="line">	request.open(&quot;GET&quot; ,&quot;/day16/DemoServlet01&quot; ,true );</span><br><span class="line">	request.send();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">如果发送请求的同时，还想获取数据，那么代码如下</span><br><span class="line"></span><br><span class="line">//执行get请求</span><br><span class="line">function get() &#123;</span><br><span class="line">	</span><br><span class="line">	//1. 创建xmlhttprequest 对象</span><br><span class="line">	var request = ajaxFunction();</span><br><span class="line">	</span><br><span class="line">	//2. 发送请求</span><br><span class="line">	request.open(&quot;GET&quot; ,&quot;/day16/DemoServlet01?name=aa&amp;age=18&quot; ,true );</span><br><span class="line">	</span><br><span class="line">	//3. 获取响应数据 注册监听的意思。  一会准备的状态发生了改变，那么就执行 = 号右边的方法</span><br><span class="line">	request.onreadystatechange = function()&#123;</span><br><span class="line">		</span><br><span class="line">		//前半段表示 已经能够正常处理。  再判断状态码是否是200</span><br><span class="line">		if(request.readyState == 4 &amp;&amp; request.status == 200)&#123;</span><br><span class="line">			//弹出响应的信息</span><br><span class="line">			alert(request.responseText);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	request.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>数据请求 Post</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line"></span><br><span class="line">//1. 创建对象</span><br><span class="line">function  ajaxFunction()&#123;</span><br><span class="line">   var xmlHttp;</span><br><span class="line">   try&#123; // Firefox, Opera 8.0+, Safari</span><br><span class="line">        xmlHttp=new XMLHttpRequest();</span><br><span class="line">    &#125;</span><br><span class="line">    catch (e)&#123;</span><br><span class="line">	   try&#123;// Internet Explorer</span><br><span class="line">	         xmlHttp=new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);</span><br><span class="line">	      &#125;</span><br><span class="line">	    catch (e)&#123;</span><br><span class="line">	      try&#123;</span><br><span class="line">	         xmlHttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</span><br><span class="line">	      &#125;</span><br><span class="line">	      catch (e)&#123;&#125;</span><br><span class="line">	      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	return xmlHttp;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">function post() &#123;</span><br><span class="line">	//1. 创建对象</span><br><span class="line">	var request = ajaxFunction();</span><br><span class="line">	</span><br><span class="line">	//2. 发送请求</span><br><span class="line">	request.open( &quot;POST&quot;, &quot;/day16/DemoServlet01&quot;, true );</span><br><span class="line"></span><br><span class="line">	//如果不带数据，写这行就可以了</span><br><span class="line">	//request.send();</span><br><span class="line">	</span><br><span class="line">	//如果想带数据，就写下面的两行</span><br><span class="line">	</span><br><span class="line">	//如果使用的是post方式带数据，那么 这里要添加头， 说明提交的数据类型是一个经过url编码的form表单数据</span><br><span class="line">	request.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);</span><br><span class="line">	</span><br><span class="line">	//带数据过去  ， 在send方法里面写表单数据。 </span><br><span class="line">	request.send(&quot;name=aobama&amp;age=19&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">需要获取数据</span><br><span class="line">function post() &#123;</span><br><span class="line">		//1. 创建对象</span><br><span class="line">		var request = ajaxFunction();</span><br><span class="line">		</span><br><span class="line">		//2. 发送请求</span><br><span class="line">		request.open( &quot;POST&quot;, &quot;/day16/DemoServlet01&quot;, true );</span><br><span class="line">		</span><br><span class="line">		//想获取服务器传送过来的数据， 加一个状态的监听。 </span><br><span class="line">		request.onreadystatechange=function()&#123;</span><br><span class="line">			if(request.readyState==4 &amp;&amp; request.status == 200)&#123;</span><br><span class="line">				</span><br><span class="line">				alert(&quot;post：&quot;+request.responseText);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		//如果使用的是post方式带数据，那么 这里要添加头， 说明提交的数据类型是一个经过url编码的form表单数据</span><br><span class="line">		request.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);</span><br><span class="line">		</span><br><span class="line">		//带数据过去  ， 在send方法里面写表单数据。 </span><br><span class="line">		request.send(&quot;name=aobama&amp;age=19&quot;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>校验用户名是否可用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">1. 搭建环境</span><br><span class="line">页面准备</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;table border=&quot;1&quot; width=&quot;500&quot;&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;用户名:&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;name&quot;  onblur=&quot;checkUserName()&quot;&gt;&lt;span id=&quot;span01&quot;&gt;&lt;/span&gt;&lt;/td&gt; </span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;密码&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;&quot;&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;邮箱&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;&quot;&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;简介&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;&quot;&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td colspan=&quot;2&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;注册&quot;&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">	&lt;/table&gt;</span><br><span class="line">   &lt;/body&gt;</span><br><span class="line">   </span><br><span class="line">   2.数据库准备</span><br><span class="line">   Servlet代码</span><br><span class="line">   protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">	try &#123;</span><br><span class="line">		</span><br><span class="line">		request.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">		</span><br><span class="line">		//1. 检测是否存在</span><br><span class="line">		String name = request.getParameter(&quot;name&quot;);</span><br><span class="line">		System.out.println(&quot;name=&quot;+name);</span><br><span class="line">		</span><br><span class="line">		UserDao dao = new UserDaomImpl();</span><br><span class="line">		boolean isExist = dao.checkUserName(name);</span><br><span class="line">		</span><br><span class="line">		//2.  通知页面，到底有还是没有。</span><br><span class="line">		if(isExist)&#123;</span><br><span class="line">			response.getWriter().println(1);  //存在用户名</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			response.getWriter().println(2); //不存在该用户名</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125; catch (SQLException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">3. Dao代码</span><br><span class="line">public class UserDaomImpl implements UserDao&#123;</span><br><span class="line"></span><br><span class="line">		@Override</span><br><span class="line">		public boolean checkUserName(String username) throws SQLException &#123;</span><br><span class="line">			QueryRunner runner = new QueryRunner(JDBCUtil02.getDataSource());</span><br><span class="line">			</span><br><span class="line">			String sql = &quot;select count(*) from t_user where username =?&quot;;</span><br><span class="line">			</span><br><span class="line">			runner.query(sql, new  ScalarHandler(), username);</span><br><span class="line"></span><br><span class="line">			Long result = (Long) runner.query(sql, new  ScalarHandler(), username); </span><br><span class="line">			return result &gt; 0 ;</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>jsp页面显示</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">function checkUserName() &#123;</span><br><span class="line">//获取输入框的值 document 整个网页</span><br><span class="line">	var name = document.getElementById(&quot;name&quot;).value; // value  value() val val()</span><br><span class="line">	//1. 创建对象</span><br><span class="line">	var request = ajaxFunction();</span><br><span class="line">	</span><br><span class="line">	//2. 发送请求</span><br><span class="line">	request.open(&quot;POST&quot;  ,&quot;/day16/CheckUserNameServlet&quot; , true );</span><br><span class="line">	</span><br><span class="line">	//注册状态改变监听，获取服务器传送过来的数据</span><br><span class="line">	request.onreadystatechange = function()&#123;</span><br><span class="line">		</span><br><span class="line">		if(request.readyState == 4 &amp;&amp; request.status == 200)&#123;</span><br><span class="line">			//alert(request.responseText);</span><br><span class="line">			var data = request.responseText;</span><br><span class="line">			if(data == 1)&#123;</span><br><span class="line">				//alert(&quot;用户名已存在&quot;);</span><br><span class="line">				document.getElementById(&quot;span01&quot;).innerHTML = &quot;&lt;font color=&apos;red&apos;&gt;用户名已存在!&lt;/font&gt;&quot;;</span><br><span class="line">			&#125;else&#123;</span><br><span class="line">				document.getElementById(&quot;span01&quot;).innerHTML = &quot;&lt;font color=&apos;green&apos;&gt;用户名可用!&lt;/font&gt;&quot;;</span><br><span class="line">				//alert(&quot;用户名未存在&quot;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	request.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);</span><br><span class="line">	request.send(&quot;name=&quot;+name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>JQuery</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- 是什么?</span><br><span class="line">&gt; javascript 的代码框架。  </span><br><span class="line">- 有什么用?</span><br><span class="line">&gt; 简化代码，提高效率。  </span><br><span class="line">- 核心 </span><br><span class="line">&gt; write less do more , 写得更少，做的更多。</span><br></pre></td></tr></table></figure>
<p><strong>load</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;&quot; onclick=&quot;load()&quot;&gt;使用JQuery执行load方法&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">有两次刷新，  先走 onClick的方法，取到数据回来之后，赋值显示。 接着 走 href=&quot;&quot;的路径，但是这个属性没有给值，所以会把当前的页面重新再刷新一次。所以导致看不见值。</span><br><span class="line"></span><br><span class="line">//找到这个元素， 去执行加载的动作， 加载/day16/DemoServlet02 ， 得到的数据，赋值显示</span><br><span class="line">$(&quot;#aaa&quot;).load(&quot;/day16/DemoServlet02&quot; , function(responseText , statusTXT  , xhr) &#123;</span><br><span class="line">		//找到id为text01的元素， 设置它的value属性值为 responseText 对应的值</span><br><span class="line">		$(&quot;#aaa&quot;).val(responseText);</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>Get</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$.get(&quot;/day16/DemoServlet02&quot;  , function(data ,status) &#123;</span><br><span class="line">		$(&quot;#div01&quot;).text(data);</span><br><span class="line">	&#125;);</span><br><span class="line">赋值显示</span><br><span class="line">- val(&quot;aa&quot;); </span><br><span class="line">&gt; 只能放那些标签带有value属性</span><br><span class="line">- html(&quot;aa&quot;); ---写html代码</span><br><span class="line">- text(&quot;aa&quot;);</span><br><span class="line">&gt; 其实没有什么区别，如果想针对这分数据做html样式处理，那么只能用html()</span><br></pre></td></tr></table></figure>
<p><strong>load &amp; get</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">load</span><br><span class="line">$(&quot;#元素id&quot;).load(url地址);</span><br><span class="line">$(&quot;#div1&quot;).load(serlvet); ---&gt; 使用的get请求，回来赋值的时候， 使用text（）;去赋值</span><br><span class="line">get</span><br><span class="line">语法格式 ： $.get(URL,callback);	</span><br><span class="line">	使用案例： $.get(&quot;/day16/DemoServlet02&quot;  , function(data ,status) &#123;</span><br><span class="line">		$(&quot;#div01&quot;).text(data);</span><br><span class="line">	&#125;);</span><br><span class="line">post</span><br><span class="line">语法格式：$.post(URL,data,callback);</span><br><span class="line">	function post() &#123;</span><br><span class="line">		$.post(&quot;/day16/DemoServlet02&quot;, &#123;name:&quot;zhangsan&quot;,age:18&#125;,function(data,status) &#123;</span><br><span class="line">			//想要放数据到div里面去。 --- 找到div</span><br><span class="line">			$(&quot;#div01&quot;).html(data);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>使用JQuery去实现校验用户名</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function checkUserName() &#123;</span><br><span class="line">	//1. 获取输入框的内容</span><br><span class="line">	var name = $(&quot;#name&quot;).val();</span><br><span class="line">	</span><br><span class="line">	//2. 发送请求</span><br><span class="line">	$.post(&quot;/day16/CheckUserNameServlet&quot; , &#123;name:name&#125; , function(data , status)&#123;</span><br><span class="line">		//alert(data);</span><br><span class="line">		if(data == 1)&#123;//用户名存在</span><br><span class="line">			//alert(&quot;用户名存在&quot;);</span><br><span class="line">			$(&quot;#span01&quot;).html(&quot;&lt;font color=&apos;red&apos;&gt;用户名已被注册&lt;/font&gt;&quot;);</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			//alert(&quot;用户名可用&quot;);</span><br><span class="line">			$(&quot;#span01&quot;).html(&quot;&lt;font color=&apos;green&apos;&gt;用户名可以使用&lt;/font&gt;&quot;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; );</span><br><span class="line">	//3. 输出响应的数据到页面上。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>实现百度搜索提示</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">搭建环境</span><br><span class="line">1.定义首页</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;center&gt;</span><br><span class="line">	&lt;h2&gt;黑马&lt;/h2&gt;</span><br><span class="line">		&lt;input type=&quot;text&quot; name=&quot;word&quot; id=&quot;word&quot; style=&quot;width: 600px ; height: 50px  ;font-size: 20px;&quot;&gt;</span><br><span class="line">		&lt;input type=&quot;button&quot; value=&quot;黑马一下&quot;  style=&quot;height: 55px ; width: 100px ; &quot;&gt;</span><br><span class="line">		&lt;div id=&quot;div01&quot; style=&quot;position:relative; left : -54px; width: 600px; height: 200px ; border:  1px solid blue; display: none&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">2.定义数据库</span><br><span class="line">###捕获键盘弹起</span><br><span class="line"></span><br><span class="line">$(function()&#123;</span><br><span class="line">	$(&quot;#word&quot;).keyup(function() &#123;</span><br><span class="line">		alert(&quot;键盘弹起了..&quot;);</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">###JS请求</span><br><span class="line">$(function()&#123;</span><br><span class="line">	$(&quot;#word&quot;).keyup(function() &#123;</span><br><span class="line">		//2。 获取输入框的值 </span><br><span class="line">		//var word = $(&quot;#word&quot;).val();</span><br><span class="line">		//this  对应就是执行这个方法的那个对象， $(&quot;#word&quot;)</span><br><span class="line">		var word = $(this).val();</span><br><span class="line"></span><br><span class="line">		if(word == &quot;&quot;)&#123;</span><br><span class="line">			$(&quot;#div01&quot;).hide();</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			//3. 请求数据。</span><br><span class="line">			$.post(&quot;find&quot;,&#123;word:word&#125; ,function(data , status)&#123;</span><br><span class="line">				//alert(data);</span><br><span class="line">				$(&quot;#div01&quot;).show();</span><br><span class="line">				$(&quot;#div01&quot;).html(data);</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>Servlet代码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">		request.setCharacterEncoding(&quot;utf-8&quot;);</span><br><span class="line">		try &#123;</span><br><span class="line">			//1. 先获取参数</span><br><span class="line">			String word = request.getParameter(&quot;word&quot;);</span><br><span class="line">			System.out.println(&quot;word=&quot;+word);</span><br><span class="line">			</span><br><span class="line">			//2. 让dao执行查询</span><br><span class="line">			WordsDao dao = new WordsDaoImpl();</span><br><span class="line">			List&lt;WordBean&gt; list = dao.findWords(word);</span><br><span class="line">			</span><br><span class="line">			for (WordBean wordBean : list) &#123;</span><br><span class="line">				System.out.println(&quot;===&quot;+wordBean.toString());</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			request.setAttribute(&quot;list&quot;, list);</span><br><span class="line">			</span><br><span class="line">			//3. 返回数据</span><br><span class="line">			response.setContentType(&quot;text/html;charset=utf-8&quot;);</span><br><span class="line">			//response.getWriter().write(&quot;数据是：&quot;);</span><br><span class="line">			request.getRequestDispatcher(&quot;list.jsp&quot;).forward(request, response);</span><br><span class="line">		&#125; catch (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>list.jsp</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">	    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">	 &lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot;  prefix=&quot;c&quot;%&gt;</span><br><span class="line">	 </span><br><span class="line">		&lt;table style=&quot;width: 100%&quot;&gt;</span><br><span class="line">			&lt;c:forEach items=&quot;$&#123;list &#125;&quot; var=&quot;wordBean&quot;&gt;</span><br><span class="line">				&lt;tr&gt;</span><br><span class="line">					&lt;td&gt;$&#123;wordBean.words&#125;&lt;/td&gt;</span><br><span class="line">				&lt;/tr&gt;</span><br><span class="line">			&lt;/c:forEach&gt;</span><br><span class="line">		&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<p><strong>使用JQuery实现 省市联动</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">环境准备</span><br><span class="line">1. 准备数据库</span><br><span class="line"></span><br><span class="line">2 。 准备页面</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;js/jquery-1.11.3.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">		&lt;script type=&quot;text/javascript&quot; src=&quot;js/city.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">		&lt;/head&gt;</span><br><span class="line">		&lt;body&gt;</span><br><span class="line">		省份: &lt;select name=&quot;province&quot; id =&quot;province&quot;&gt;</span><br><span class="line">				&lt;option value=&quot;&quot; &gt;-请选择 -</span><br><span class="line">				&lt;option value=&quot;1&quot; &gt;广东</span><br><span class="line">				&lt;option value=&quot;2&quot; &gt;湖南</span><br><span class="line">				&lt;option value=&quot;3&quot; &gt;湖北</span><br><span class="line">				&lt;option value=&quot;4&quot; &gt;四川</span><br><span class="line">			&lt;/select&gt;</span><br><span class="line">		城市: </span><br><span class="line">			&lt;select name=&quot;city&quot; id=&quot;city&quot;&gt;</span><br><span class="line">				&lt;option value=&quot;&quot; &gt;-请选择 -</span><br><span class="line">			&lt;/select&gt;</span><br><span class="line">		&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p><strong>XStream的使用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//3. 返回数据。手动拼  ---&gt; XStream  转化 bean对象成 xml</span><br><span class="line">		XStream xStream = new XStream();</span><br><span class="line">		</span><br><span class="line">		//想把id做成属性</span><br><span class="line">		xStream.useAttributeFor(CityBean.class, &quot;id&quot;);</span><br><span class="line">		</span><br><span class="line">		//设置别名</span><br><span class="line">		xStream.alias(&quot;city&quot;, CityBean.class);</span><br><span class="line">		</span><br><span class="line">		//转化一个对象成xml字符串</span><br><span class="line">		String xml = xStream.toXML(list);</span><br></pre></td></tr></table></figure>
<p><strong>JS代码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">$(function() &#123;</span><br><span class="line">	//1。找到省份的元素</span><br><span class="line">	$(&quot;#province&quot;).change(function() &#123;</span><br><span class="line">		//2. 一旦里面的值发生了改变，那么就去请求该省份的城市数据</span><br><span class="line">		//$(&quot;#province&quot;).varl();</span><br><span class="line">		var pid = $(this).val();</span><br><span class="line">		</span><br><span class="line">		/*&lt;list&gt;</span><br><span class="line">			&lt;city&gt;</span><br><span class="line">				&lt;id&gt;1&lt;id&gt;</span><br><span class="line">				&lt;pid&gt;1&lt;/pid&gt;</span><br><span class="line">				&lt;cname&gt;深圳&lt;/cname&gt;</span><br><span class="line">			&lt;/city&gt;</span><br><span class="line">			&lt;city &gt;</span><br><span class="line">				&lt;id&gt;2&lt;id&gt;</span><br><span class="line">				&lt;pid&gt;1&lt;/pid&gt;</span><br><span class="line">				&lt;cname&gt;东莞&lt;/cname&gt;</span><br><span class="line">			&lt;/city&gt;</span><br><span class="line">		&lt;/list&gt;*/</span><br><span class="line">		</span><br><span class="line">		$.post( &quot;CityServlet&quot;,&#123;pid:pid&#125; ,function(data,status)&#123;</span><br><span class="line">			//alert(&quot;回来数据了:&quot;+data);</span><br><span class="line">			</span><br><span class="line">			//先清空以前的值：</span><br><span class="line">			$(&quot;#city&quot;).html(&quot;&lt;option value=&apos;&apos; &gt;-请选择-&quot;)</span><br><span class="line">			//遍历： </span><br><span class="line">			//从data数据里面找出所有的city  ， 然后遍历所有的city。</span><br><span class="line">			//遍历一个city，就执行一次function方法</span><br><span class="line">			$(data).find(&quot;city&quot;).each(function() &#123;</span><br><span class="line">				</span><br><span class="line">				//遍历出来的每一个city，取它的孩子。 id , cname</span><br><span class="line">				var id = $(this).children(&quot;id&quot;).text();</span><br><span class="line">				var cname = $(this).children(&quot;cname&quot;).text();</span><br><span class="line">				</span><br><span class="line">				$(&quot;#city&quot;).append(&quot;&lt;option value=&apos;&quot;+id+&quot;&apos; &gt;&quot;+cname)</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125; );</span><br><span class="line">		</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>服务器和客户端数据传输的方式</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">xml</span><br><span class="line"></span><br><span class="line">&lt;list&gt;</span><br><span class="line">			&lt;city&gt;</span><br><span class="line">				&lt;id&gt;1&lt;id&gt;</span><br><span class="line">				&lt;pid&gt;1&lt;/pid&gt;</span><br><span class="line">				&lt;cname&gt;深圳&lt;/cname&gt;</span><br><span class="line">			&lt;/city&gt;</span><br><span class="line">			&lt;city &gt;</span><br><span class="line">				&lt;id&gt;2&lt;id&gt;</span><br><span class="line">				&lt;pid&gt;1&lt;/pid&gt;</span><br><span class="line">				&lt;cname&gt;东莞&lt;/cname&gt;</span><br><span class="line">			&lt;/city&gt;</span><br><span class="line">		&lt;/list&gt;</span><br><span class="line">		</span><br><span class="line">json</span><br><span class="line">阅读性更好 、 容量更小。</span><br><span class="line">&#123;&quot;name&quot;:&quot;aaa&quot; , &quot;age&quot;:19&#125;</span><br><span class="line">把javaBean  转化成 json数据</span><br><span class="line"></span><br><span class="line">	//3. 把list ---&gt; json数据</span><br><span class="line">		//JSONArray ---&gt; 变成数组 ， 集合  []</span><br><span class="line">		//JSONObject ---&gt; 变成简单的数据  &#123; name : zhangsan , age:18&#125;</span><br><span class="line">		</span><br><span class="line">		JSONArray jsonArray = JSONArray.fromObject(list);</span><br><span class="line">		String json = jsonArray.toString();</span><br></pre></td></tr></table></figure>
<p><strong>使用json格式数据显示省市联动效果</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">serlvet代码：</span><br><span class="line">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">	try &#123;</span><br><span class="line">		//1. 获取参数</span><br><span class="line">		int pid = Integer.parseInt(request.getParameter(&quot;pid&quot;));</span><br><span class="line">		</span><br><span class="line">		//2 找出所有的城市</span><br><span class="line">		CityDao dao = new CityDaoImpl();</span><br><span class="line">		List&lt;CityBean&gt; list = dao.findCity(pid);</span><br><span class="line">		</span><br><span class="line">		//3. 把list ---&gt; json数据</span><br><span class="line">		//JSONArray ---&gt; 变成数组 ， 集合  []</span><br><span class="line">		//JSONObject ---&gt; 变成简单的数据  &#123; name : zhangsan , age:18&#125;</span><br><span class="line">		</span><br><span class="line">		JSONArray jsonArray = JSONArray.fromObject(list);</span><br><span class="line">		String json = jsonArray.toString();</span><br><span class="line">		</span><br><span class="line">	response.setContentType(&quot;text/html;charset=utf-8&quot;);</span><br><span class="line">		response.getWriter().write(json);</span><br><span class="line">		</span><br><span class="line">			&#125; catch (SQLException e) &#123;</span><br><span class="line">		// TODO Auto-generated catch block</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line">js代码</span><br><span class="line">$(function() &#123;</span><br><span class="line">		//1。找到省份的元素</span><br><span class="line">		$(&quot;#province&quot;).change(function() &#123;</span><br><span class="line">			//2. 一旦里面的值发生了改变，那么就去请求该省份的城市数据</span><br><span class="line">			//$(&quot;#province&quot;).varl();</span><br><span class="line">			var pid = $(this).val();</span><br><span class="line">			</span><br><span class="line">			/*[</span><br><span class="line">			    &#123;</span><br><span class="line">			        &quot;cname&quot;: &quot;深圳&quot;,</span><br><span class="line">			        &quot;id&quot;: 1,</span><br><span class="line">			        &quot;pid&quot;: 1</span><br><span class="line">			    &#125;,</span><br><span class="line">			    &#123;</span><br><span class="line">			        &quot;cname&quot;: &quot;东莞&quot;,</span><br><span class="line">			        &quot;id&quot;: 2,</span><br><span class="line">			        &quot;pid&quot;: 1</span><br><span class="line">			    &#125;</span><br><span class="line">			    ...</span><br><span class="line">			]*/</span><br><span class="line">			</span><br><span class="line">			$.post( &quot;CityServlet02&quot;,&#123;pid:pid&#125; ,function(data,status)&#123;</span><br><span class="line">				</span><br><span class="line">				//先清空</span><br><span class="line">				$(&quot;#city&quot;).html(&quot;&lt;option value=&apos;&apos; &gt;-请选择-&quot;);</span><br><span class="line">				//再遍历，追加</span><br><span class="line">				$(data).each(function(index , c) &#123;</span><br><span class="line">					$(&quot;#city&quot;).append(&quot;&lt;option value=&apos;&quot;+c.id+&quot;&apos; &gt;&quot;+c.cname)</span><br><span class="line">				&#125;);</span><br><span class="line">			&#125;,&quot;json&quot; );</span><br><span class="line">			</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<p>##总结</p>
<p>###Ajax  </p>
<p>发送get请求</p>
<p>发送post请求</p>
<p>都要求带数据 + 获取数据＋　放置到元素上。</p>
<p>JQuery</p>
<p>发送get请求</p>
<p>发送post请求</p>
<p>都要求带数据 + 获取数据＋　放置到元素上。</p>
<hr>
<ol>
<li>服务器返回xml数据</li>
<li>服务器返回json数据</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/uploads/avatar.jpg" alt="Beny">
            
              <p class="site-author-name" itemprop="name">Beny</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">60</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">14</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">13</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="/1105397915" title="1105397915 &rarr; 1105397915"><i class="fa fa-fw fa-qq"></i>1105397915</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/benyzheng" title="GitHub &rarr; https://github.com/benyzheng" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="/zhengbeny@qq.com" title="zhengbeny@qq.com &rarr; zhengbeny@qq.com"><i class="fa fa-fw fa-envelope"></i>zhengbeny@qq.com</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Beny</span>

  

  
</div>








<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共125.3k字</span>
</div>
        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/libs/jquery/index.js?v=2.1.3"></script>

  
  <script src="/libs/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/libs/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.0"></script>



  

  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  
  

<script src="//cdn1.lncld.net/static/js/3.11.1/av-min.js"></script>



<script src="/js/src/Valine.min.js"></script>

<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: true,
    appId: 'oaY0uDqkCsuX94AxTtnV6scO-gzGzoHsz',
    appKey: 'HKU5SJPAd8KyYqk6Q8fdArL5',
    placeholder: '写了评论, offer还会远吗? ----记得填写邮箱哦~如果可以填写你的网站互相参考就更好啦',
    avatar: 'retro',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false,
    lang: '' || 'zh-cn'
  });
  //增加以下六行代码去除 power by valine
    var infoEle = document.querySelector('#comments .info');
    if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0){
      infoEle.childNodes.forEach(function(item) {
        item.parentNode.removeChild(item);
      });
    }
</script>





  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  

  

  

  

  

  

  

<!-- 页面点击小红心 -->
<!-- <script type="text/javascript" src="/js/src/click.js"></script>-->
</body>
</html>
