<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/libs/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/libs/pace/pace-theme-flash.min.css?v=1.0.2">


















  
  
  
  

  
    
    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Monda:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|Monda:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext">
  






<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_small.ico?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.0',
    sidebar: {"position":"left","display":"hide","offset":12,"onmobile":true,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="XMLXML的作用 1231.可以用来保存数据2.可以用来配置文件3.数据传输载体  定义xml 1234567文档声明	简单声明，version:解析这个xml使用什么版本的解析器解析		&amp;lt;?xml version=&amp;quot;1.0&amp;quot; ?&amp;gt;	encoding:解析xml文字使用什么编码来翻译，电脑上的文件在保存时是存储文字对应的二进制，这些文字对应	  的二进制使用编码解">
<meta name="keywords" content="JavaEE">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaWeb知识总结">
<meta property="og:url" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/index.html">
<meta property="og:site_name" content="Beny&#39;s blog">
<meta property="og:description" content="XMLXML的作用 1231.可以用来保存数据2.可以用来配置文件3.数据传输载体  定义xml 1234567文档声明	简单声明，version:解析这个xml使用什么版本的解析器解析		&amp;lt;?xml version=&amp;quot;1.0&amp;quot; ?&amp;gt;	encoding:解析xml文字使用什么编码来翻译，电脑上的文件在保存时是存储文字对应的二进制，这些文字对应	  的二进制使用编码解">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/Snipaste_2018-10-19_20-33-45.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/Snipaste_2018-10-19_20-37-53.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/parse_type.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/Snipaste_2018-10-19_20-49-08.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img04.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img05.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img06.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img01.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img02.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img03.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img07.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img08.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img09.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img10.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img11.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img12.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img13.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img14.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img15.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img16.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img17.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img18.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img19.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img20.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img21.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img22.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img23.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img24.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img25.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img26.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img27.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img28.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img29.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img30.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img31.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img32.png">
<meta property="og:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/img33.png">
<meta property="og:updated_time" content="2019-10-07T06:23:29.908Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JavaWeb知识总结">
<meta name="twitter:description" content="XMLXML的作用 1231.可以用来保存数据2.可以用来配置文件3.数据传输载体  定义xml 1234567文档声明	简单声明，version:解析这个xml使用什么版本的解析器解析		&amp;lt;?xml version=&amp;quot;1.0&amp;quot; ?&amp;gt;	encoding:解析xml文字使用什么编码来翻译，电脑上的文件在保存时是存储文字对应的二进制，这些文字对应	  的二进制使用编码解">
<meta name="twitter:image" content="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/Snipaste_2018-10-19_20-33-45.png">





  
  
  <link rel="canonical" href="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>JavaWeb知识总结 | Beny's blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Beny's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">Nothing worth having comes easy.</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">11</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">33</span></a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

<a href="https://github.com/bengzheng" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://benyzheng.github.io/2019/01/26/JavaWeb知识/JavaWeb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Beny">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Beny's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">JavaWeb知识总结

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

             
                
              

              <time title="创建时间：2019-01-26 00:00:00" itemprop="dateCreated datePublished" datetime="2019-01-26T00:00:00+08:00">2019-01-26 00:00:00</time>
            

            
              
            <!--  old version
              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
              <time title="修改时间：2019-10-07 14:23:29" itemprop="dateModified" datetime="2019-10-07T14:23:29+08:00">2019-10-07</time> 
              -->
              <!-- new version -->
                        
            <span class="post-updated">
                
                  <span class="post-meta-divider">|</span>
                  

                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-check-o"></i>
                  </span>
                  
                    <span class="post-meta-item-text">更新于</span>
                
              <time itemprop="dateUpdated" datetime="2019-10-07T14:23:29+08:00" content="2019-10-07">
                2019-10-07 14:23:29
              </time>
            </span>
          
            
          </span>


          
          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaEE/" itemprop="url" rel="index"><span itemprop="name">JavaEE</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/01/26/JavaWeb知识/JavaWeb/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/01/26/JavaWeb知识/JavaWeb/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             阅读次数： 
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h1><p><strong>XML的作用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.可以用来保存数据</span><br><span class="line">2.可以用来配置文件</span><br><span class="line">3.数据传输载体</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/Snipaste_2018-10-19_20-33-45.png" alt></p>
<p><strong>定义xml</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">文档声明</span><br><span class="line">	简单声明，version:解析这个xml使用什么版本的解析器解析</span><br><span class="line">		&lt;?xml version=&quot;1.0&quot; ?&gt;</span><br><span class="line">	encoding:解析xml文字使用什么编码来翻译，电脑上的文件在保存时是存储文字对应的二进制，这些文字对应	  的二进制使用编码解析得到</span><br><span class="line">		&lt;?xml version=&quot;1.0&quot; encoding=&quot;gbk(UTF-8)&quot;?&gt;</span><br><span class="line">	standalone:no---文档会依赖关联其他文档，yes---这是一个独立的文档</span><br><span class="line">		&lt;?xml version=&quot;1.0&quot; encoding=&quot;gbk(UTF-8)&quot; standalone=&quot;no&quot;?&gt;</span><br></pre></td></tr></table></figure>
<p><strong>元素定义</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.&lt;&gt;里面都是元素，成对出现，如：&lt;stu&gt;&lt;/stu&gt;</span><br><span class="line">2.文档声明第一个出现的元素是根元素</span><br><span class="line">3.空标签&lt;age/&gt;,开始也是结束，里面可以写属性</span><br><span class="line">4.标签可以自定义</span><br></pre></td></tr></table></figure>
<p><strong>注释</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- --&gt;与HTML注释一样</span><br></pre></td></tr></table></figure>
<p><strong>CDATA区</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/Snipaste_2018-10-19_20-37-53.png" alt></p>
<p><strong>XML解析方式</strong>(常用两种DOM&amp;SAX)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">获取元素里面的字符或者属性数据</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/parse_type.png" alt></p>
<p><strong>XML解析手段</strong>(DOM4J&amp;JDOM)</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/Snipaste_2018-10-19_20-49-08.png" alt></p>
<p><strong>DOM4J 基本用法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">element.element(&quot;stu&quot;);//返回该元素下的第一个stu元素</span><br><span class="line">element.elements();//返回该元素下的所有子元素</span><br><span class="line">1.创建SAXReader对象</span><br><span class="line">2.指定解析的xml</span><br><span class="line">3.获取根元素</span><br><span class="line">4.根据根元素获取子元素或者下面的子孙元素</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">package com.itheima.test;</span><br><span class="line"></span><br><span class="line">import java.util.*;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line"></span><br><span class="line">import org.dom4j.Document;</span><br><span class="line">import org.dom4j.Element;</span><br><span class="line">import org.dom4j.io.SAXReader;</span><br><span class="line"></span><br><span class="line">public class MainTest &#123;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			//1.创建sax读取对象</span><br><span class="line">			SAXReader reader = new SAXReader();//jdbc --classloader</span><br><span class="line">			//2.指定解析的xml源 </span><br><span class="line">			Document document = reader.read(new File(&quot;src/xml/stus.xml&quot;));</span><br><span class="line">			//3.得到元素</span><br><span class="line">			Element rootElement = document.getRootElement();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			//获取根元素下面的子元素</span><br><span class="line">			//System.out.println(rootElement.element(&quot;stu&quot;).element(&quot;age&quot;).getText()); </span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			List&lt;Element&gt; elements = rootElement.elements();</span><br><span class="line">			for(Element element : elements) &#123;</span><br><span class="line">				String name = element.element(&quot;name&quot;).getText();</span><br><span class="line">				String age = element.element(&quot;age&quot;).getText();</span><br><span class="line">				String address = element.element(&quot;address&quot;).getText();</span><br><span class="line">				System.out.println(&quot;name:&quot;+name+&quot;--&quot;+&quot;age:&quot;+age+&quot;--&quot;+&quot;address:&quot;+address);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Dom4J的Xpath使用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; dom4j里面支持Xpath的写法。xpath其实是xml的路径语言，支持我们在解析xml的时候定位到一个具体的元素。</span><br><span class="line">1.添加jar包依赖</span><br><span class="line">	jaxen-1.1-beta-6.jar</span><br><span class="line">2.在查找指定节点的时候，根据xpath语法规则来查找</span><br><span class="line">3.后续的代码与以前的解析代码一样</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">package com.itheima.test;</span><br><span class="line"></span><br><span class="line">import java.util.*;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line"></span><br><span class="line">import org.dom4j.Document;</span><br><span class="line">import org.dom4j.Element;</span><br><span class="line">import org.dom4j.io.SAXReader;</span><br><span class="line"></span><br><span class="line">public class XpathTest &#123;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			//1.创建sax读取对象</span><br><span class="line">			SAXReader reader = new SAXReader();//jdbc --classloader</span><br><span class="line">			//2.指定解析的xml源 </span><br><span class="line">			Document document = reader.read(new File(&quot;src/xml/stus.xml&quot;));</span><br><span class="line">			//3.得到元素</span><br><span class="line">			Element rootElement = document.getRootElement();</span><br><span class="line">			</span><br><span class="line">			// 要想使用Xpath，还得添加支持的jar 获取第一个只返回第一个</span><br><span class="line">			Element nameElement = (Element) rootElement.selectSingleNode(&quot;//name&quot;);</span><br><span class="line">			System.out.println(nameElement.getText());</span><br><span class="line">			</span><br><span class="line">			System.out.println(&quot;####################&quot;);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			//获取文档中所有的name元素</span><br><span class="line">			List&lt;Element&gt; list = rootElement.selectNodes(&quot;//name&quot;);</span><br><span class="line">			for(Element element : list) &#123;</span><br><span class="line">				System.out.println(element.getText());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>约束</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">属性ID规定唯一或者元素只能出现一次</span><br><span class="line">DTD：</span><br><span class="line">	语法可读性差</span><br><span class="line">	1. 引入网络上的DTD</span><br><span class="line"></span><br><span class="line">   &lt;!-- 引入dtd 来约束这个xml --&gt;</span><br><span class="line"></span><br><span class="line">   	&lt;!--    文档类型  根标签名字 网络上的dtd   dtd的名称   dtd的路径</span><br><span class="line"></span><br><span class="line">   	&lt;!DOCTYPE stus PUBLIC &quot;//UNKNOWN/&quot; &quot;unknown.dtd&quot;&gt; --&gt;</span><br><span class="line"></span><br><span class="line">	1. 引入本地的DTD</span><br><span class="line"></span><br><span class="line">   &lt;!-- 引入本地的DTD  ： 根标签名字 引入本地的DTD  dtd的位置 --&gt;</span><br><span class="line">   &lt;!-- &lt;!DOCTYPE stus SYSTEM &quot;stus.dtd&quot;&gt; --&gt;</span><br><span class="line"></span><br><span class="line">	2. 直接在XML里面嵌入DTD的约束规则</span><br><span class="line"></span><br><span class="line">       &lt;!-- xml文档里面直接嵌入DTD的约束法则 --&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!DOCTYPE stus [</span><br><span class="line">            &lt;!ELEMENT stus (stu)&gt;</span><br><span class="line">            &lt;!ELEMENT stu (name,age)&gt;</span><br><span class="line">            &lt;!ELEMENT name (#PCDATA)&gt;</span><br><span class="line">            &lt;!ELEMENT age (#PCDATA)&gt;</span><br><span class="line">        ]&gt;</span><br><span class="line"></span><br><span class="line">        &lt;stus&gt;</span><br><span class="line">            &lt;stu&gt;</span><br><span class="line">                &lt;name&gt;张三&lt;/name&gt;</span><br><span class="line">                &lt;age&gt;18&lt;/age&gt;</span><br><span class="line">            &lt;/stu&gt;</span><br><span class="line">        &lt;/stus&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!ELEMENT stus (stu)&gt;  : stus 下面有一个元素 stu  ， 但是只有一个</span><br><span class="line">	&lt;!ELEMENT stu (name , age)&gt;  stu下面有两个元素 name  ,age  顺序必须name-age</span><br><span class="line">	&lt;!ELEMENT name (#PCDATA)&gt; </span><br><span class="line">	&lt;!ELEMENT age (#PCDATA)&gt;</span><br><span class="line">	&lt;!ATTLIST stu id CDATA #IMPLIED&gt; stu有一个属性 文本类型， 该属性可有可无</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	元素的个数：</span><br><span class="line"></span><br><span class="line">		＋　一个或多个</span><br><span class="line">		*  零个或多个</span><br><span class="line">		? 零个或一个</span><br><span class="line"></span><br><span class="line">	属性的类型定义 </span><br><span class="line"></span><br><span class="line">		CDATA : 属性是普通文字</span><br><span class="line">		ID : 属性的值必须唯一</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;!ELEMENT stu (name , age)&gt;		按照顺序来 </span><br><span class="line">	&lt;!ELEMENT stu (name | age)&gt;   两个中只能包含一个子元素</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">Schema：</span><br><span class="line">	其实就是一个xml，使用xml的语法规则，xml解析器解析方便，是为了替代DTD</span><br><span class="line">	但是Scheme约束文本内容比DTD的内容还要多，所以没有真正意思上的替代DTD</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">约束文档：</span><br><span class="line">	&lt;!-- xmlns  :  xml namespace : 名称空间 /  命名空间</span><br><span class="line">	targetNamespace :  目标名称空间 。 下面定义的那些元素都与这个名称空间绑定上。 </span><br><span class="line">	elementFormDefault ： 元素的格式化情况。  --&gt;</span><br><span class="line">	&lt;schema xmlns=&quot;http://www.w3.org/2001/XMLSchema&quot; </span><br><span class="line">		targetNamespace=&quot;http://www.itheima.com/teacher&quot; </span><br><span class="line">		elementFormDefault=&quot;qualified&quot;&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;element name=&quot;teachers&quot;&gt;</span><br><span class="line">			&lt;complexType&gt;</span><br><span class="line">				&lt;sequence maxOccurs=&quot;unbounded&quot;&gt;</span><br><span class="line">					&lt;!-- 这是一个复杂元素 --&gt;</span><br><span class="line">					&lt;element name=&quot;teacher&quot;&gt;</span><br><span class="line">						&lt;complexType&gt;</span><br><span class="line">							&lt;sequence&gt;</span><br><span class="line">								&lt;!-- 以下两个是简单元素 --&gt;</span><br><span class="line">								&lt;element name=&quot;name&quot; type=&quot;string&quot;&gt;&lt;/element&gt;</span><br><span class="line">								&lt;element name=&quot;age&quot; type=&quot;int&quot;&gt;&lt;/element&gt;</span><br><span class="line">							&lt;/sequence&gt;</span><br><span class="line">						&lt;/complexType&gt;</span><br><span class="line">					&lt;/element&gt;</span><br><span class="line">				&lt;/sequence&gt;</span><br><span class="line">			&lt;/complexType&gt;</span><br><span class="line">		&lt;/element&gt;</span><br><span class="line">	&lt;/schema&gt;</span><br><span class="line"></span><br><span class="line">实例文档：</span><br><span class="line">	&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">	&lt;!-- xmlns:xsi : 这里必须是这样的写法，也就是这个值已经固定了。</span><br><span class="line">	xmlns : 这里是名称空间，也固定了，写的是schema里面的顶部目标名称空间</span><br><span class="line">	xsi:schemaLocation : 有两段： 前半段是名称空间，也是目标空间的值 ， 后面是约束文档的路径。</span><br><span class="line">	 --&gt;</span><br><span class="line">	&lt;teachers</span><br><span class="line">		xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">		xmlns=&quot;http://www.itheima.com/teacher&quot;</span><br><span class="line">		xsi:schemaLocation=&quot;http://www.itheima.com/teacher teacher.xsd&quot;</span><br><span class="line">	&gt;</span><br><span class="line">		&lt;teacher&gt;</span><br><span class="line">			&lt;name&gt;zhangsan&lt;/name&gt;</span><br><span class="line">			&lt;age&gt;19&lt;/age&gt;</span><br><span class="line">		&lt;/teacher&gt;</span><br><span class="line">		&lt;teacher&gt;</span><br><span class="line">			&lt;name&gt;lisi&lt;/name&gt;</span><br><span class="line">			&lt;age&gt;29&lt;/age&gt;</span><br><span class="line">		&lt;/teacher&gt;</span><br><span class="line">		&lt;teacher&gt;</span><br><span class="line">			&lt;name&gt;lisi&lt;/name&gt;</span><br><span class="line">			&lt;age&gt;29&lt;/age&gt;</span><br><span class="line">		&lt;/teacher&gt;</span><br><span class="line">	&lt;/teachers&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##名称空间的作用</span><br><span class="line">一个xml如果想指定它的约束规则， 假设使用的是DTD ，那么这个xml只能指定一个DTD，不能指定多个DTD 。 但是如果一个xml的约束是定义在schema里面，并且是多个schema，那么是可以的。简单的说： 一个xml 可以引用多个schema约束。 但是只能引用一个DTD约束。</span><br><span class="line">名称空间的作用就是在 写元素的时候，可以指定该元素使用的是哪一套约束规则。  默认情况下 ，如果只有一套规则，那么都可以这么写</span><br><span class="line">&lt;name&gt;张三&lt;/name&gt;</span><br><span class="line">&lt;aa:name&gt;&lt;/aa:name&gt;</span><br><span class="line">&lt;bb:name&gt;&lt;/bb:name&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h1><p><strong>程序架构</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C/S（Client/Server）</span><br><span class="line">QQ微信</span><br><span class="line">优点：有一部分代码写在客户端，用户体现差</span><br><span class="line">缺点：服务器更新，客户端跟着更新，占用资源大</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">B/S（browser/Server）</span><br><span class="line">优点：客户端只要有浏览器就行，占用资源少，不用更新</span><br><span class="line">缺点：用户体现不佳</span><br></pre></td></tr></table></figure>
<p><strong>Web服务器</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;其实服务器就是一台电脑，配置比一般的好</span><br><span class="line">&gt;客户端在浏览器的地址栏输入地址，然后web服务器软件，接受请求，然后响应消息</span><br><span class="line">&gt;处理客户端的请求，返回资源|信息</span><br><span class="line">web应用 需要服务器支撑 index.html</span><br></pre></td></tr></table></figure>
<p><strong>Tomcat目录</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">bin</span><br><span class="line">&gt;&gt;jar bat  startup.bat</span><br><span class="line">conf</span><br><span class="line">&gt;&gt;tomcat的配置，server.xml  web.xml</span><br><span class="line">lib</span><br><span class="line">&gt;&gt;tomcat运行所需的jar文件</span><br><span class="line">temp</span><br><span class="line">&gt;&gt;临时文件</span><br><span class="line">webapps</span><br><span class="line">&gt;&gt;存放着发布到tomcat服务器上的项目</span><br><span class="line">work</span><br><span class="line">&gt;&gt;jsp翻译成java文件存放地</span><br></pre></td></tr></table></figure>
<p><strong>发布项目到tomcat</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;需求：如何能让其他电脑访问这台电脑上的资源 stu.xml</span><br><span class="line">&gt;&gt;localhost:8080:本地地址</span><br><span class="line">&gt;&gt;1.拷贝文件到这个webapps/root下，在浏览器访问：</span><br><span class="line">	localhost:8080/stu.xml</span><br><span class="line">&gt;&gt;2.在webapps下新建文件夹xml，然后拷贝文件到该文件夹中</span><br><span class="line">	http://localhost:8080/xml/stu.xml</span><br><span class="line">	http://localhost:8080/xml：对应到webapps/xml</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;3.使用localhost：8080/docs 打开tomcat首页，找到configuration点击进入，再进入左侧找到context（http://localhost:8080/docs/config/context.html）</span><br><span class="line">&gt;&gt;&gt;&gt;配置虚拟路径</span><br><span class="line">&gt;&gt;&gt;&gt;1.在conf/server.xml找到host元素节点</span><br><span class="line">	2. 加入以下内容。</span><br><span class="line">   		&lt;!-- docBase ：  项目的路径地址 如： D:\xml02\person.xml</span><br><span class="line">   		path : 对应的虚拟路径 一定要以/打头。</span><br><span class="line">   		对应的访问方式为： http://localhost:8080/a/person.xml --&gt;</span><br><span class="line">   		&lt;Context docBase=&quot;D:\xml02&quot; path=&quot;/a&quot;&gt;&lt;/Context&gt;</span><br><span class="line">	3. 在浏览器地址栏上输入： http://localhost:8080/a/person.xml</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;4. 配置虚拟路径</span><br><span class="line">&gt;&gt;&gt;&gt;1. 在tomcat/conf/catalina/localhost/ 文件夹下新建一个xml文件，名字	可以自己定义。 person.xml</span><br><span class="line">&gt;&gt;&gt;&gt;2. 在这个文件里面写入以下内容</span><br><span class="line">       &lt;?xml version=&apos;1.0&apos; encoding=&apos;utf-8&apos;?&gt;</span><br><span class="line">            &lt;Context docBase=&quot;D:\xml02&quot;&gt;&lt;/Context&gt;</span><br><span class="line">&gt;&gt;&gt;&gt;3. 在浏览器上面访问</span><br><span class="line">       http://localhost:8080/person/xml的名字即可</span><br></pre></td></tr></table></figure>
<p><strong>eclipse配置tomcat</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1. 在server里面 右键新建一个服务器， 选择到apache分类， 找到对应的tomcat版本， 接着一步一步配置即可。</span><br><span class="line">2. 配置完毕后， 在server 里面， 右键刚才的服务器，然后open  ， 找到上面的Server Location , 选择中间的 Use Tomcat installation...</span><br><span class="line">3. 创建web工程， 在WebContent下定义html文件， 右键工程， run as server </span><br><span class="line">##总结：</span><br><span class="line">xml</span><br><span class="line">	1. 会定义xml</span><br><span class="line">	2. 会解析xml</span><br><span class="line">		dom4j  基本解析</span><br><span class="line">		Xpath手法</span><br><span class="line">tomcat</span><br><span class="line">	1. 会安装 ，会启动 ， 会访问。</span><br><span class="line">	2. 会设置虚拟路径</span><br><span class="line">	3. 给eclipse配置tomcat</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><p><strong>JDBC</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JAVA DataBase Connectivity：java数据库连接</span><br><span class="line">&gt;&gt;为什么出现JDBC</span><br><span class="line">&gt;&gt;&gt;&gt;sun公司规定的一种数据访问规范，由于数据库种类较多，java语言使用广泛，sun公司提供一种，让其他的数据库提供商去实现底层的访问规则。我们的Java程序只要使用sun公司提供的jdbc驱动即可</span><br></pre></td></tr></table></figure>
<p><strong>JDBC入门</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">package com.itheima.test;</span><br><span class="line"></span><br><span class="line">import java.net.URI;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.Driver;</span><br><span class="line">import java.sql.DriverManager;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.sql.Statement;</span><br><span class="line"></span><br><span class="line">public class MainTest &#123;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">	</span><br><span class="line">		 </span><br><span class="line">		try &#123;</span><br><span class="line">			//1.注册驱动</span><br><span class="line">			DriverManager.registerDriver(new com.mysql.jdbc.Driver());</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			//2.建立连接 参数一：协议+访问的数据库， 参数二：用户名，参数三：密码</span><br><span class="line">			//DriverManager.getConnection(&quot;jdbc:mysql://localhost/test?			   user=monty&amp;password=greatsqldb);</span><br><span class="line">			</span><br><span class="line">			Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost/student&quot;,&quot;root&quot;,&quot;123456&quot;);</span><br><span class="line">			</span><br><span class="line">			//3.创建statement，跟数据库读取一定需要这个对象</span><br><span class="line">			Statement st = conn.createStatement();</span><br><span class="line">			</span><br><span class="line">			//4.执行查询，得到结果集</span><br><span class="line">			String sql = &quot;select * from t_stu&quot;;</span><br><span class="line">			ResultSet rs = st.executeQuery(sql);</span><br><span class="line">			</span><br><span class="line">			while(rs.next()) &#123;</span><br><span class="line">				int id = rs.getInt(&quot;id&quot;);</span><br><span class="line">				String name = rs.getString(&quot;name&quot;);</span><br><span class="line">				int age = rs.getInt(&quot;age&quot;);</span><br><span class="line">				</span><br><span class="line">				System.out.println(&quot;id&quot;+id+&quot;----&quot;+&quot;name&quot;+name+&quot;----&quot;+age+&quot;age&quot;);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			rs.close();</span><br><span class="line">			st.close();</span><br><span class="line">			conn.close();</span><br><span class="line">			</span><br><span class="line">		&#125; catch (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>JDBC工具类</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">JDBCUtil.java</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">package com.itheima.util;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.sql.Statement;</span><br><span class="line"></span><br><span class="line">/**释放资源</span><br><span class="line"> * @author Administrator</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">public class JDBCUtil &#123;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	public static void release(Connection conn, Statement st, ResultSet rs) &#123;</span><br><span class="line">		closeRs(rs);</span><br><span class="line">		closeSt(st);</span><br><span class="line">		closeConn(conn);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	private static void closeRs(ResultSet rs) &#123;</span><br><span class="line">		</span><br><span class="line">		try &#123;</span><br><span class="line">			if(rs != null) &#123;</span><br><span class="line">				rs.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (SQLException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			rs = null;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	private static void closeSt(Statement st) &#123;</span><br><span class="line">		</span><br><span class="line">		try &#123;</span><br><span class="line">			if(st != null) &#123;</span><br><span class="line">				st.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (SQLException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			st = null;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	private static void closeConn(Connection conn) &#123;</span><br><span class="line">		</span><br><span class="line">		try &#123;</span><br><span class="line">			if(conn != null) &#123;</span><br><span class="line">				conn.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (SQLException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			conn = null;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">MainTest.java</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">package com.itheima.test;</span><br><span class="line">import java.net.URI;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.Driver;</span><br><span class="line">import java.sql.DriverManager;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.sql.Statement;</span><br><span class="line"></span><br><span class="line">import com.itheima.util.JDBCUtil;</span><br><span class="line"></span><br><span class="line">public class MainTest &#123;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		Connection conn = null;</span><br><span class="line">		Statement st = null;</span><br><span class="line">		ResultSet rs = null;</span><br><span class="line">	</span><br><span class="line">		try &#123;</span><br><span class="line">			//1.注册驱动</span><br><span class="line">			DriverManager.registerDriver(new com.mysql.jdbc.Driver());</span><br><span class="line">			</span><br><span class="line">			//2.建立连接 参数一：协议+访问的数据库， 参数二：用户名，参数三：密码</span><br><span class="line">			//DriverManager.getConnection(&quot;jdbc:mysql://localhost/test?user=monty&amp;password=greatsqldb);</span><br><span class="line">			conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost/student&quot;,&quot;root&quot;,&quot;123456&quot;);</span><br><span class="line">			</span><br><span class="line">			//3.创建statement，跟数据库读取一定需要这个对象</span><br><span class="line">			st = conn.createStatement();</span><br><span class="line">			</span><br><span class="line">			//4.执行查询，得到结果集</span><br><span class="line">			String sql = &quot;select * from t_stu&quot;;</span><br><span class="line">			rs = st.executeQuery(sql);</span><br><span class="line">			</span><br><span class="line">			System.out.println(&quot;id&quot;+&quot;---- &quot;+&quot;name&quot;+&quot;---- &quot;+&quot;age&quot;);</span><br><span class="line">			while(rs.next()) &#123;</span><br><span class="line">				int id = rs.getInt(&quot;id&quot;);</span><br><span class="line">				String name = rs.getString(&quot;name&quot;);</span><br><span class="line">				int age = rs.getInt(&quot;age&quot;);</span><br><span class="line">				</span><br><span class="line">				System.out.println(+id+&quot;----&quot;+name+&quot;----&quot;+age);</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">		&#125; catch (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			JDBCUtil.release(conn, st, rs);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>JDBC使用步骤</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">1. 注册驱动</span><br><span class="line"></span><br><span class="line">   DriverManager.registerDriver(new com.mysql.jdbc.Driver());</span><br><span class="line"></span><br><span class="line">2. 建立连接</span><br><span class="line"></span><br><span class="line">   //DriverManager.getConnection(&quot;jdbc:mysql://localhost/test?user=monty&amp;password=greatsqldb&quot;);</span><br><span class="line">      		//2. 建立连接 参数一： 协议 + 访问的数据库 ， 参数二： 用户名 ， 参数三： 密码。</span><br><span class="line">      		conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost/student&quot;, &quot;root&quot;, &quot;root&quot;);</span><br><span class="line"></span><br><span class="line">3. 创建statement</span><br><span class="line"></span><br><span class="line">   //3. 创建statement ， 跟数据库打交道，一定需要这个对象</span><br><span class="line">      	st = conn.createStatement();</span><br><span class="line"></span><br><span class="line">4. 执行sql ，得到ResultSet</span><br><span class="line"></span><br><span class="line">   //4. 执行查询 ， 得到结果集</span><br><span class="line">      		String sql = &quot;select * from t_stu&quot;;</span><br><span class="line">      		rs = st.executeQuery(sql);</span><br><span class="line"></span><br><span class="line">5. 遍历结果集</span><br><span class="line"></span><br><span class="line">   //5. 遍历查询每一条记录</span><br><span class="line">      		while(rs.next())&#123;</span><br><span class="line">      			int id = rs.getInt(&quot;id&quot;);</span><br><span class="line">      			String name = rs.getString(&quot;name&quot;);</span><br><span class="line">      			int age = rs.getInt(&quot;age&quot;);</span><br><span class="line">      			System.out.println(&quot;id=&quot;+id + &quot;===name=&quot;+name+&quot;==age=&quot;+age);</span><br><span class="line">   		&#125;</span><br><span class="line">   		</span><br><span class="line">6. 释放资源</span><br><span class="line">	if (rs != null) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            rs.close();</span><br><span class="line">        &#125; catch (SQLException sqlEx) &#123; &#125; // ignore </span><br><span class="line">        rs = null;</span><br><span class="line">    &#125;</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p><strong>JDBC工具类构建</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;注册驱动</span><br><span class="line">1. 资源释放工作的整合</span><br><span class="line">2. 驱动防二次注册</span><br><span class="line">   	DriverManager.registerDriver(new com.mysql.jdbc.Driver());</span><br><span class="line">   	Driver 这个类里面有静态代码块，一上来就执行了，所以等同于我们注册了两次驱动。 其实没这个必要的。</span><br><span class="line">   	//静态代码块 ---&gt; 类加载了，就执行。 //java.sql.DriverManager.registerDriver(new Driver());</span><br><span class="line">3.最后形成以下代码即可。</span><br><span class="line">	Class.forName(&quot;com.mysql.jdbc.Driver&quot;);	</span><br><span class="line">&gt;&gt;连接对象整合</span><br><span class="line">	代码重整</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;使用properties配置文件</span><br><span class="line">1. 在src底下声明一个文件 xxx.properties ，里面的内容吐下：</span><br><span class="line"></span><br><span class="line">   driverClass=com.mysql.jdbc.Driver</span><br><span class="line">      	url=jdbc:mysql://localhost/student</span><br><span class="line">      	name=root</span><br><span class="line">      	password=root</span><br><span class="line"></span><br><span class="line">2. 在工具类里面，使用静态代码块，读取属性</span><br><span class="line">&gt;&gt;&gt;&gt;static&#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			//1. 创建一个属性配置对象</span><br><span class="line">			Properties properties = new Properties();</span><br><span class="line">			InputStream is = new FileInputStream(&quot;jdbc.properties&quot;); //对应文件位于工程根目录</span><br><span class="line">			 </span><br><span class="line">			//使用类加载器，去读取src底下的资源文件。 后面在servlet  //对应文件位于src目录底下</span><br><span class="line">			//InputStream is = JDBCUtil.class.getClassLoader().getResourceAsStream(&quot;jdbc.properties&quot;);</span><br><span class="line">			//导入输入流。</span><br><span class="line">			properties.load(is);</span><br><span class="line">			</span><br><span class="line">			//读取属性</span><br><span class="line">			driverClass = properties.getProperty(&quot;driverClass&quot;);</span><br><span class="line">			url = properties.getProperty(&quot;url&quot;);</span><br><span class="line">			name = properties.getProperty(&quot;name&quot;);</span><br><span class="line">			password = properties.getProperty(&quot;password&quot;);</span><br><span class="line">			</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>SQL的CRUD语句</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;insert</span><br><span class="line">INSERT INTO t_stu (NAME , age) VALUES (&apos;wangqiang&apos;,28)</span><br><span class="line">INSERT INTO t_stu VALUES (NULL,&apos;wangqiang2&apos;,28)</span><br><span class="line">&gt;&gt;delete</span><br><span class="line">DELETE FROM t_stu WHERE id = 6</span><br><span class="line">&gt;&gt;query</span><br><span class="line">SELECT * FROM t_stu</span><br><span class="line">&gt;&gt;update</span><br><span class="line">UPDATE t_stu SET age = 38 WHERE id = 1;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;使用单元测试，测试代码</span><br><span class="line">1. 定义一个类， TestXXX , 里面定义方法 testXXX.</span><br><span class="line">2. 添加junit的支持。 </span><br><span class="line">   右键工程 --- add Library --- Junit --- Junit4</span><br><span class="line">3. 在方法的上面加上注解 ， 其实就是一个标记。</span><br><span class="line">   		@Test</span><br><span class="line">      	public void testQuery() &#123;</span><br><span class="line">      		...</span><br><span class="line">      	&#125;</span><br><span class="line">4. 光标选中方法名字，然后右键执行单元测试。  或者是打开outline视图， 然后选择方法右键执行。</span><br></pre></td></tr></table></figure>
<p><strong>Dao模式</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">新建一个dao的接口， 里面声明数据库访问规则</span><br><span class="line">&gt;&gt;/**</span><br><span class="line">	 * 定义操作数据库的方法</span><br><span class="line">	 */</span><br><span class="line">	public interface UserDao &#123;</span><br><span class="line">	</span><br><span class="line">		/**</span><br><span class="line">		 * 查询所有</span><br><span class="line">		 */</span><br><span class="line">		void findAll();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">新建一个dao的实现类，具体实现早前定义的规则</span><br><span class="line">&gt;&gt;public class UserDaoImpl implements UserDao&#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void findAll() &#123;</span><br><span class="line">		Connection conn = null;</span><br><span class="line">		Statement st = null;</span><br><span class="line">		ResultSet rs = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			//1. 获取连接对象</span><br><span class="line">			conn = JDBCUtil.getConn();</span><br><span class="line">			//2. 创建statement对象</span><br><span class="line">			st = conn.createStatement();</span><br><span class="line">			String sql = &quot;select * from t_user&quot;;</span><br><span class="line">			rs = st.executeQuery(sql);</span><br><span class="line">			</span><br><span class="line">			while(rs.next())&#123;</span><br><span class="line">				String userName = rs.getString(&quot;username&quot;);</span><br><span class="line">				String password = rs.getString(&quot;password&quot;);</span><br><span class="line">				</span><br><span class="line">				System.out.println(userName+&quot;=&quot;+password);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			JDBCUtil.release(conn, st, rs);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">直接使用实现</span><br><span class="line">&gt;&gt;@Test</span><br><span class="line">	public void testFindAll()&#123;</span><br><span class="line">		UserDao dao = new UserDaoImpl();</span><br><span class="line">		dao.findAll();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Statement安全问题</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Statement执行 ，其实是拼接sql语句的。  先拼接sql语句，然后在一起执行。 </span><br><span class="line">&gt;&gt;String sql = &quot;select * from t_user where username=&apos;&quot;+ username  +&quot;&apos; and 		password=&apos;&quot;+ password +&quot;&apos;&quot;;</span><br><span class="line"></span><br><span class="line">	UserDao dao = new UserDaoImpl();</span><br><span class="line">	dao.login(&quot;admin&quot;, &quot;100234khsdf88&apos; or &apos;1=1&quot;);</span><br><span class="line"></span><br><span class="line">	SELECT * FROM t_user WHERE username=&apos;admin&apos; AND PASSWORD=&apos;100234khsdf88&apos; or &apos;1=1&apos; </span><br><span class="line"></span><br><span class="line">	前面先拼接sql语句， 如果变量里面带有了 数据库的关键字，那么一并认为是关键字。 不认为是普通的字符串。 </span><br><span class="line">	rs = st.executeQuery(sql);</span><br></pre></td></tr></table></figure>
<p><strong>PreparedStatement</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;该对象就是替换前面的statement对象。</span><br><span class="line"></span><br><span class="line">&gt;&gt;相比较以前的statement， 预先处理给定的sql语句，对其执行语法检查。 在sql语句里面使用 ? 占位符来替代后续要传递进来的变量。 后面进来的变量值，将会被看成是字符串，不会产生任何的关键字。</span><br><span class="line">&gt;&gt;&gt;&gt;String sql = &quot;insert into t_user values(null , ? , ?)&quot;;</span><br><span class="line">		 ps = conn.prepareStatement(sql);</span><br><span class="line">		 </span><br><span class="line">		 //给占位符赋值 从左到右数过来，1 代表第一个问号， 永远你是1开始。</span><br><span class="line">		 ps.setString(1, userName);</span><br><span class="line">		 ps.setString(2, password);</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="HTTP-amp-Servlet"><a href="#HTTP-amp-Servlet" class="headerlink" title="HTTP&amp;Servlet"></a>HTTP&amp;Servlet</h1><p><strong>Http协议</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">什么是协议</span><br><span class="line">&gt;&gt;双方在交互、通讯的时候， 遵守的一种规范、规则。</span><br><span class="line">http协议</span><br><span class="line">&gt;&gt;针对网络上的客户端 与 服务器端在执行http请求的时候，遵守的一种规范。 其实就是规定了客户端在访问服务器端的时候，要带上哪些东西， 服务器端返回数据的时候，也要带上什么东西。 </span><br><span class="line">&gt;&gt;版本</span><br><span class="line">  1.0	请求数据，服务器返回后， 将会断开连接</span><br><span class="line">  1.1	请求数据，服务器返回后， 连接还会保持着。 除非服务器 | 客户端 关掉。 有一定的时间限制，如果都空着这个连接，那么后面会自己断掉。</span><br></pre></td></tr></table></figure>
<p><strong>演示客户端如何与服务器端通讯</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">在地址栏中键入网络地址 回车  或者是平常注册的时候，点击了注册按钮 ， 浏览器都能显示出来一些东西。那么背地里到底浏览器和服务器是怎么通讯。 它们都传输了哪些数据。</span><br><span class="line"></span><br><span class="line">1. 安装抓包工具 HttpWatch (IE插件)</span><br><span class="line">2. 打开tomcat. 输入localhost:8080 打开首页</span><br><span class="line">3. 在首页上找到Example 字样 </span><br><span class="line">&gt; 6.x 和 7.x 的文档页面有所不同，但是只要找到example就能够找到例子工程</span><br><span class="line">1. 选择 servlet 例子 ---&gt; Request Parameter</span><br><span class="line">接着点击Request  Parameters 的 Execute超链接</span><br><span class="line">执行tomcat的例子，然后查看浏览器和 tomcat服务器的对接细节</span><br></pre></td></tr></table></figure>
<p><strong>Http请求数据解释 </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">请求的数据里面包含三个部分内容 ： 请求行 、 请求头 、请求体</span><br><span class="line"></span><br><span class="line">&gt;&gt;请求行</span><br><span class="line">POST /examples/servlets/servlet/RequestParamExample HTTP/1.1 </span><br><span class="line">POST ： 请求方式 ，以post去提交数据</span><br><span class="line">/examples/servlets/servlet/RequestParamExample</span><br><span class="line">请求的地址路径 ， 就是要访问哪个地方。</span><br><span class="line">HTTP/1.1 协议版本</span><br><span class="line"></span><br><span class="line">&gt;&gt;请求头</span><br><span class="line">Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, */*</span><br><span class="line">	Referer: http://localhost:8080/examples/servlets/servlet/RequestParamExample</span><br><span class="line">	Accept-Language: zh-CN</span><br><span class="line">	User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)</span><br><span class="line">	Content-Type: application/x-www-form-urlencoded</span><br><span class="line">	Accept-Encoding: gzip, deflate</span><br><span class="line">	Host: localhost:8080</span><br><span class="line">	Content-Length: 31</span><br><span class="line">	Connection: Keep-Alive</span><br><span class="line">	Cache-Control: no-cache</span><br><span class="line"></span><br><span class="line">Accept: 客户端向服务器端表示，我能支持什么类型的数据。 </span><br><span class="line">Referer ： 真正请求的地址路径，全路径</span><br><span class="line">Accept-Language: 支持语言格式</span><br><span class="line">User-Agent: 用户代理 向服务器表明，当前来访的客户端信息。 </span><br><span class="line">Content-Type： 提交的数据类型。经过urlencoding编码的form表单的数据</span><br><span class="line">Accept-Encoding： gzip, deflate ： 压缩算法 。 </span><br><span class="line">Host ： 主机地址</span><br><span class="line">Content-Length： 数据长度</span><br><span class="line">Connection : Keep-Alive 保持连接</span><br><span class="line">Cache-Control ： 对缓存的操作</span><br><span class="line"></span><br><span class="line">&gt;&gt;请求体</span><br><span class="line">浏览器真正发送给服务器的数据 </span><br><span class="line">	发送的数据呈现的是key=value ,如果存在多个数据，那么使用 &amp;</span><br><span class="line"></span><br><span class="line">	firstname=zhang&amp;lastname=sansan</span><br></pre></td></tr></table></figure>
<p><strong>Http响应数据解析</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">请求的数据里面包含三个部分内容 ： 响应行 、 响应头 、响应体</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: Apache-Coyote/1.1</span><br><span class="line">Content-Type: text/html;charset=ISO-8859-1</span><br><span class="line">Content-Length: 673</span><br><span class="line">Date: Fri, 17 Feb 2017 02:53:02 GMT</span><br><span class="line"></span><br><span class="line">...这里还有很多数据...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;响应行</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">协议版本  </span><br><span class="line">状态码 </span><br><span class="line">	咱们这次交互到底是什么样结果的一个code. </span><br><span class="line">	200 : 成功，正常处理，得到数据。</span><br><span class="line">	403  : for bidden  拒绝</span><br><span class="line">	404 ： Not Found</span><br><span class="line">	500 ： 服务器异常</span><br><span class="line">OK</span><br><span class="line">	对应前面的状态码  </span><br><span class="line">	</span><br><span class="line">&gt;&gt;响应头</span><br><span class="line">Server:  服务器是哪一种类型。  Tomcat</span><br><span class="line">Content-Type ： 服务器返回给客户端你的内容类型</span><br><span class="line">Content-Length ： 返回的数据长度</span><br><span class="line">Date ： 通讯的日期，响应的时间</span><br></pre></td></tr></table></figure>
<p><strong>Get和Post请求区别</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img04.png" alt="img04"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;post</span><br><span class="line">数据是以流的方式写过去，不会在地址栏上面显示。  现在一般提交数据到服务器使用的都是POST</span><br><span class="line">以流的方式写数据，所以数据没有大小限制。</span><br><span class="line">&gt;&gt;get</span><br><span class="line">会在地址栏后面拼接数据，所以有安全隐患。 一般从服务器获取数据，并且客户端也不用提交上面数据的时候，可以使用GET</span><br><span class="line">能够带的数据有限， 1kb大小</span><br></pre></td></tr></table></figure>
<p><strong>Web资源</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">在http协议当中，规定了请求和响应双方， 客户端和服务器端。与web相关的资源。 </span><br><span class="line">有两种分类</span><br><span class="line">&gt;&gt;静态资源</span><br><span class="line">  html 、 js、 css</span><br><span class="line">&gt;&gt;动态资源</span><br><span class="line">  servlet/jsp</span><br><span class="line">Servlet</span><br><span class="line">&gt;&gt;servlet是什么?</span><br><span class="line">&gt;&gt;&gt;&gt;其实就是一个java程序，运行在我们的web服务器上，用于接收和响应 客户端的http请求。 </span><br><span class="line">&gt;&gt;&gt;&gt;更多的是配合动态资源来做。 当然静态资源也需要使用到servlet，只不过是Tomcat里面已经定义好了一个 DefaultServlet</span><br></pre></td></tr></table></figure>
<p><strong>Hello Servlet</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1. 得写一个Web工程 ， 要有一个服务器。</span><br><span class="line">2. 测试运行Web工程</span><br><span class="line">   1. 新建一个类， 实现Servlet接口</span><br><span class="line">      1. 配置Servlet ， 用意： 告诉服务器，我们的应用有这么些个servlet。</span><br><span class="line">         在webContent/WEB-INF/web.xml里面写上以下内容。</span><br><span class="line">         </span><br><span class="line"> &lt;!-- 向tomcat报告， 我这个应用里面有这个servlet， 名字叫做HelloServlet , 具体的路径是com.itheima.servlet.HelloServlet --&gt;</span><br><span class="line">	  &lt;servlet&gt;</span><br><span class="line">	  	&lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;</span><br><span class="line">	  	&lt;servlet-class&gt;com.itheima.servlet.HelloServlet&lt;/servlet-class&gt;</span><br><span class="line">	  &lt;/servlet&gt;</span><br><span class="line">	  &lt;!-- 注册servlet的映射。  servletName : 找到上面注册的具体servlet，  url-pattern: 在地址栏上的path 一定要以/打头 --&gt;</span><br><span class="line">	  &lt;servlet-mapping&gt;</span><br><span class="line">	  	&lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;</span><br><span class="line">	  	&lt;url-pattern&gt;/a&lt;/url-pattern&gt;</span><br><span class="line">	  &lt;/servlet-mapping&gt;</span><br><span class="line">	3. 在地址栏上输入 http://localhost:8080/项目名称/a</span><br></pre></td></tr></table></figure>
<p><strong>Servlet执行过程</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img05.png" alt="img05"></p>
<p><strong>Servlet的通用写法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Servlet (接口)</span><br><span class="line">	|</span><br><span class="line">	|</span><br><span class="line">GenericServlet</span><br><span class="line">	|</span><br><span class="line">	|</span><br><span class="line">HttpServlet （用于处理http的请求）</span><br></pre></td></tr></table></figure>
<p>定义一个类，继承HttpServlet 复写doGet和doPost</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img06.png" alt="img06"></p>
<p><strong>Servlet的生命周期</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">生命周期</span><br><span class="line">&gt;&gt;从创建到销毁的一段时间</span><br><span class="line">生命周期方法</span><br><span class="line">&gt;&gt;从创建到销毁，所调用的那些方法。</span><br><span class="line">- init方法</span><br><span class="line">  在创建该servlet的实例时，就执行该方法。</span><br><span class="line">  	一个servlet只会初始化一次， init方法只会执行一次</span><br><span class="line">  	默认情况下是 ： 初次访问该servlet，才会创建实例。 </span><br><span class="line">- service方法</span><br><span class="line">  只要客户端来了一个请求，那么就执行这个方法了。</span><br><span class="line">   	 该方法可以被执行很多次。 一次请求，对应一次service方法的调用</span><br><span class="line">- destroy方法</span><br><span class="line">  servlet销毁的时候，就会执行该方法</span><br><span class="line">  		1. 该项目从tomcat的里面移除。</span><br><span class="line">  		2. 正常关闭tomcat就会执行 shutdown.bat</span><br><span class="line">  		</span><br><span class="line">doGet 和 doPost不算生命周期方法，所谓的生命周期方法是指，从对象的创建到销毁一定会执行的方法， 但是这两个方法，不一定会执行。</span><br></pre></td></tr></table></figure>
<p><strong>让Servlet创建实例的时机提前</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. 默认情况下，只有在初次访问servlet的时候，才会执行init方法。 有的时候，我们可能需要在这个方法里面执行一些初始化工作，甚至是做一些比较耗时的逻辑。 </span><br><span class="line">2. 那么这个时候，初次访问，可能会在init方法中逗留太久的时间。 那么有没有方法可以让这个初始化的时机提前一点。 </span><br><span class="line">3. 在配置的时候， 使用load-on-startup元素来指定， 给定的数字越小，启动的时机就越早。 一般不写负数， 从2开始即可。 </span><br><span class="line">&lt;servlet&gt;</span><br><span class="line">	  	&lt;servlet-name&gt;HelloServlet04&lt;/servlet-name&gt;</span><br><span class="line">	  	&lt;servlet-class&gt;com.itheima.servlet.HelloServlet04&lt;/servlet-class&gt;</span><br><span class="line">	  	&lt;load-on-startup&gt;2&lt;/load-on-startup&gt;</span><br><span class="line">	  &lt;/servlet&gt;</span><br></pre></td></tr></table></figure>
<p><strong>ServletConfig</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;Servlet的配置，通过这个对象，可以获取servlet在配置的时候一些信息</span><br><span class="line">&gt;&gt;先说 ， 在写怎么用， 最后说有什么用。</span><br><span class="line"></span><br><span class="line">//1. 得到servlet配置对象 专门用于在配置servlet的信息</span><br><span class="line">	ServletConfig config = getServletConfig();</span><br><span class="line">//获取到的是配置servlet里面servlet-name 的文本内容</span><br><span class="line">	String servletName = config.getServletName();</span><br><span class="line">	System.out.println(&quot;servletName=&quot;+servletName);</span><br><span class="line">	</span><br><span class="line">//2、。 可以获取具体的某一个参数。 </span><br><span class="line">	String address = config.getInitParameter(&quot;address&quot;);</span><br><span class="line">	System.out.println(&quot;address=&quot;+address);</span><br><span class="line"></span><br><span class="line">//3.获取所有的参数名称</span><br><span class="line">	Enumeration&lt;String&gt; names = config.getInitParameterNames();</span><br><span class="line">	//遍历取出所有的参数名称</span><br><span class="line">	while (names.hasMoreElements()) &#123;</span><br><span class="line">		String key = (String) names.nextElement();</span><br><span class="line">		String value = config.getInitParameter(key);</span><br><span class="line">		System.out.println(&quot;key===&quot;+key + &quot;   value=&quot;+value);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>为什么需要有这个ServletConfig</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1. 未来我们自己开发的一些应用，使用到了一些技术，或者一些代码，我们不会。 但是有人写出来了。它的代码放置在了自己的servlet类里面。 </span><br><span class="line">2. 刚好这个servlet 里面需要一个数字或者叫做变量值。 但是这个值不能是固定了。 所以要求使用到这个servlet的公司，在注册servlet的时候，必须要在web.xml里面，声明init-params</span><br><span class="line">在开发当中比较少用。</span><br><span class="line"></span><br><span class="line">##总结</span><br><span class="line">- Http协议</span><br><span class="line">  1. 使用HttpWacht 抓包看一看http请求背后的细节。 </span><br><span class="line">     1. 基本了解 请求和响应的数据内容</span><br><span class="line">        请求行、 请求头 、请求体</span><br><span class="line">        	响应行、响应头、响应体</span><br><span class="line">     2. Get和Post的区别</span><br><span class="line">- Servlet【重点】</span><br><span class="line">  1. 会使用简单的servlet</span><br><span class="line">     1.写一个类，实现接口Servlet</span><br><span class="line">     	2. 配置Servlet</span><br><span class="line">     	3. 会访问Setvlet</span><br><span class="line">     1. Servlet的生命周期</span><br><span class="line">        init 一次 创建对象 默认初次访问就会调用或者可以通过配置，让它提前 load-on-startup</span><br><span class="line">        service	多次，一次请求对应一次service</span><br><span class="line">        destory 一次 销毁的时候 从服务器移除 或者 正常关闭服务器</span><br><span class="line">     2. ServletConfig</span><br><span class="line">        获取配置的信息， params</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="HTTPServletReauest-amp-HTTPServletResponse"><a href="#HTTPServletReauest-amp-HTTPServletResponse" class="headerlink" title="HTTPServletReauest&amp;HTTPServletResponse"></a>HTTPServletReauest&amp;HTTPServletResponse</h1><p><strong>Servlet配置方式</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--全路径匹配</span><br><span class="line">&gt; 以 / 开始   /a /aa/bb</span><br><span class="line">&gt; localhost:8080/项目名称/aa/bb </span><br><span class="line">--路径匹配 , 前半段匹配</span><br><span class="line">&gt; 以  / 开始 ， 但是以 * 结束  /a/* /*  </span><br><span class="line">&gt; - 其实是一个通配符，匹配任意文字</span><br><span class="line">&gt; localhost:8080/项目名称/aa/bb </span><br><span class="line">--以扩展名匹配</span><br><span class="line">&gt; 写法： 没有/  以 * 开始   *.扩展名    *.aa *.bb</span><br></pre></td></tr></table></figure>
<p><strong>ServletContext</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; Servlet 上下文</span><br><span class="line">&gt; 每个web工程都只有一个ServletContext对象。 说白了也就是不管在哪个servlet里面，获取到的这个类的对象都是同一个。</span><br></pre></td></tr></table></figure>
<p><strong>如何得到对象</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//1. 获取对象</span><br><span class="line">	ServletContext context = getServletContext();</span><br></pre></td></tr></table></figure>
<p><strong>有什么作用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 获取全局配置参数</span><br><span class="line">2. 获取web工程中的资源</span><br><span class="line">3. 存取数据，servlet间共享数据  域对象</span><br></pre></td></tr></table></figure>
<p><strong>可以获取全局配置参数</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img01.png" alt="img01"></p>
<p>获取全局参数</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img02.png" alt="img02"></p>
<p><strong>可以获取Web应用中的资源</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. 获取资源在tomcat里面的绝对路径</span><br><span class="line">	先得到路径，然后自己new InpuStream</span><br><span class="line">		context.getRealPath(&quot;&quot;) //这里得到的是项目在tomcat里面的根目录。</span><br><span class="line">		D:\tomcat\apache-tomcat-7.0.52\apache-tomcat-7.0.52\wtpwebapps\Demo03\</span><br><span class="line">	 	String path = context.getRealPath(&quot;file/config.properties&quot;);</span><br><span class="line">		D:\tomcat\apache-tomcat-7.0.52\apache-tomcat-7.0.52\wtpwebapps\Demo03\file\config.properties</span><br><span class="line">		</span><br><span class="line">2. getResourceAsStream 获取资源 流对象</span><br><span class="line">	直接给相对的路径，然后获取流对象。</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img03.png" alt="img03"></p>
<p><strong>通过classloader去获取web工程下的资源</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img07.png" alt="img07"></p>
<p><strong>使用ServletContext存取数据</strong></p>
<p>1.定义一个登陆的html页面， 定义一个form表单</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img08.png" alt="img08"></p>
<p>2.定义一个Servlet，名为LoginServlet</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img09.png" alt="img09"></p>
<p>3.针对成功或者失败，进行判断，然后跳转到不一样的网页</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img10.png" alt="img10"></p>
<p><strong>ServletContext存取值分析</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img11.png" alt="img11"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 	</span><br><span class="line">A路径： Servlet的路径</span><br><span class="line">	http://localhost:8080/Demo4/login</span><br><span class="line">B路径： 当前这个html的路径：</span><br><span class="line">	http://localhost:8080/Demo4/login.html --&gt;</span><br><span class="line"></span><br><span class="line">&lt;form action=&quot;login&quot; method=&quot;get&quot;&gt;</span><br><span class="line">	账号:&lt;input type=&quot;text&quot; name=&quot;username&quot;/&gt;&lt;br&gt;</span><br><span class="line">	密码:&lt;input type=&quot;text&quot; name=&quot;password&quot;/&gt;&lt;br&gt;</span><br><span class="line">	&lt;input type=&quot;submit&quot; value=&quot;登录&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p><strong>ServletContext 何时创建， 何时销毁?</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">服务器启动的时候，会为托管的每一个web应用程序，创建一个ServletContext对象</span><br><span class="line">从服务器移除托管，或者是关闭服务器。</span><br></pre></td></tr></table></figure>
<p><strong>HttpServletRequest</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">这个对象封装了客户端提交过来的一切数据。</span><br><span class="line">可以获取客户端请求头信息</span><br><span class="line"></span><br><span class="line">1.获取客户端提交过来的数据</span><br><span class="line">//得到一个枚举集合  </span><br><span class="line">	Enumeration&lt;String&gt; headerNames = request.getHeaderNames();</span><br><span class="line">	while (headerNames.hasMoreElements()) &#123;</span><br><span class="line">		String name = (String) headerNames.nextElement();</span><br><span class="line">		String value = request.getHeader(name);</span><br><span class="line">		System.out.println(name+&quot;=&quot;+value);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">2.获取客户端提交过来的数据</span><br><span class="line">	String name = request.getParameter(&quot;name&quot;);</span><br><span class="line">	String address = request.getParameter(&quot;address&quot;);</span><br><span class="line">	System.out.println(&quot;name=&quot;+name);</span><br><span class="line">	System.out.println(&quot;address=&quot;+address);</span><br><span class="line"></span><br><span class="line">	-------------------------------------------------</span><br><span class="line"></span><br><span class="line">	//name=zhangsan&amp;name=lisi&amp;name=wangwu 一个key可以对应多个值。</span><br><span class="line"></span><br><span class="line">	Map&lt;String, String[]&gt; map = request.getParameterMap();</span><br><span class="line">	</span><br><span class="line">	Set&lt;String&gt; keySet = map.keySet();</span><br><span class="line">	Iterator&lt;String&gt; iterator = keySet.iterator();</span><br><span class="line">	while (iterator.hasNext()) &#123;</span><br><span class="line">		String key = (String) iterator.next();</span><br><span class="line">		System.out.println(&quot;key=&quot;+key + &quot;--的值总数有：&quot;+map.get(key).length);</span><br><span class="line">		String value = map.get(key)[0];</span><br><span class="line">		String value1 = map.get(key)[1];</span><br><span class="line">		String value2 = map.get(key)[2];</span><br><span class="line">		</span><br><span class="line">		System.out.println(key+&quot; ======= &quot;+ value + &quot;=&quot; + value1 + &quot;=&quot;+ value2);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">3.获取中文数据</span><br><span class="line">客户端提交数据给服务器端，如果数据中带有中文的话，有可能会出现乱码情况，那么可以参照以下方法解决。</span><br><span class="line"></span><br><span class="line">如果是GET方式</span><br><span class="line"></span><br><span class="line">1. 代码转码</span><br><span class="line">   String username = request.getParameter(&quot;username&quot;);</span><br><span class="line">   	String password = request.getParameter(&quot;password&quot;);</span><br><span class="line">   	</span><br><span class="line">&gt;&gt;System.out.println(&quot;userName=&quot;+username+&quot;==password=&quot;+password);</span><br><span class="line">//get请求过来的数据，在url地址栏上就已经经过编码了，所以我们取到的就是乱码，</span><br><span class="line">//tomcat收到了这批数据，getParameter 默认使用ISO-8859-1去解码</span><br><span class="line">//先让文字回到ISO-8859-1对应的字节数组 ， 然后再按utf-8组拼字符串</span><br><span class="line">username = new String(username.getBytes(&quot;ISO-8859-1&quot;) , &quot;UTF-8&quot;);</span><br><span class="line">System.out.println(&quot;userName=&quot;+username+&quot;==password=&quot;+password);</span><br><span class="line">直接在tomcat里面做配置，以后get请求过来的数据永远都是用UTF-8编码。 </span><br><span class="line"></span><br><span class="line">2.可以在tomcat里面做设置处理 conf/server.xml 加上URIEncoding=&quot;utf-8&quot;</span><br><span class="line">   &lt;Connector connectionTimeout=&quot;20000&quot; port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot; redirectPort=&quot;8443&quot; URIEncoding=&quot;UTF-8&quot;/&gt;</span><br><span class="line">   </span><br><span class="line">如果是POST方式</span><br><span class="line"></span><br><span class="line">这个说的是设置请求体里面的文字编码。  get方式，用这行，有用吗？ ---&gt; 没用</span><br><span class="line">	request.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">	这行设置一定要写在getParameter之前。</span><br></pre></td></tr></table></figure>
<p><strong>HttpServletResponse</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">负责返回数据给客户端。</span><br><span class="line">输出数据到页面上</span><br><span class="line"></span><br><span class="line">	//以字符流的方式写数据	</span><br><span class="line">	//response.getWriter().write(&quot;&lt;h1&gt;hello response...&lt;/h1&gt;&quot;);</span><br><span class="line">	</span><br><span class="line">	//以字节流的方式写数据 </span><br><span class="line">	response.getOutputStream().write(&quot;hello response2222...&quot;.getBytes());</span><br></pre></td></tr></table></figure>
<p><strong>响应的数据中有中文，那么有可能出现中文乱码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">--以字符流输出</span><br><span class="line">&gt; response.getWriter()</span><br><span class="line">//1. 指定输出到客户端的时候，这些文字使用UTF-8编码</span><br><span class="line">	response.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">	</span><br><span class="line">	//2. 直接规定浏览器看这份数据的时候，使用什么编码来看。</span><br><span class="line">	response.setHeader(&quot;Content-Type&quot;, &quot;text/html; charset=UTF-8&quot;);</span><br><span class="line">	</span><br><span class="line">	response.getWriter().write(&quot;我爱黑马训练营...&quot;);</span><br><span class="line"></span><br><span class="line">--以字节流输出</span><br><span class="line">&gt; response.getOutputStream()</span><br><span class="line">	//1. 指定浏览器看这份数据使用的码表</span><br><span class="line">	response.setHeader(&quot;Content-Type&quot;, &quot;text/html;charset=UTF-8&quot;);</span><br><span class="line">	</span><br><span class="line">	//2. 指定输出的中文用的码表</span><br><span class="line">	response.getOutputStream().write(&quot;我爱深圳黑马训练营..&quot;.getBytes(&quot;UTF-8&quot;));</span><br></pre></td></tr></table></figure>
<p><strong>不管是字节流还是字符流，直接使用一行代码就可以了。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(&quot;text/html;charset=UTF-8&quot;);</span><br><span class="line">然后在写数据即可。</span><br></pre></td></tr></table></figure>
<p><strong>演练下载资源</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.直接以超链接的方式下载，不写任何代码。 也能够下载东西下来。 </span><br><span class="line">让tomcat的默认servlet去提供下载：&lt;br&gt;</span><br><span class="line">&lt;a href=&quot;download/aa.jpg&quot;&gt;aa.jpg&lt;/a&gt;&lt;br&gt;</span><br><span class="line">&lt;a href=&quot;download/bb.txt&quot;&gt;bb.txt&lt;/a&gt;&lt;br&gt;</span><br><span class="line">&lt;a href=&quot;download/cc.rar&quot;&gt;cc.rar&lt;/a&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">原因是tomcat里面有一个默认的Servlet -- DefaultServlet 。这个DefaultServlet 专门用于处理放在tomcat服务器上的静态资源。</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img12.png" alt="img12"></p>
<p><strong>总结</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1. Servlet注册方式 </span><br><span class="line">2. ServletContext【重点】</span><br><span class="line">&gt;&gt;作用：</span><br><span class="line">1. 获取全局参数</span><br><span class="line">2. 获取工程里面的资源。</span><br><span class="line">3. 资源共享。  ServletContext 域对象</span><br><span class="line">&gt;&gt;有几个 一个 </span><br><span class="line">&gt;&gt;什么时候创建 ？ 什么时候销毁</span><br><span class="line">服务器启动的时候给每一个应用都创建一个ServletContext对象， 服务器关闭的时候销毁</span><br><span class="line"></span><br><span class="line">简单登录</span><br><span class="line">3. HttpServletRequest【重点】</span><br><span class="line">   1. 获取请求头</span><br><span class="line">      1. 获取提交过来的数据</span><br><span class="line">4. HttpServletResponse【重点】</span><br><span class="line">   负责输出数据到客户端，其实就是对之前的请求作出响应</span><br><span class="line">5. 中文乱码问题。【重点】</span><br><span class="line">6. 下载</span><br></pre></td></tr></table></figure>
<p><strong>作业：</strong></p>
<ol>
<li><p>完成注册 </p>
</li>
<li><p>完成登录</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img13.png" alt="img13"></p>
<p>V1.1 最好配合上数据库，完成注册和登录的功能。 </p>
</li>
</ol>
<hr>
<h1 id="Cookie-amp-amp-Session"><a href="#Cookie-amp-amp-Session" class="headerlink" title="Cookie&amp;&amp;Session"></a>Cookie&amp;&amp;Session</h1><p>   <strong>中文文件下载</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">针对浏览器类型，对文件名字做编码处理 Firefox (Base64) , IE、Chrome ... 使用的是URLEncoder</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 如果文件的名字带有中文，那么需要对这个文件名进行编码处理</span><br><span class="line">	 * 如果是IE ，或者  Chrome （谷歌浏览器） ，使用URLEncoding 编码</span><br><span class="line">	 * 如果是Firefox ， 使用Base64编码</span><br><span class="line">	 */</span><br><span class="line">	//获取来访的客户端类型</span><br><span class="line">	String clientType = request.getHeader(&quot;User-Agent&quot;);</span><br><span class="line">	</span><br><span class="line">	if(clientType.contains(&quot;Firefox&quot;))&#123;</span><br><span class="line">		fileName = DownLoadUtil.base64EncodeFileName(fileName);</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		//IE ，或者  Chrome （谷歌浏览器） ，</span><br><span class="line">		//对中文的名字进行编码处理</span><br><span class="line">		fileName = URLEncoder.encode(fileName,&quot;UTF-8&quot;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>   <strong>请求转发和重定向</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">重定向</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">		之前的写法</span><br><span class="line">		response.setStatus(302);</span><br><span class="line">		response.setHeader(&quot;Location&quot;, &quot;login_success.html&quot;);*/</span><br><span class="line">		</span><br><span class="line">		//重定向写法： 重新定位方向 参数即跳转的位置</span><br><span class="line">	response.sendRedirect(&quot;login_success.html&quot;);</span><br><span class="line"></span><br><span class="line">	1. 地址上显示的是最后的那个资源的路径地址</span><br><span class="line"></span><br><span class="line">	2. 请求次数最少有两次， 服务器在第一次请求后，会返回302 以及一个地址， 浏览器在根据这个地址，执行第二次访问。</span><br><span class="line"></span><br><span class="line">	3. 可以跳转到任意路径。 不是自己的工程也可以跳。</span><br><span class="line"></span><br><span class="line">	4. 效率稍微低一点， 执行两次请求。 </span><br><span class="line"></span><br><span class="line">	5. 后续的请求，没法使用上一次的request存储的数据，或者 没法使用上一次的request对象，因为这是两次不同的请求。</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line">请求转发</span><br><span class="line"></span><br><span class="line">	//请求转发的写法： 参数即跳转的位置</span><br><span class="line">	request.getRequestDispatcher(&quot;login_success.html&quot;).forward(request, response);</span><br><span class="line"></span><br><span class="line">	1. 地址上显示的是请求servlet的地址。  返回200 ok</span><br><span class="line"></span><br><span class="line">	2. 请求次数只有一次， 因为是服务器内部帮客户端执行了后续的工作。 </span><br><span class="line"></span><br><span class="line">	3. 只能跳转自己项目的资源路径 。  </span><br><span class="line"></span><br><span class="line">	4. 效率上稍微高一点，因为只执行一次请求。 </span><br><span class="line"></span><br><span class="line">	5. 可以使用上一次的request对象。</span><br></pre></td></tr></table></figure>
<p>   <img src="/2019/01/26/JavaWeb知识/JavaWeb/img14.png" alt="img14"></p>
<p>   <strong>Cookie</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">饼干. 其实是一份小数据， 是服务器给客户端，并且存储在客户端上的一份小数据</span><br><span class="line"></span><br><span class="line">### 应用场景</span><br><span class="line">&gt; 自动登录、浏览记录、购物车。</span><br></pre></td></tr></table></figure>
<p>   <strong>为什么要有这个Cookie</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http的请求是无状态。 客户端与服务器在通讯的时候，是无状态的，其实就是客户端在第二次来访的时候，服务器根本就不知道这个客户端以前有没有来访问过。 为了更好的用户体验，更好的交互 [自动登录]，其实从公司层面讲，就是为了更好的收集用户习惯[大数据]</span><br></pre></td></tr></table></figure>
<p>   <strong>Cookie怎么用</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#### 简单使用：</span><br><span class="line">- 添加Cookie给客户端</span><br><span class="line">  1. 在响应的时候，添加cookie</span><br><span class="line">     Cookie cookie = new Cookie(&quot;aa&quot;, &quot;bb&quot;);</span><br><span class="line"></span><br><span class="line">//给响应，添加一个cookie</span><br><span class="line">response.addCookie(cookie);</span><br><span class="line">  2.客户端收到的信息里面，响应头中多了一个字段 Set-Cookie</span><br></pre></td></tr></table></figure>
<p>   3.<img src="/2019/01/26/JavaWeb知识/JavaWeb/img15.png" alt="img15"></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">获取客户端带过来的Cookie</span><br><span class="line"></span><br><span class="line">//获取客户端带过来的cookie</span><br><span class="line">	Cookie[] cookies = request.getCookies();</span><br><span class="line">	if(cookies != null)&#123;</span><br><span class="line">		for (Cookie c : cookies) &#123;</span><br><span class="line">			String cookieName = c.getName();</span><br><span class="line">			String cookieValue = c.getValue();</span><br><span class="line">			System.out.println(cookieName + &quot; = &quot;+ cookieValue);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">常用方法</span><br><span class="line">	//关闭浏览器后，cookie就没有了。 ---&gt; 针对没有设置cookie的有效期。</span><br><span class="line">	//	expiry： 有效 以秒计算。</span><br><span class="line">	//正值 ： 表示 在这个数字过后，cookie将会失效。</span><br><span class="line">	//负值： 关闭浏览器，那么cookie就失效， 默认值是 -1</span><br><span class="line">	cookie.setMaxAge(60 * 60 * 24 * 7);</span><br><span class="line">	</span><br><span class="line">	//赋值新的值</span><br><span class="line">	//cookie.setValue(newValue);</span><br><span class="line">	</span><br><span class="line">	//用于指定只有请求了指定的域名，才会带上该cookie</span><br><span class="line">	cookie.setDomain(&quot;.itheima.com&quot;);</span><br><span class="line">	</span><br><span class="line">	//只有访问该域名下的cookieDemo的这个路径地址才会带cookie</span><br><span class="line">	cookie.setPath(&quot;/CookieDemo&quot;);</span><br></pre></td></tr></table></figure>
<p>   <strong>例子一 显示最近访问的时间。</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">1.判断账号是否正确</span><br><span class="line">2. 如果正确，则获取cookie。 但是得到的cookie是一个数组， 我们要从数组里面找到我们想要的对象。</span><br><span class="line">3. 如果找到的对象为空，表明是第一次登录。那么要添加cookie</span><br><span class="line">4. 如果找到的对象不为空， 表明不是第一次登录。 </span><br><span class="line"></span><br><span class="line">	if(&quot;admin&quot;.equals(userName) &amp;&amp; &quot;123&quot;.equals(password))&#123;</span><br><span class="line">		//获取cookie last-name --- &gt;</span><br><span class="line">		Cookie [] cookies = request.getCookies();</span><br><span class="line">		</span><br><span class="line">		//从数组里面找出我们想要的cookie</span><br><span class="line">		Cookie cookie = CookieUtil.findCookie(cookies, &quot;last&quot;);</span><br><span class="line">		</span><br><span class="line">		//是第一次登录，没有cookie</span><br><span class="line">		if(cookie == null)&#123;</span><br><span class="line">			</span><br><span class="line">			Cookie c = new Cookie(&quot;last&quot;, System.currentTimeMillis()+&quot;&quot;);</span><br><span class="line">			c.setMaxAge(60*60); //一个小时</span><br><span class="line">			response.addCookie(c);</span><br><span class="line">			</span><br><span class="line">			response.getWriter().write(&quot;欢迎您, &quot;+userName);</span><br><span class="line">			</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			//1. 去以前的cookie第二次登录，有cookie</span><br><span class="line">			long lastVisitTime = Long.parseLong(cookie.getValue());</span><br><span class="line">			</span><br><span class="line">			//2. 输出到界面，</span><br><span class="line">			response.getWriter().write(&quot;欢迎您, &quot;+userName +&quot;,上次来访时间是：&quot;+new Date(lastVisitTime));</span><br><span class="line">			</span><br><span class="line">			//3. 重置登录的时间</span><br><span class="line">			cookie.setValue(System.currentTimeMillis()+&quot;&quot;);</span><br><span class="line">			response.addCookie(cookie);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		response.getWriter().write(&quot;登陆失败 &quot;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>   <strong>例子二： 显示商品浏览记录。</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">###准备工作</span><br><span class="line"></span><br><span class="line">1. 拷贝基础课第一天的 htmll原型文件，到工程的WebContent里面。</span><br><span class="line"></span><br><span class="line">2. 在WebContent目录下新建一个jsp文件， product_list.jsp, 然后拷贝原来product_list.html的内容到jsp里面。 建好之后，jsp里面的所有ISO-8859-1 改成 UTF-8</span><br><span class="line"></span><br><span class="line">   拷贝html标签的所有内容。 替换jsp的html标签即可</span><br><span class="line"></span><br><span class="line">3. 修改product_info.htm里面的手机数码超链接地址</span><br><span class="line"></span><br><span class="line">   &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;product_list.jsp&quot;&gt;手机数码&lt;span class=&quot;sr-only&quot;&gt;(current)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line"></span><br><span class="line">4. 修改首页(index.html)顶部的手机数码跳转的位置为 product_list.jsp</span><br><span class="line"></span><br><span class="line">   &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;product_list.jsp&quot;&gt;手机数码&lt;span class=&quot;sr-only&quot;&gt;(current)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line"></span><br><span class="line">###分析</span><br></pre></td></tr></table></figure>
<p>   <img src="/2019/01/26/JavaWeb知识/JavaWeb/img16.png" alt="img16"></p>
<p>   <strong>Jsp 里面使用Java代码</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- jsp</span><br><span class="line">&gt; Java Server Pager ---&gt; 最终会翻译成一个类， 就是一个Servlet</span><br><span class="line">- 定义全局变量</span><br><span class="line">  &lt;%! int a = 99; %&gt;</span><br><span class="line">- 定义局部变量</span><br><span class="line">  &lt;% int b = 999; %&gt;</span><br><span class="line">- 在jsp页面上，显示 a 和 b的值，</span><br><span class="line">  &lt;%=a %&gt; </span><br><span class="line">  &lt;%=b %&gt;</span><br></pre></td></tr></table></figure>
<p>   <strong>jsp显示浏览记录</strong></p>
<p>   <img src="/2019/01/26/JavaWeb知识/JavaWeb/img17.png" alt="img17"></p>
<p>   <strong>清除浏览记录</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">其实就是清除Cookie， 删除cookie是没有什么delete方法的。只有设置maxAge 为0 。</span><br><span class="line"></span><br><span class="line">	Cookie cookie = new Cookie(&quot;history&quot;,&quot;&quot;);</span><br><span class="line">	cookie.setMaxAge(0); //设置立即删除</span><br><span class="line">	cookie.setPath(&quot;/CookieDemo02&quot;);</span><br><span class="line">	response.addCookie(cookie);</span><br></pre></td></tr></table></figure>
<p>   <strong>Cookie总结</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1. 服务器给客户端发送过来的一小份数据，并且存放在客户端上。</span><br><span class="line"></span><br><span class="line">2. 获取cookie， 添加cookie</span><br><span class="line"></span><br><span class="line">   request.getCookie();</span><br><span class="line"></span><br><span class="line">   response.addCookie();</span><br><span class="line"></span><br><span class="line">3. Cookie分类</span><br><span class="line"></span><br><span class="line">   会话Cookie</span><br><span class="line">   	默认情况下，关闭了浏览器，那么cookie就会消失。</span><br><span class="line"></span><br><span class="line">   持久Cookie</span><br><span class="line">   </span><br><span class="line">在一定时间内，都有效，并且会保存在客户端上。 </span><br><span class="line">cookie.setMaxAge(0); //设置立即删除</span><br><span class="line">cookie.setMaxAge(100); //100 秒</span><br><span class="line"></span><br><span class="line">4. Cookie的安全问题。</span><br><span class="line">由于Cookie会保存在客户端上，所以有安全隐患问题。  还有一个问题， Cookie的大小与个数有限制。 为了解决这个问题 ---&gt; Session .</span><br></pre></td></tr></table></figure>
<p>   <strong>Session</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">会话 ， Session是基于Cookie的一种会话机制。 Cookie是服务器返回一小份数据给客户端，并且存放在客户端上。 Session是，数据存放在服务器端。</span><br><span class="line"></span><br><span class="line">常用API</span><br><span class="line"></span><br><span class="line">	//得到会话ID</span><br><span class="line">	String id = session.getId();</span><br><span class="line">	//存值</span><br><span class="line">	session.setAttribute(name, value);</span><br><span class="line">	//取值</span><br><span class="line">	session.getAttribute(name);</span><br><span class="line">	//移除值</span><br><span class="line">	session.removeAttribute(name);</span><br><span class="line">	</span><br><span class="line">	- Session何时创建  ， 何时销毁?</span><br><span class="line">- 创建</span><br><span class="line">&gt; 如果有在servlet里面调用了 request.getSession()</span><br><span class="line">- 销毁</span><br><span class="line">&gt; session 是存放在服务器的内存中的一份数据。 当然可以持久化. Redis . 即使关了浏览器，session也不会销毁。</span><br><span class="line">&gt; 1. 关闭服务器</span><br><span class="line">&gt; 1. session会话时间过期。 有效期过了，默认有效期： 30分钟。</span><br></pre></td></tr></table></figure>
<p>   <strong>简单购物车</strong></p>
<p>   <img src="/2019/01/26/JavaWeb知识/JavaWeb/img18.png" alt="img18"></p>
<p>   <strong>CartServlet 代码</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(&quot;text/html;charset=utf-8&quot;);</span><br><span class="line">	</span><br><span class="line">	//1. 获取要添加到购物车的商品id</span><br><span class="line">	int id = Integer.parseInt(request.getParameter(&quot;id&quot;)); // 0 - 1- 2 -3 -4 </span><br><span class="line">	String [] names = &#123;&quot;Iphone7&quot;,&quot;小米6&quot;,&quot;三星Note8&quot;,&quot;魅族7&quot; , &quot;华为9&quot;&#125;;</span><br><span class="line">	//取到id对应的商品名称</span><br><span class="line">	String name = names[id];</span><br><span class="line">	</span><br><span class="line">	//2. 获取购物车存放东西的session  Map&lt;String , Integer&gt;  iphoen7 3</span><br><span class="line">	//把一个map对象存放到session里面去，并且保证只存一次。 </span><br><span class="line">	Map&lt;String, Integer&gt; map = (Map&lt;String, Integer&gt;) request.getSession().getAttribute(&quot;cart&quot;);</span><br><span class="line">	//session里面没有存放过任何东西。</span><br><span class="line">	if(map == null)&#123;</span><br><span class="line">		map = new LinkedHashMap&lt;String , Integer&gt;();</span><br><span class="line">		request.getSession().setAttribute(&quot;cart&quot;, map);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//3. 判断购物车里面有没有该商品</span><br><span class="line">	if(map.containsKey(name))&#123;</span><br><span class="line">		//在原来的值基础上  + 1 </span><br><span class="line">		map.put(name, map.get(name) + 1 );</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		//没有购买过该商品，当前数量为1 。</span><br><span class="line">		map.put(name, 1);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//4. 输出界面。（跳转）</span><br><span class="line">	response.getWriter().write(&quot;&lt;a href=&apos;product_list.jsp&apos;&gt;&lt;h3&gt;继续购物&lt;/h3&gt;&lt;/a&gt;&lt;br&gt;&quot;);</span><br><span class="line">	response.getWriter().write(&quot;&lt;a href=&apos;cart.jsp&apos;&gt;&lt;h3&gt;去购物车结算&lt;/h3&gt;&lt;/a&gt;&quot;);</span><br></pre></td></tr></table></figure>
<p>   <strong>移除Session中的元素</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//强制干掉会话，里面存放的任何数据就都没有了。</span><br><span class="line">session.invalidate();</span><br><span class="line"></span><br><span class="line">//从session中移除某一个数据</span><br><span class="line">//session.removeAttribute(&quot;cart&quot;);</span><br></pre></td></tr></table></figure>
<p>   <strong>总结：</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">- 请求转发和重定向（面试经常问。）</span><br><span class="line">- Cookie</span><br><span class="line">  服务器给客户端发送一小份数据， 存放在客户端上。</span><br><span class="line">  基本用法：</span><br><span class="line">  	添加cookie</span><br><span class="line">	获取cookie。</span><br><span class="line">演练例子：</span><br><span class="line">1. 获取上一次访问时间</span><br><span class="line">2. 获取商品浏览记录。</span><br><span class="line">- 什么时候有cookie</span><br><span class="line">  response.addCookie(new Cookie())</span><br><span class="line">- Cookie 分类</span><br><span class="line">&gt;&gt;会话Cookie </span><br><span class="line">  	关闭浏览器，就失效</span><br><span class="line">&gt;&gt;持久cookie</span><br><span class="line">	存放在客户端上。 在指定的期限内有效。 </span><br><span class="line">	setMaxAge();</span><br><span class="line">	</span><br><span class="line">- Session</span><br><span class="line">也是基于cookie的一种会话技术，  数据存放存放在服务器端</span><br><span class="line">会在cookie里面添加一个字段 JSESSIONID . 是tomcat服务器生成。 </span><br><span class="line"></span><br><span class="line">&gt;&gt;setAttribute 存数据</span><br><span class="line">&gt;&gt;getAttribute 取数据</span><br><span class="line">&gt;&gt;removeAttribute  移除数据</span><br><span class="line">&gt;&gt;getSessionId();  获取会话id</span><br><span class="line">&gt;&gt;invalidate() 强制让会话失效。</span><br><span class="line"></span><br><span class="line">- 创建和销毁</span><br><span class="line">  ，调用request.getSesion创建 </span><br><span class="line">   服务器关闭 ， 会话超时（30分）</span><br><span class="line">   setAttribute 存放的值， 在浏览器关闭后，还有没有。  有！，就算客户端把电脑砸了也还有。</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="JSP-amp-EL-amp-JSTL"><a href="#JSP-amp-EL-amp-JSTL" class="headerlink" title="JSP &amp; EL &amp; JSTL"></a>JSP &amp; EL &amp; JSTL</h1><p>   <strong>jsp</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Java Server Page </span><br><span class="line"></span><br><span class="line">- 什么是jsp</span><br><span class="line">&gt; 从用户角度看待 ，就是是一个网页 ， 从程序员角度看待 ， 其实是一个java类， 它继承了servlet，所以可以直接说jsp 就是一个Servlet.</span><br><span class="line"></span><br><span class="line">- 为什么会有jsp?</span><br><span class="line">&gt; html 多数情况下用来显示静态内容 ， 一成不变的。 但是有时候我们需要在网页上显示一些动态数据， 比如： 查询所有的学生信息， 根据姓名去查询具体某个学生。  这些动作都需要去查询数据库，然后在网页上显示。 html是不支持写java代码  ， jsp里面可以写java代码。</span><br></pre></td></tr></table></figure>
<p>   <strong>怎么用JSP</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">指令写法</span><br><span class="line">&lt;%@ 指令名字 %&gt;</span><br></pre></td></tr></table></figure>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">page指令</span><br><span class="line">- language</span><br><span class="line">&gt;&gt;&gt;&gt;表明jsp页面中可以写java代码</span><br><span class="line">- contentType</span><br><span class="line">&gt;&gt;&gt;&gt;其实即使说这个文件是什么类型，告诉浏览器我是什么内容类型，以及使用什么编码</span><br><span class="line">	contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">	text/html  MIMEType 这是一个文本，html网页</span><br><span class="line">- pageEncoding  jsp内容编码</span><br><span class="line">- extends 用于指定jsp翻译成java文件后，继承的父类是谁，一般不用改。</span><br><span class="line">- import 导包使用的，一般不用手写。</span><br><span class="line">- session </span><br><span class="line">&gt;&gt;&gt;&gt;值可选的有true or false .</span><br><span class="line"> 	用于控制在这个jsp页面里面，能够直接使用session对象。</span><br><span class="line"> 	具体的区别是，请看翻译后的java文件   如果该值是true , 那么在代码里面会有getSession（）的	调用，如果是false :  那么就不会有该方法调用，也就是没有session对象了。在页面上自然也就不	能使用session了。</span><br><span class="line">- errorPage</span><br><span class="line">&gt;&gt;&gt;&gt;指的是错误的页面， 值需要给错误的页面路径</span><br><span class="line">- isErrorPage</span><br><span class="line">&gt;&gt;&gt;&gt;上面的errorPage 用于指定错误的时候跑到哪一个页面去。 那么这个isErroPage , 就是声明某一个	页面到底是不是错误的页面。</span><br></pre></td></tr></table></figure>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">include指令</span><br><span class="line">&gt; 包含另外一个jsp的内容进来。</span><br><span class="line">	&lt;%@ include file=&quot;other02.jsp&quot;%&gt;</span><br><span class="line">- 背后细节:</span><br><span class="line">&gt; 把另外一个页面的所有内容拿过来一起输出。 所有的标签元素都包含进来。</span><br></pre></td></tr></table></figure>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">taglib指令</span><br><span class="line">&lt;%@ taglib prefix=&quot;&quot;  uri=&quot;&quot;%&gt;  </span><br><span class="line">uri: 标签库路径</span><br><span class="line">prefix : 标签库的别名</span><br></pre></td></tr></table></figure>
<p>   <strong>JSP 动作标签</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:include page=&quot;&quot;&gt;&lt;/jsp:include&gt;</span><br><span class="line">&lt;jsp:param value=&quot;&quot; name=&quot;&quot;/&gt;</span><br><span class="line">&lt;jsp:forward page=&quot;&quot;&gt;&lt;/jsp:forward&gt;</span><br><span class="line"></span><br><span class="line">jsp:include</span><br><span class="line">&lt;jsp:include page=&quot;other02.jsp&quot;&gt;&lt;/jsp:include&gt;</span><br><span class="line">包含指定的页面， 这里是动态包含。 也就是不把包含的页面所有元素标签全部拿过来输出，而是把它的运行结果拿过来。 </span><br><span class="line"></span><br><span class="line">jsp:forward</span><br><span class="line">&lt;jsp:forward page=&quot;&quot;&gt;&lt;/jsp:forward&gt;</span><br><span class="line">前往哪一个页面。</span><br><span class="line">&lt;% </span><br><span class="line">	//请求转发</span><br><span class="line">	request.getRequestDispatcher(&quot;other02.jsp&quot;).forward(request, response);</span><br><span class="line">%&gt;	</span><br><span class="line"></span><br><span class="line">jsp:param</span><br><span class="line">意思是： 在包含某个页面的时候，或者在跳转某个页面的时候，加入这个参数。</span><br><span class="line">	&lt;jsp:forward page=&quot;other02.jsp&quot;&gt;</span><br><span class="line">		&lt;jsp:param value=&quot;beijing&quot; name=&quot;address&quot;/&gt;</span><br><span class="line">	&lt;/jsp:forward&gt;</span><br><span class="line">	在other02.jsp中获取参数</span><br><span class="line">	&lt;br&gt;收到的参数是：&lt;br&gt;</span><br><span class="line">&lt;%= request.getParameter(&quot;address&quot;)%&gt;</span><br></pre></td></tr></table></figure>
<p>   <strong>JSP内置对象</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&gt; 所谓内置对象，就是我们可以直接在jsp页面中使用这些对象。 不用创建。</span><br><span class="line"></span><br><span class="line">- pageContext</span><br><span class="line">- request</span><br><span class="line">- session</span><br><span class="line">- application</span><br><span class="line">以上4个是作用域对象 ,</span><br><span class="line"></span><br><span class="line">- 作用域 </span><br><span class="line">表示这些对象可以存值，他们的取值范围有限定。  setAttribute   和  getAttribute</span><br><span class="line">使用作用域来存储数据&lt;br&gt;</span><br><span class="line"></span><br><span class="line">	&lt;%</span><br><span class="line">		pageContext.setAttribute(&quot;name&quot;, &quot;page&quot;);</span><br><span class="line">		request.setAttribute(&quot;name&quot;, &quot;request&quot;);</span><br><span class="line">		session.setAttribute(&quot;name&quot;, &quot;session&quot;);</span><br><span class="line">		application.setAttribute(&quot;name&quot;, &quot;application&quot;);</span><br><span class="line">	%&gt;</span><br><span class="line">	</span><br><span class="line">	取出四个作用域中的值&lt;br&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;%=pageContext.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%=request.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%=session.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%=application.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	</span><br><span class="line">- 作用域范围大小：</span><br><span class="line">pageContext -- request --- session -- application</span><br></pre></td></tr></table></figure>
<p>   <strong>四个作用域的区别</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- pageContext 【PageContext】</span><br><span class="line">&gt; 作用域仅限于当前的页面。  </span><br><span class="line">&gt; 还可以获取到其他八个内置对象。</span><br><span class="line"></span><br><span class="line">- request 【HttpServletRequest】</span><br><span class="line">&gt; 作用域仅限于一次请求， 只要服务器对该请求做出了响应。 这个域中存的值就没有了。</span><br><span class="line"></span><br><span class="line">- session 【HttpSession】</span><br><span class="line">&gt; 作用域限于一次会话（多次请求与响应） 当中。 </span><br><span class="line"></span><br><span class="line">- application 【ServletContext】</span><br><span class="line">&gt; 整个工程都可以访问， 服务器关闭后就不能访问了。 </span><br><span class="line"></span><br><span class="line">- out		 【JspWriter】</span><br><span class="line"></span><br><span class="line">- response  【HttpServletResponse】</span><br><span class="line"></span><br><span class="line">- exception  【Throwable】</span><br><span class="line"></span><br><span class="line">- page	 【Object】 ---就是这个jsp翻译成的java类的实例对象</span><br><span class="line"></span><br><span class="line">- config 【ServletConfig】</span><br></pre></td></tr></table></figure>
<p>   <img src="/2019/01/26/JavaWeb知识/JavaWeb/img19.png" alt="img19"></p>
<p>   <strong>EL表达式</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; 是为了简化咱们的jsp代码，具体一点就是为了简化在jsp里面写的那些java代码。</span><br><span class="line">- 写法格式</span><br><span class="line">$&#123;表达式 &#125;</span><br><span class="line">&gt; 如果从作用域中取值，会先从小的作用域开始取，如果没有，就往下一个作用域取。  一直把四个作用域取完都没有， 就没有显示。</span><br></pre></td></tr></table></figure>
<p>   <strong>如何使用</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">1. 取出4个作用域中存放的值。</span><br><span class="line">&lt;%</span><br><span class="line">		pageContext.setAttribute(&quot;name&quot;, &quot;page&quot;);</span><br><span class="line">		request.setAttribute(&quot;name&quot;, &quot;request&quot;);</span><br><span class="line">		session.setAttribute(&quot;name&quot;, &quot;session&quot;);</span><br><span class="line">		application.setAttribute(&quot;name&quot;, &quot;application&quot;);</span><br><span class="line">	%&gt;</span><br><span class="line">	</span><br><span class="line">	按普通手段取值&lt;br&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;%= pageContext.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%= request.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%= session.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	&lt;%= application.getAttribute(&quot;name&quot;)%&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;br&gt;使用EL表达式取出作用域中的值&lt;br&gt;</span><br><span class="line">	</span><br><span class="line">	$&#123; pageScope.name &#125;</span><br><span class="line">	$&#123; requestScope.name &#125;</span><br><span class="line">	$&#123; sessionScope.name &#125;</span><br><span class="line">	$&#123; applicationScope.name &#125;</span><br><span class="line">	</span><br><span class="line">2.如果域中所存的是数组</span><br><span class="line">&lt;%</span><br><span class="line">			String [] a = &#123;&quot;aa&quot;,&quot;bb&quot;,&quot;cc&quot;,&quot;dd&quot;&#125;;</span><br><span class="line">			pageContext.setAttribute(&quot;array&quot;, a);</span><br><span class="line">%&gt;</span><br><span class="line">使用EL表达式取出作用域中数组的值&lt;br&gt;	</span><br><span class="line">$&#123;array[0] &#125; , $&#123;array[1] &#125;,$&#123;array[2] &#125;,$&#123;array[3] &#125;</span><br><span class="line"></span><br><span class="line">3.如果域中锁存的是集合</span><br><span class="line">	使用EL表达式取出作用域中集合的值&lt;br&gt;</span><br><span class="line"></span><br><span class="line">	$&#123;li[0] &#125; , $&#123;li[1] &#125;,$&#123;li[2] &#125;,$&#123;li[3] &#125;</span><br><span class="line"></span><br><span class="line">	&lt;br&gt;-------------Map数据----------------&lt;br&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">		Map map = new HashMap();</span><br><span class="line">		map.put(&quot;name&quot;, &quot;zhangsna&quot;);</span><br><span class="line">		map.put(&quot;age&quot;,18);</span><br><span class="line">		map.put(&quot;address&quot;,&quot;北京..&quot;);</span><br><span class="line">		</span><br><span class="line">		map.put(&quot;address.aa&quot;,&quot;深圳..&quot;);</span><br><span class="line">		</span><br><span class="line">		pageContext.setAttribute(&quot;map&quot;, map);</span><br><span class="line">	%&gt;</span><br><span class="line">	</span><br><span class="line">4.取出Map集合的值</span><br><span class="line">&lt;%</span><br><span class="line">		Map map = new HashMap();</span><br><span class="line">		map.put(&quot;name&quot;, &quot;zhangsna&quot;);</span><br><span class="line">		map.put(&quot;age&quot;,18);</span><br><span class="line">		map.put(&quot;address&quot;,&quot;北京..&quot;);</span><br><span class="line">		map.put(&quot;address.aa&quot;,&quot;深圳..&quot;);</span><br><span class="line">		pageContext.setAttribute(&quot;map&quot;, map);</span><br><span class="line">   	%&gt;</span><br><span class="line">   	使用EL表达式取出作用域中Map的值&lt;br&gt;</span><br><span class="line">   	$&#123;map.name &#125; , $&#123;map.age &#125; , $&#123;map.address &#125;  , $&#123;map[&quot;address.aa&quot;] &#125;</span><br></pre></td></tr></table></figure>
<p>   <strong>取值细节：</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">1. 从域中取值。得先存值。</span><br><span class="line">   &lt;%</span><br><span class="line">   //pageContext.setAttribute(&quot;name&quot;, &quot;zhangsan&quot;);</span><br><span class="line">   session.setAttribute(&quot;name&quot;, &quot;lisi...&quot;);</span><br><span class="line">   %&gt;</span><br><span class="line"></span><br><span class="line">   &lt;br&gt;直接指定说了，到这个作用域里面去找这个name&lt;br&gt;</span><br><span class="line">   $&#123; pageScope.name &#125; </span><br><span class="line"></span><br><span class="line">   &lt;br&gt;//先从page里面找，没有去request找，去session，去application &lt;br&gt;</span><br><span class="line">   $&#123; name &#125;</span><br><span class="line"></span><br><span class="line">   &lt;br&gt;指定从session中取值&lt;br&gt;</span><br><span class="line">   $&#123; sessionScope.name &#125;  </span><br><span class="line"></span><br><span class="line">2. 取值方式</span><br><span class="line">如果这份值是有下标的，那么直接使用[]</span><br><span class="line">&lt;%</span><br><span class="line">	String [] array = &#123;&quot;aa&quot;,&quot;bb&quot;,&quot;cc&quot;&#125;</span><br><span class="line">	session.setAttribute(&quot;array&quot;,array);</span><br><span class="line">%&gt;</span><br><span class="line">$&#123; array[1] &#125; --&gt; 这里array说的是attribute的name </span><br><span class="line">如果没有下标， 直接使用 .的方式去取</span><br><span class="line">&lt;%</span><br><span class="line">	User user = new User(&quot;zhangsan&quot;,18);</span><br><span class="line">	session.setAttribute(&quot;u&quot;, user);</span><br><span class="line">%&gt;</span><br><span class="line">$&#123; u.name &#125;  , $&#123; u.age &#125; </span><br><span class="line">一般使用EL表达式，用的比较多的，都是从一个对象中取出它的属性值，比如取出某一个学生的姓名。</span><br></pre></td></tr></table></figure>
<p>   <strong>EL表达式 的11个内置对象。</strong> </p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$&#123; 对象名.成员 &#125;</span><br><span class="line"></span><br><span class="line">- pageContext </span><br><span class="line">作用域相关对象</span><br><span class="line"></span><br><span class="line">- pageScope</span><br><span class="line">- requestScope</span><br><span class="line">- sessionScope</span><br><span class="line">- applicationScope</span><br><span class="line"></span><br><span class="line">头信息相关对象</span><br><span class="line">- header</span><br><span class="line">- headerValues</span><br><span class="line"></span><br><span class="line">参数信息相关对象</span><br><span class="line">- param</span><br><span class="line">- paramValues</span><br><span class="line"></span><br><span class="line">- cookie</span><br><span class="line">  全局初始化参数</span><br><span class="line">- initParam</span><br></pre></td></tr></table></figure>
<p>   <strong>JSTL</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; 全称 ： JSP Standard Tag Library  jsp标准标签库</span><br><span class="line"></span><br><span class="line">&gt; 简化jsp的代码编写。 替换 &lt;%%&gt; 写法。 一般与EL表达式配合</span><br><span class="line"></span><br><span class="line">###怎么使用</span><br><span class="line">1. 导入jar文件到工程的WebContent/Web-Inf/lib  jstl.jar standard.jar</span><br><span class="line">2. 在jsp页面上，使用taglib 指令，来引入标签库</span><br><span class="line">3. 注意： 如果想支持 EL表达式，那么引入的标签库必须选择1.1的版本，1.0的版本不支持EL表达式。</span><br><span class="line">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;</span><br></pre></td></tr></table></figure>
<p>   <strong>常用标签</strong></p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:set&gt;&lt;/c:set&gt;</span><br><span class="line">&lt;c:if test=&quot;&quot;&gt;&lt;/c:if&gt;</span><br><span class="line">&lt;c:forEach&gt;&lt;/c:forEach&gt;</span><br><span class="line"></span><br><span class="line">- c:set</span><br><span class="line">	&lt;!-- 声明一个对象name， 对象的值 zhangsan , 存储到了page（默认） ， 指定是session --&gt;</span><br><span class="line">	&lt;c:set var=&quot;name&quot; value=&quot;zhangsan&quot; scope=&quot;session&quot;&gt;&lt;/c:set&gt;</span><br><span class="line">	$&#123;sessionScope.name &#125;</span><br><span class="line">	</span><br><span class="line">- c:if</span><br><span class="line">&gt; 判断test里面的表达式是否满足，如果满足，就执行c:if标签中的输出 ， c:if 是没有else的。 </span><br><span class="line">&lt;c:set var=&quot;age&quot; value=&quot;18&quot; &gt;&lt;/c:set&gt;</span><br><span class="line">	&lt;c:if test=&quot;$&#123; age &gt; 26 &#125;&quot;&gt;</span><br><span class="line">		年龄大于了26岁...</span><br><span class="line">	&lt;/c:if&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;c:if test=&quot;$&#123; age &lt;= 26 &#125;&quot;&gt;</span><br><span class="line">		年龄小于了26岁...</span><br><span class="line">	&lt;/c:if&gt;</span><br><span class="line">	</span><br><span class="line">		------------------------------</span><br><span class="line"></span><br><span class="line">	定义一个变量名 flag  去接收前面表达式的值，然后存在session域中</span><br><span class="line"></span><br><span class="line">	&lt;c:if test=&quot;$&#123; age &gt; 26 &#125;&quot; var=&quot;flag&quot; scope=&quot;session&quot;&gt;</span><br><span class="line">		年龄大于了26岁...</span><br><span class="line">	&lt;/c:if&gt;</span><br><span class="line">	</span><br><span class="line">- c:forEach</span><br><span class="line">	从1 开始遍历到10 ，得到的结果 ，赋值给 i ,并且会存储到page域中， step , 增幅为2， </span><br><span class="line">	&lt;c:forEach begin=&quot;1&quot; end=&quot;10&quot; var=&quot;i&quot; step=&quot;2&quot;&gt;</span><br><span class="line">		$&#123;i &#125;</span><br><span class="line">	&lt;/c:forEach&gt;</span><br><span class="line">	</span><br><span class="line">		-----------------------------------------------</span><br><span class="line"></span><br><span class="line">	&lt;!-- items : 表示遍历哪一个对象，注意，这里必须写EL表达式。 </span><br><span class="line">	var: 遍历出来的每一个元素用user 去接收。 --&gt;</span><br><span class="line">	&lt;c:forEach var=&quot;user&quot; items=&quot;$&#123;list &#125;&quot;&gt;</span><br><span class="line">		$&#123;user.name &#125; ----$&#123;user.age &#125;</span><br><span class="line">	&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<p><strong>学生信息管理系统</strong></p>
<p>需求分析</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img20.png" alt="img20"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">1. 先写 login.jsp , 并且搭配一个LoginServlet 去获取登录信息。</span><br><span class="line">2. 创建用户表， 里面只要有id , username  和 password</span><br><span class="line">3. 创建UserDao, 定义登录的方法 </span><br><span class="line">     	/**</span><br><span class="line"></span><br><span class="line">   - 该dao定义了对用户表的访问规则</span><br><span class="line">      */</span><br><span class="line">     public interface UserDao &#123;</span><br><span class="line">     1. - - 这里简单就返回一个Boolean类型， 成功或者失败即可。</span><br><span class="line">       - </span><br><span class="line">       - 但是开发的时候，登录的方法，一旦成功。这里应该返回该用户的个人信息</span><br><span class="line">       - @param userName </span><br><span class="line">       - @param password</span><br><span class="line">       - </span><br><span class="line">       - @return true : 登录成功， false : 登录失败。</span><br><span class="line">         */</span><br><span class="line">           boolean login(String userName , String password);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">4. 创建UserDaoImpl , 实现刚才定义的登录方法。</span><br><span class="line"> 	public class UserDaoImpl implements UserDao &#123;</span><br><span class="line"></span><br><span class="line">		@Override</span><br><span class="line">		public boolean login(String userName , String password) &#123;</span><br><span class="line">			</span><br><span class="line">			Connection conn = null;</span><br><span class="line">			PreparedStatement ps = null;</span><br><span class="line">			ResultSet rs   = null;</span><br><span class="line">			try &#123;</span><br><span class="line">				//1. 得到连接对象</span><br><span class="line">				conn = JDBCUtil.getConn();</span><br><span class="line">				</span><br><span class="line">				String sql = &quot;select * from t_user where username=? and password=?&quot;;</span><br><span class="line">				</span><br><span class="line">				//2. 创建ps对象</span><br><span class="line">				ps = conn.prepareStatement(sql);</span><br><span class="line">				ps.setString(1, userName);</span><br><span class="line">				ps.setString(2, password);</span><br><span class="line">				</span><br><span class="line">					//3. 开始执行。</span><br><span class="line">				rs = ps.executeQuery();</span><br><span class="line">				</span><br><span class="line">				//如果能够成功移到下一条记录，那么表明有这个用户。 </span><br><span class="line">				return rs.next();</span><br><span class="line">				</span><br><span class="line">			&#125; catch (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;finally &#123;</span><br><span class="line">				JDBCUtil.release(conn, ps, rs);</span><br><span class="line">			&#125;</span><br><span class="line">			return false;</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">5. 在LoginServlet里面访问UserDao， 判断登录结果。 以区分对待</span><br><span class="line">6. 创建stu_list.jsp , 让登录成功的时候跳转过去。</span><br><span class="line">7. 创建学生表 ， 里面字段随意。 </span><br><span class="line">8. 定义学生的Dao . StuDao  </span><br><span class="line">		public interface StuDao &#123;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * 查询出来所有的学生信息</span><br><span class="line">		 * @return List集合</span><br><span class="line">		 */</span><br><span class="line">		List&lt;Student&gt; findAll();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">9.对上面定义的StuDao 做出实现 StuDaoImpl</span><br><span class="line">public class StuDaoImpl implements StuDao &#123;</span><br><span class="line">	@Override</span><br><span class="line">	public List&lt;Student&gt; findAll() &#123;</span><br><span class="line">		List&lt;Student&gt; list = new ArrayList&lt;Student&gt;();</span><br><span class="line">		Connection conn = null;</span><br><span class="line">		PreparedStatement ps = null;</span><br><span class="line">		ResultSet rs   = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			//1. 得到连接对象</span><br><span class="line">			conn = JDBCUtil.getConn();</span><br><span class="line">			</span><br><span class="line">			String sql = &quot;select * from t_stu&quot;;</span><br><span class="line">			</span><br><span class="line">			ps = conn.prepareStatement(sql);</span><br><span class="line">			</span><br><span class="line">			rs = ps.executeQuery();</span><br><span class="line">			   				</span><br><span class="line">   				//数据多了，用对象装， 对象也多了呢？ 用集合装。 </span><br><span class="line">   				while(rs.next())&#123; //10 次 ，10个学生</span><br><span class="line">   					</span><br><span class="line">   					Student stu = new Student();</span><br><span class="line">   					</span><br><span class="line">   					stu.setId(rs.getInt(&quot;id&quot;));</span><br><span class="line">   					stu.setAge(rs.getInt(&quot;age&quot;));</span><br><span class="line">   					stu.setName(rs.getString(&quot;name&quot;));</span><br><span class="line">   					stu.setGender(rs.getString(&quot;gender&quot;));</span><br><span class="line">   					stu.setAddress(rs.getString(&quot;address&quot;));</span><br><span class="line">   					</span><br><span class="line">   					list.add(stu);</span><br><span class="line">   					</span><br><span class="line">   				&#125;</span><br><span class="line">   			&#125; catch (SQLException e) &#123;</span><br><span class="line">   				e.printStackTrace();</span><br><span class="line">   			&#125;finally &#123;</span><br><span class="line">   				JDBCUtil.release(conn, ps, rs);</span><br><span class="line">   			&#125;</span><br><span class="line">   			</span><br><span class="line">   			return list;</span><br><span class="line">   		&#125;</span><br><span class="line">   	</span><br><span class="line">   	&#125;</span><br><span class="line">   	</span><br><span class="line">10. 在登录成功的时候，完成三件事情。</span><br><span class="line">11. 查询所有的学生</span><br><span class="line">   1. 把这个所有的学生集合存储到作用域中。</span><br><span class="line">   2. 跳转到stu_list.jsp</span><br><span class="line">   </span><br><span class="line">   		protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">		//提交的数据有可能有中文， 怎么处理。</span><br><span class="line">		request.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">		response.setContentType(&quot;text/html;charset=utf-8&quot;);</span><br><span class="line">		</span><br><span class="line">		//1. 获取客户端提交的信息</span><br><span class="line">		String userName = request.getParameter(&quot;username&quot;);</span><br><span class="line">		String password = request.getParameter(&quot;password&quot;);</span><br><span class="line">		</span><br><span class="line">		//2. 去访问dao ， 看看是否满足登录。</span><br><span class="line">		UserDao dao = new UserDaoImpl();</span><br><span class="line">		boolean isSuccess = dao.login(userName, password);</span><br><span class="line">		</span><br><span class="line">		//3. 针对dao的返回结果，做出响应</span><br><span class="line">		if(isSuccess)&#123;</span><br><span class="line">			//response.getWriter().write(&quot;登录成功.&quot;);</span><br><span class="line">			</span><br><span class="line">			//1. 查询出来所有的学生信息。</span><br><span class="line">			StuDao stuDao = new StuDaoImpl();</span><br><span class="line">			List&lt;Student&gt; list = stuDao.findAll();</span><br><span class="line">			</span><br><span class="line">			//2. 先把这个集合存到作用域中。</span><br><span class="line">			request.getSession().setAttribute(&quot;list&quot;, list);</span><br><span class="line">			</span><br><span class="line">			//2. 重定向</span><br><span class="line">			response.sendRedirect(&quot;stu_list.jsp&quot;);</span><br><span class="line">			</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			response.getWriter().write(&quot;用户名或者密码错误！&quot;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">11.在stu_list.jsp中，取出域中的集合，然后使用c标签 去遍历集合。 </span><br><span class="line">	&lt;table border=&quot;1&quot; width=&quot;700&quot;&gt;</span><br><span class="line">	&lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">		&lt;td&gt;编号&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;姓名&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;年龄&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;性别&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;住址&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;操作&lt;/td&gt;</span><br><span class="line">	&lt;/tr&gt;</span><br><span class="line"></span><br><span class="line">	&lt;c:forEach items=&quot;$&#123;list &#125;&quot; var=&quot;stu&quot;&gt;</span><br><span class="line">		&lt;tr align=&quot;center&quot;&gt;</span><br><span class="line">			&lt;td&gt;$&#123;stu.id &#125;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;$&#123;stu.name &#125;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;$&#123;stu.age &#125;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;$&#123;stu.gender &#125;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;$&#123;stu.address &#125;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;a href=&quot;#&quot;&gt;更新&lt;/a&gt;   &lt;a href=&quot;#&quot;&gt;删除&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">	&lt;/c:forEach&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">JSP</span><br><span class="line">三大指令</span><br><span class="line">	page</span><br><span class="line">	include</span><br><span class="line">	taglib</span><br><span class="line">三个动作标签</span><br><span class="line">	&lt;jsp:include&gt;</span><br><span class="line">	&lt;jsp:forward&gt;</span><br><span class="line">	&lt;jsp:param&gt;</span><br><span class="line">	</span><br><span class="line">&gt;&gt;&gt;&gt;九个内置对象</span><br><span class="line"></span><br><span class="line">&gt;&gt;四个作用域</span><br><span class="line">pageContext</span><br><span class="line">request</span><br><span class="line">session</span><br><span class="line">application</span><br><span class="line"></span><br><span class="line">out</span><br><span class="line">exception</span><br><span class="line">response</span><br><span class="line">page</span><br><span class="line">config</span><br><span class="line"></span><br><span class="line">&gt;&gt;EL</span><br><span class="line">$&#123; 表达式 &#125;</span><br><span class="line">取4个作用域中的值</span><br><span class="line">$&#123; name &#125;</span><br><span class="line">&gt;&gt;&gt;有11个内置对象。			</span><br><span class="line">pageContext</span><br><span class="line"></span><br><span class="line">pageScope</span><br><span class="line">requestScope</span><br><span class="line">sessionScope</span><br><span class="line">applicationScope</span><br><span class="line"></span><br><span class="line">header</span><br><span class="line">headerValues</span><br><span class="line"></span><br><span class="line">param</span><br><span class="line">paramValues</span><br><span class="line"></span><br><span class="line">cookie</span><br><span class="line">initParam</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">JSTL</span><br><span class="line">&gt; 使用1.1的版本， 支持EL表达式， 1.0不支持EL表达式</span><br><span class="line"></span><br><span class="line">&gt; 拷贝jar包， 通过taglib 去引入标签库</span><br><span class="line">&lt;c:set&gt;</span><br><span class="line">&lt;c:if&gt;</span><br><span class="line">&lt;c:forEach&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="事务-amp-数据库连接池-amp-DBUtils"><a href="#事务-amp-数据库连接池-amp-DBUtils" class="headerlink" title="事务&amp;数据库连接池&amp;DBUtils"></a>事务&amp;数据库连接池&amp;DBUtils</h1><p><strong>事务</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; Transaction  其实指的一组操作，里面包含许多个单一的逻辑。只要有一个逻辑没有执行成功，那么都算失败。 所有的数据都回归到最初的状态(回滚)</span><br><span class="line"> </span><br><span class="line">- 为什么要有事务?</span><br><span class="line">为了确保逻辑的成功。 例子： 银行的转账。</span><br></pre></td></tr></table></figure>
<p><strong>使用命令行方式演示事务。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- 开启事务</span><br><span class="line">  start transaction;</span><br><span class="line">- 提交或者回滚事务</span><br><span class="line">  commit; 提交事务， 数据将会写到磁盘上的数据库</span><br><span class="line">  rollback ;  数据回滚，回到最初的状态。</span><br></pre></td></tr></table></figure>
<p>1.关闭自动提交功能。</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img21.png" alt="img21"></p>
<p>2.演示事务</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img22.png" alt="img22"></p>
<p><strong>使用代码方式演示事务</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&gt; 代码里面的事务，主要是针对连接来的。 </span><br><span class="line">&gt; 1. 通过conn.setAutoCommit（false ）来关闭自动提交的设置。</span><br><span class="line">&gt; 2. 提交事务  conn.commit();</span><br><span class="line">&gt; 3. 回滚事务 conn.rollback();</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">public void testTransaction()&#123;</span><br><span class="line">	</span><br><span class="line">	Connection conn = null;</span><br><span class="line">	PreparedStatement ps = null;</span><br><span class="line">	ResultSet rs = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		conn = JDBCUtil.getConn();</span><br><span class="line">		</span><br><span class="line">		//连接，事务默认就是自动提交的。 关闭自动提交。</span><br><span class="line">		conn.setAutoCommit(false);</span><br><span class="line">		</span><br><span class="line">		String sql = &quot;update account set money = money - ? where id = ?&quot;;</span><br><span class="line">		ps = conn.prepareStatement(sql);</span><br><span class="line">		</span><br><span class="line">		//扣钱， 扣ID为1 的100块钱</span><br><span class="line">		ps.setInt(1, 100);</span><br><span class="line">		ps.setInt(2, 1);</span><br><span class="line">		ps.executeUpdate();</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		int a = 10 /0 ;</span><br><span class="line">		</span><br><span class="line">		//加钱， 给ID为2 加100块钱</span><br><span class="line">		ps.setInt(1, -100);</span><br><span class="line">		ps.setInt(2, 2);</span><br><span class="line">		ps.executeUpdate();</span><br><span class="line">		</span><br><span class="line">		//成功： 提交事务。</span><br><span class="line">		conn.commit();</span><br><span class="line">		</span><br><span class="line">	&#125; catch (SQLException e) &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			//事变： 回滚事务</span><br><span class="line">			conn.rollback();</span><br><span class="line">		&#125; catch (SQLException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		</span><br><span class="line">	&#125;finally &#123;</span><br><span class="line">		JDBCUtil.release(conn, ps, rs);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>事务的特性</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- 原子性</span><br><span class="line">&gt; 指的是 事务中包含的逻辑，不可分割。 </span><br><span class="line"></span><br><span class="line">- 一致性</span><br><span class="line">&gt; 指的是 事务执行前后。数据完整性</span><br><span class="line"></span><br><span class="line">- 隔离性</span><br><span class="line">&gt; 指的是 事务在执行期间不应该受到其他事务的影响</span><br><span class="line"></span><br><span class="line">- 持久性</span><br><span class="line">&gt; 指的是 事务执行成功，那么数据应该持久保存到磁盘上。</span><br></pre></td></tr></table></figure>
<p><strong>事务的安全隐患 </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; 不考虑隔离级别设置，那么会出现以下问题。</span><br><span class="line"></span><br><span class="line">- 读</span><br><span class="line"></span><br><span class="line">&gt; 脏读 不可重读读  幻读.</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;脏读</span><br><span class="line">&gt; 一个事务读到另外一个事务还未提交的数据</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;不可重复读 </span><br><span class="line">&gt; 一个事务读到了另外一个事务提交的数据 ，造成了前后两次查询结果不一致。</span><br><span class="line"></span><br><span class="line">写</span><br><span class="line">丢失更新</span><br></pre></td></tr></table></figure>
<p><strong>读未提交 演示</strong></p>
<p>1.设置A窗口的隔离级别为 读未提交 </p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img23.png" alt="img23"></p>
<p>2.两个窗口都分别开启事务</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img24.png" alt="img24"></p>
<p><strong>读已提交演示</strong></p>
<p>1.设置A窗口的隔离级别为 读已提交</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img25.png" alt="img25"></p>
<p>2.A B 两个窗口都开启事务， 在B窗口执行更新操作</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img26.png" alt="img26"></p>
<p>3.在A窗口执行的查询结果不一致。 一次是在B窗口提交事务之前，一次是在B窗口提交事务之后。</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img27.png" alt="img27"></p>
<blockquote>
<p>这个隔离级别能够屏蔽 脏读的现象， 但是引发了另一个问题  ，不可重复读。</p>
</blockquote>
<p><strong>可串行化</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; 如果有一个连接的隔离级别设置为了串行化 ，那么谁先打开了事务， 谁就有了先执行的权利， 谁后打开事务，谁就只能得着，等前面的那个事务，提交或者回滚后，才能执行。  但是这种隔离级别一般比较少用。 容易造成性能上的问题。 效率比较低。</span><br><span class="line"></span><br><span class="line">- 按效率划分，从高到低</span><br><span class="line">&gt; 读未提交  &gt; 读已提交  &gt; 可重复读  &gt; 可串行化</span><br><span class="line"></span><br><span class="line">- 按拦截程度 ，从高到底</span><br><span class="line">&gt; 可串行化 &gt; 可重复读 &gt; 读已提交 &gt;  读未提交</span><br></pre></td></tr></table></figure>
<p><strong>事务总结</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">需要掌握的</span><br><span class="line"></span><br><span class="line">1.在代码里面会使用事务 </span><br><span class="line">conn.setAutoCommit(false);</span><br><span class="line"></span><br><span class="line">	conn.commit();</span><br><span class="line">	conn.rollback();</span><br><span class="line">	</span><br><span class="line">2 事务只是针对连接连接对象，如果再开一个连接对象，那么那是默认的提交。</span><br><span class="line">3. 事务是会自动提交的。 </span><br><span class="line"></span><br><span class="line">需要了解的</span><br><span class="line">&gt;&gt;安全隐患</span><br><span class="line">	读</span><br><span class="line">	脏读</span><br><span class="line">		一个事务读到了另一个事务未提交的数据</span><br><span class="line">	不可重复读</span><br><span class="line">		一个事务读到了另一个事务已提交的数据，造成前后两次查询结果不一致</span><br><span class="line">	幻读</span><br><span class="line">		一个事务读到了另一个事务insert的数据 ，造成前后查询结果不一致 。</span><br><span class="line"></span><br><span class="line">	写</span><br><span class="line"></span><br><span class="line">	丢失更新。</span><br><span class="line"></span><br><span class="line">&gt;&gt;隔离级别</span><br><span class="line">读未提交</span><br><span class="line"></span><br><span class="line">&gt; 引发问题： 脏读 </span><br><span class="line">读已提交</span><br><span class="line"></span><br><span class="line">&gt; 解决： 脏读 ， 引发： 不可重复读</span><br><span class="line">可重复读</span><br><span class="line"></span><br><span class="line">&gt; 解决： 脏读 、 不可重复读 ， 未解决： 幻读</span><br><span class="line">可串行化</span><br><span class="line"></span><br><span class="line">&gt; 解决： 脏读、 不可重复读 、 幻读。</span><br><span class="line">	</span><br><span class="line">mySql 默认的隔离级别是 可重复读</span><br><span class="line">Oracle 默认的隔离级别是  读已提交</span><br><span class="line"></span><br><span class="line">&gt;&gt;丢失更新</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img28.png" alt="img28"></p>
<p><strong>解决丢失更新</strong></p>
<ul>
<li>悲观锁</li>
</ul>
<blockquote>
<p>可以在查询的时候，加入 for update</p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img29.png" alt="img29"></p>
</blockquote>
<ul>
<li>乐观锁</li>
</ul>
<blockquote>
<p>要求程序员自己控制。 </p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img30.png" alt="img30"></p>
</blockquote>
<p><strong>数据库连接池</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; 1. 数据库的连接对象创建工作，比较消耗性能。 </span><br><span class="line"></span><br><span class="line">&gt; 2.一开始现在内存中开辟一块空间（集合） ， 一开先往池子里面放置 多个连接对象。  后面需要连接的话，直接从池子里面去。不要去自己创建连接了。  使用完毕， 要记得归还连接。确保连接对象能循环利用。</span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img31.png" alt="img31"></p>
<p><strong>自定义数据库连接池 </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- 代码实现</span><br><span class="line">- 出现的问题：</span><br><span class="line">  1. 需要额外记住 addBack方法</span><br><span class="line"></span><br><span class="line">  2. 单例。</span><br><span class="line"></span><br><span class="line">  3. 无法面向接口编程。 </span><br><span class="line">        UserDao dao = new UserDaoImpl();</span><br><span class="line">        dao.insert();</span><br><span class="line"> 		DataSource dataSource = new MyDataSource();</span><br><span class="line"> 		因为接口里面没有定义addBack方法。 </span><br><span class="line"></span><br><span class="line"> 4.怎么解决?   以addBack 为切入点。</span><br></pre></td></tr></table></figure>
<p><strong>解决自定义数据库连接池出现的问题。 </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; 由于多了一个addBack 方法，所以使用这个连接池的地方，需要额外记住这个方法，并且还不能面向接口编程。</span><br><span class="line"></span><br><span class="line">&gt; 我们打算修改接口中的那个close方法。  原来的Connection对象的close方法，是真的关闭连接。 </span><br><span class="line">&gt; 打算修改这个close方法，以后在调用close， 并不是真的关闭，而是归还连接对象。</span><br><span class="line"></span><br><span class="line">###如何扩展某一个方法?</span><br><span class="line"></span><br><span class="line">&gt; 原有的方法逻辑，不是我们想要的。 想修改自己的逻辑</span><br><span class="line"></span><br><span class="line">1. 直接改源码  无法实现。</span><br><span class="line">2. 继承， 必须得知道这个接口的具体实现是谁。 </span><br><span class="line">3. 使用装饰者模式。</span><br></pre></td></tr></table></figure>
<p><strong>开源连接池</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">#### DBCP</span><br><span class="line"></span><br><span class="line">1. 导入jar文件</span><br><span class="line">2. 不使用配置文件：</span><br><span class="line">public void testDBCP01()&#123;</span><br><span class="line">	Connection conn = null;</span><br><span class="line">		PreparedStatement ps = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			</span><br><span class="line">			//1. 构建数据源对象</span><br><span class="line">			BasicDataSource dataSource = new BasicDataSource();</span><br><span class="line">			//连的是什么类型的数据库， 访问的是哪个数据库 ， 用户名， 密码。。</span><br><span class="line">			//jdbc:mysql://localhost/bank 主协议：子协议 ://本地/数据库</span><br><span class="line">			dataSource.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">			dataSource.setUrl(&quot;jdbc:mysql://localhost/bank&quot;);</span><br><span class="line">			dataSource.setUsername(&quot;root&quot;);</span><br><span class="line">			dataSource.setPassword(&quot;root&quot;);</span><br><span class="line">				//2. 得到连接对象</span><br><span class="line">			conn = dataSource.getConnection();</span><br><span class="line">			String sql = &quot;insert into account values(null , ? , ?)&quot;;</span><br><span class="line">			ps = conn.prepareStatement(sql);</span><br><span class="line">			ps.setString(1, &quot;admin&quot;);</span><br><span class="line">			ps.setInt(2, 1000);</span><br><span class="line">			</span><br><span class="line">			ps.executeUpdate();</span><br><span class="line">			</span><br><span class="line">		&#125; catch (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;finally &#123;</span><br><span class="line">			JDBCUtil.release(conn, ps);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">2.使用配置文件方式：</span><br><span class="line">	Connection conn = null;</span><br><span class="line">	PreparedStatement ps = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		BasicDataSourceFactory factory = new BasicDataSourceFactory();</span><br><span class="line">		Properties properties = new Properties();</span><br><span class="line">		InputStream is = new FileInputStream(&quot;src//dbcpconfig.properties&quot;);</span><br><span class="line">		properties.load(is);</span><br><span class="line">		DataSource dataSource = factory.createDataSource(properties);</span><br><span class="line">		</span><br><span class="line">		//2. 得到连接对象</span><br><span class="line">		conn = dataSource.getConnection();</span><br><span class="line">		String sql = &quot;insert into account values(null , ? , ?)&quot;;</span><br><span class="line">		ps = conn.prepareStatement(sql);</span><br><span class="line">		ps.setString(1, &quot;liangchaowei&quot;);</span><br><span class="line">		ps.setInt(2, 100);</span><br><span class="line">		</span><br><span class="line">		ps.executeUpdate();</span><br><span class="line">		</span><br><span class="line">	&#125; catch (Exception e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;finally &#123;</span><br><span class="line">		JDBCUtil.release(conn, ps);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>C3P0</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">拷贝jar文件 到 lib目录</span><br><span class="line"></span><br><span class="line">不使用配置文件方式	</span><br><span class="line">Connection conn = null;</span><br><span class="line">	PreparedStatement ps = null;</span><br><span class="line">	try &#123;</span><br><span class="line">		//1. 创建datasource</span><br><span class="line">		ComboPooledDataSource dataSource = new ComboPooledDataSource();</span><br><span class="line">		//2. 设置连接数据的信息</span><br><span class="line">		dataSource.setDriverClass(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">		</span><br><span class="line">		//忘记了---&gt; 去以前的代码 ---&gt; jdbc的文档</span><br><span class="line">		dataSource.setJdbcUrl(&quot;jdbc:mysql://localhost/bank&quot;);</span><br><span class="line">		dataSource.setUser(&quot;root&quot;);</span><br><span class="line">		dataSource.setPassword(&quot;root&quot;);</span><br><span class="line">		</span><br><span class="line">		//2. 得到连接对象</span><br><span class="line">		conn = dataSource.getConnection();</span><br><span class="line">		String sql = &quot;insert into account values(null , ? , ?)&quot;;</span><br><span class="line">		ps = conn.prepareStatement(sql);</span><br><span class="line">		ps.setString(1, &quot;admi234n&quot;);</span><br><span class="line">		ps.setInt(2, 103200);</span><br><span class="line">		</span><br><span class="line">		ps.executeUpdate();</span><br><span class="line">		</span><br><span class="line">	&#125; catch (Exception e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;finally &#123;</span><br><span class="line">		JDBCUtil.release(conn, ps);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">使用配置文件方式</span><br><span class="line">		//默认会找 xml 中的 default-config 分支。 </span><br><span class="line">		ComboPooledDataSource dataSource = new ComboPooledDataSource();</span><br><span class="line">		//2. 设置连接数据的信息</span><br><span class="line">		dataSource.setDriverClass(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">		</span><br><span class="line">		//忘记了---&gt; 去以前的代码 ---&gt; jdbc的文档</span><br><span class="line">		dataSource.setJdbcUrl(&quot;jdbc:mysql://localhost/bank&quot;);</span><br><span class="line">		dataSource.setUser(&quot;root&quot;);</span><br><span class="line">		dataSource.setPassword(&quot;root&quot;);</span><br><span class="line">		</span><br><span class="line">		//2. 得到连接对象</span><br><span class="line">		conn = dataSource.getConnection();</span><br><span class="line">		String sql = &quot;insert into account values(null , ? , ?)&quot;;</span><br><span class="line">		ps = conn.prepareStatement(sql);</span><br><span class="line">		ps.setString(1, &quot;admi234n&quot;);</span><br><span class="line">		ps.setInt(2, 103200);</span><br></pre></td></tr></table></figure>
<p><strong>DBUtils</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">增删改</span><br><span class="line">	//dbutils 只是帮我们简化了CRUD 的代码， 但是连接的创建以及获取工作。 不在他的考虑范围</span><br><span class="line">	QueryRunner queryRunner = new QueryRunner(new ComboPooledDataSource());	</span><br><span class="line">	</span><br><span class="line">	//增加</span><br><span class="line">	//queryRunner.update(&quot;insert into account values (null , ? , ? )&quot;, &quot;aa&quot; ,1000);</span><br><span class="line">	</span><br><span class="line">	//删除</span><br><span class="line">	//queryRunner.update(&quot;delete from account where id = ?&quot;, 5);</span><br><span class="line">	</span><br><span class="line">	//更新</span><br><span class="line">	//queryRunner.update(&quot;update account set money = ? where id = ?&quot;, 10000000 , 6);</span><br><span class="line">	</span><br><span class="line">查询</span><br><span class="line">1.直接new接口的匿名实现类</span><br><span class="line">	QueryRunner queryRunner = new QueryRunner(new ComboPooledDataSource());</span><br><span class="line">	</span><br><span class="line">	Account  account =  queryRunner.query(&quot;select * from account where id = ?&quot;, new ResultSetHandler&lt;Account&gt;()&#123;</span><br><span class="line"></span><br><span class="line">		@Override</span><br><span class="line">		public Account handle(ResultSet rs) throws SQLException &#123;</span><br><span class="line">			Account account  =  new Account();</span><br><span class="line">			while(rs.next())&#123;</span><br><span class="line">				String name = rs.getString(&quot;name&quot;);</span><br><span class="line">				int money = rs.getInt(&quot;money&quot;);</span><br><span class="line">				</span><br><span class="line">				account.setName(name);</span><br><span class="line">				account.setMoney(money);</span><br><span class="line">			&#125;</span><br><span class="line">			return account;</span><br><span class="line">		&#125;</span><br><span class="line">		 </span><br><span class="line">	 &#125;, 6);</span><br><span class="line">	</span><br><span class="line">	System.out.println(account.toString());</span><br><span class="line">	</span><br><span class="line">2.直接使用框架已经写好的实现类。</span><br><span class="line"></span><br><span class="line">* 查询单个对象</span><br><span class="line">	QueryRunner queryRunner = new QueryRunner(new ComboPooledDataSource());</span><br><span class="line">	//查询单个对象</span><br><span class="line">	Account account = queryRunner.query(&quot;select * from account where id = ?&quot;, </span><br><span class="line">			new BeanHandler&lt;Account&gt;(Account.class), 8);</span><br><span class="line"></span><br><span class="line">* 查询多个对象</span><br><span class="line">	QueryRunner queryRunner = new QueryRunner(new ComboPooledDataSource());</span><br><span class="line">	List&lt;Account&gt; list = queryRunner.query(&quot;select * from account &quot;,</span><br><span class="line">			new BeanListHandler&lt;Account&gt;(Account.class));</span><br></pre></td></tr></table></figure>
<p><strong>ResultSetHandler 常用的实现类</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">以下两个是使用频率最高的</span><br><span class="line">BeanHandler,  查询到的单个数据封装成一个对象</span><br><span class="line">BeanListHandler, 查询到的多个数据封装 成一个List&lt;对象&gt;</span><br><span class="line"></span><br><span class="line">ArrayHandler,  查询到的单个数据封装成一个数组</span><br><span class="line">ArrayListHandler,  查询到的多个数据封装成一个集合 ，集合里面的元素是数组。</span><br><span class="line"></span><br><span class="line">MapHandler,  查询到的单个数据封装成一个map</span><br><span class="line">MapListHandler,查询到的多个数据封装成一个集合 ，集合里面的元素是map。 </span><br><span class="line"></span><br><span class="line">ColumnListHandler</span><br><span class="line">KeyedHandler</span><br><span class="line">ScalarHandler</span><br></pre></td></tr></table></figure>
<p><strong>总结</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">事务</span><br><span class="line"></span><br><span class="line">使用命令行演示</span><br><span class="line">使用代码演示</span><br><span class="line">脏读、</span><br><span class="line">不可重复读、</span><br><span class="line">幻读</span><br><span class="line">丢失更新</span><br><span class="line"></span><br><span class="line">悲观锁</span><br><span class="line">乐观锁</span><br><span class="line"><span class="number">4</span>个隔离级别</span><br><span class="line">	读未提交</span><br><span class="line">	读已提交</span><br><span class="line">	可重复读</span><br><span class="line">	可串行化</span><br><span class="line">	</span><br><span class="line">数据连接池</span><br><span class="line">- DBCP</span><br><span class="line">  不使用配置</span><br><span class="line">  使用配置</span><br><span class="line"></span><br><span class="line">- C3P0</span><br><span class="line">  不使用配置</span><br><span class="line">  使用配置 （必须掌握）</span><br><span class="line"></span><br><span class="line">- 自定义连接池 </span><br><span class="line">  装饰者模式</span><br><span class="line">  </span><br><span class="line">  DBUtils</span><br><span class="line">&gt; 简化了我们的CRUD ， 里面定义了通用的CRUD方法。 </span><br><span class="line">queryRunner.update();</span><br><span class="line">queryRunner.query</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="MVC设计模式"><a href="#MVC设计模式" class="headerlink" title="MVC设计模式"></a>MVC设计模式</h1><p><strong>元数据</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Meata data </span><br><span class="line">描述数据的数据 String sql , 描述这份sql字符串的数据叫做元数据</span><br><span class="line">数据库元数据  DatabaseMetaData</span><br><span class="line">参数元数据  ParameterMetaData</span><br><span class="line">结果集元数据  ResultSetMetaData</span><br></pre></td></tr></table></figure>
<p><strong>JSP的开发模式</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img32.png" alt="img32"></p>
<p><strong>三层架构&amp;MVC练习</strong></p>
<p><img src="/2019/01/26/JavaWeb知识/JavaWeb/img33.png" alt="img33"></p>
<p><strong>学生信息管理系统–数据库准备–查询</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE stus;</span><br><span class="line">USE stus;</span><br><span class="line">CREATE TABLE stu (</span><br><span class="line">	sid INT PRIMARY KEY  AUTO_INCREMENT,</span><br><span class="line">	sname VARCHAR (20),</span><br><span class="line">	gender VARCHAR (5),</span><br><span class="line">	phone VARCHAR (20),</span><br><span class="line">	birthday DATE,</span><br><span class="line">	hobby VARCHAR(50),</span><br><span class="line">	info VARCHAR(200)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">查询</span><br><span class="line">1. 先写一个JSP 页面， 里面放一个超链接 。 </span><br><span class="line">   &lt;a href=&quot;StudentListServlet&quot;&gt; 学生列表显示&lt;/a&gt;</span><br><span class="line">2. 写Servlet， 接收请求， 去调用 Service  , 由service去调用dao</span><br><span class="line">3. 先写Dao , 做Dao实现。</span><br><span class="line">public interface StudentDao &#123;</span><br><span class="line">/**</span><br><span class="line">- 查询所有学生</span><br><span class="line">  - @return  List&lt;Student&gt;</span><br><span class="line">    */</span><br><span class="line">      List&lt;Student&gt; findAll()  throws SQLException ;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      public class StudentDaoImpl implements StudentDao &#123;</span><br><span class="line">      		/**</span><br><span class="line">			 * 查询所有学生</span><br><span class="line">			 * @throws SQLException </span><br><span class="line">			 */</span><br><span class="line">			@Override</span><br><span class="line">			public List&lt;Student&gt; findAll() throws SQLException &#123;</span><br><span class="line">				QueryRunner runner = new QueryRunner(JDBCUtil02.getDataSource());</span><br><span class="line">				return runner.query(&quot;select * from stu&quot;, new BeanListHandler&lt;Student&gt;(Student.class));</span><br><span class="line">				&#125;</span><br><span class="line">	&#125;</span><br><span class="line">4.再Service , 做Service的实现。</span><br><span class="line">/**</span><br><span class="line">	 * 这是学生的业务处理规范</span><br><span class="line">	 * @author xiaomi</span><br><span class="line">	 *</span><br><span class="line">	 */</span><br><span class="line">	public interface StudentService &#123;</span><br><span class="line">	</span><br><span class="line">		/**</span><br><span class="line">		 * 查询所有学生</span><br><span class="line">		 * @return  List&lt;Student&gt;</span><br><span class="line">		 */</span><br><span class="line">		List&lt;Student&gt; findAll()  throws SQLException ;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	------------------------------------------</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 这是学生业务实现</span><br><span class="line">	 * @author xiaomi</span><br><span class="line">	 *</span><br><span class="line">	 */</span><br><span class="line">	public class StudentServiceImpl implements StudentService&#123;</span><br><span class="line">	</span><br><span class="line">		@Override</span><br><span class="line">		public List&lt;Student&gt; findAll() throws SQLException &#123;</span><br><span class="line">			StudentDao dao = new StudentDaoImpl();</span><br><span class="line">			return dao.findAll();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">5.在servlet 存储数据，并且做出页面响应。</span><br><span class="line">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			//1. 查询出来所有的学生</span><br><span class="line">			StudentService service = new StudentServiceImpl();</span><br><span class="line">			List&lt;Student&gt; list = service.findAll();</span><br><span class="line">			//2. 先把数据存储到作用域中</span><br><span class="line">		request.setAttribute(&quot;list&quot;, list);</span><br><span class="line">		//3. 跳转页面</span><br><span class="line">		request.getRequestDispatcher(&quot;list.jsp&quot;).forward(request, response);</span><br><span class="line">		</span><br><span class="line">	&#125; catch (SQLException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line">在list.jsp上显示数据</span><br><span class="line">EL + JSTL  + 表格</span><br></pre></td></tr></table></figure>
<p><strong>增加 </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1. 先跳转到增加的页面 ， 编写增加的页面</span><br><span class="line"></span><br><span class="line">2. 点击添加，提交数据到AddServlet . 处理数据。</span><br><span class="line"></span><br><span class="line">3. 调用service</span><br><span class="line"></span><br><span class="line">4. 调用dao, 完成数据持久化。</span><br><span class="line"></span><br><span class="line">5. 完成了这些存储工作后，需要跳转到列表页面。 这里不能直接跳转到列表页面，否则没有什么内容显示。 应该先跳转到查询所有学生信息的那个Servlet， 由那个Servlet再去跳转到列表页面。</span><br><span class="line"></span><br><span class="line">6. 爱好的value 值有多个。 </span><br><span class="line"></span><br><span class="line">   request.getParameter(&quot;hobby&quot;);</span><br><span class="line">   String[] hobby = 	request.getParameterValues(&quot;hobby&quot;) ---&gt; String[] </span><br><span class="line">   String value = Arrays.toString(hobby): // [爱好， 篮球， 足球]</span><br></pre></td></tr></table></figure>
<p><strong>删除</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1.点击超链接，弹出一个询问是否删除的对话框，如果点击了确定，那么就真的删除。</span><br><span class="line">&lt;a href=&quot;#&quot; onclick=&quot;doDelete($&#123;stu.sid&#125;)&quot;&gt;删除&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">2.让超链接，执行一个js方法</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">function doDelete(sid) &#123;</span><br><span class="line">		/* 如果这里弹出的对话框，用户点击的是确定，就马上去请求Servlet。 </span><br><span class="line">		如何知道用户点击的是确定。</span><br><span class="line">		如何在js的方法中请求servlet。 */</span><br><span class="line">		var flag = confirm(&quot;是否确定删除?&quot;);</span><br><span class="line">		if(flag)&#123;</span><br><span class="line">			//表明点了确定。 访问servlet。 在当前标签页上打开 超链接，</span><br><span class="line">			//window.location.href=&quot;DeleteServlet?sid=&quot;+sid;</span><br><span class="line">			location.href=&quot;DeleteServlet?sid=&quot;+sid;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">3.在js访问里面判断点击的选项，然后跳转到servlet。</span><br><span class="line">4.servlet收到了请求，然后去调用service ， service去调用dao</span><br></pre></td></tr></table></figure>
<p><strong>更新</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">1. 点击列表上的更新， 先跳转到一个EditServlet </span><br><span class="line"></span><br><span class="line">&gt; 在这个Servlet里面，先根据ID 去查询这个学生的所有信息出来。</span><br><span class="line"></span><br><span class="line">2. 跳转到更新的页面。 ，然后在页面上显示数据</span><br><span class="line">	 &lt;tr&gt;</span><br><span class="line">		&lt;td&gt;姓名&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;sname&quot; value=&quot;$&#123;stu.sname &#125;&quot;&gt;&lt;/td&gt;</span><br><span class="line">	  &lt;/tr&gt;</span><br><span class="line">	  	   &lt;tr&gt;</span><br><span class="line">		&lt;td&gt;性别&lt;/td&gt;</span><br><span class="line">		&lt;td&gt;</span><br><span class="line">			&lt;!-- 如果性别是男的，  可以在男的性别 input标签里面， 出现checked ,</span><br><span class="line">			如果性别是男的，  可以在女的性别 input标签里面，出现checked --&gt;</span><br><span class="line">			&lt;input type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;男&quot; &lt;c:if test=&quot;$&#123;stu.gender == &apos;男&apos;&#125;&quot;&gt;checked&lt;/c:if&gt;&gt;男</span><br><span class="line">			&lt;input type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;女&quot; &lt;c:if test=&quot;$&#123;stu.gender == &apos;女&apos;&#125;&quot;&gt;checked&lt;/c:if&gt;&gt;女</span><br><span class="line">		&lt;/td&gt;</span><br><span class="line">	  &lt;/tr&gt;</span><br><span class="line">	   &lt;tr&gt;</span><br><span class="line">		&lt;td&gt;爱好&lt;/td&gt;</span><br><span class="line">				&lt;td&gt;</span><br><span class="line">			&lt;!-- 爱好： 篮球 ， 足球 ， 看书 </span><br><span class="line">			因为爱好有很多个，  里面存在包含的关系 --&gt;</span><br><span class="line">			&lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;游泳&quot; &lt;c:if test=&quot;$&#123;fn:contains(stu.hobby,&apos;游泳&apos;) &#125;&quot;&gt;checked&lt;/c:if&gt;&gt;游泳</span><br><span class="line">			&lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;篮球&quot; &lt;c:if test=&quot;$&#123;fn:contains(stu.hobby,&apos;篮球&apos;) &#125;&quot;&gt;checked&lt;/c:if&gt;&gt;篮球</span><br><span class="line">			&lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;足球&quot; &lt;c:if test=&quot;$&#123;fn:contains(stu.hobby,&apos;足球&apos;) &#125;&quot;&gt;checked&lt;/c:if&gt;&gt;足球</span><br><span class="line">			&lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;看书&quot; &lt;c:if test=&quot;$&#123;fn:contains(stu.hobby,&apos;看书&apos;) &#125;&quot;&gt;checked&lt;/c:if&gt;&gt;看书</span><br><span class="line">			&lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;写字&quot; &lt;c:if test=&quot;$&#123;fn:contains(stu.hobby,&apos;写字&apos;) &#125;&quot;&gt;checked&lt;/c:if&gt;&gt;写字</span><br><span class="line">		</span><br><span class="line">		&lt;/td&gt;</span><br><span class="line">	  &lt;/tr&gt;</span><br><span class="line">	  </span><br><span class="line">3.修改完毕后，提交数据到UpdateServlet</span><br><span class="line">提交上来的数据是没有带id的，所以我们要手动创建一个隐藏的输入框， 在这里面给定id的值， 以便提交表单，带上id。</span><br><span class="line">	&lt;form method=&quot;post&quot; action=&quot;UpdateServlet&quot;&gt;</span><br><span class="line">		&lt;input type=&quot;hidden&quot; name=&quot;sid&quot; value=&quot;$&#123;stu.sid &#125;&quot;&gt;</span><br><span class="line">	</span><br><span class="line">		...</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">	</span><br><span class="line">4.获取数据，调用service， 调用dao.</span><br></pre></td></tr></table></figure>
<p><strong>分页功能</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- 物理分页 （真分页）</span><br><span class="line"></span><br><span class="line">&gt; 来数据库查询的时候，只查一页的数据就返回了。  </span><br><span class="line"> 	优点 内存中的数据量不会太大</span><br><span class="line">	缺点：对数据库的访问频繁了一点。</span><br><span class="line">	SELECT * FROM stu LIMIT	5 OFFSET 2 </span><br><span class="line">	</span><br><span class="line">- 逻辑分页 （假分页）</span><br><span class="line">&gt; 一口气把所有的数据全部查询出来，然后放置在内存中。 </span><br><span class="line">优点： 访问速度快。</span><br><span class="line">缺点： 数据库量过大，内存溢出。</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Ajax-amp-Jquery"><a href="#Ajax-amp-Jquery" class="headerlink" title="Ajax &amp; Jquery"></a>Ajax &amp; Jquery</h1><p><strong>Ajax</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- 是什么?</span><br><span class="line">&gt; “Asynchronous Javascript And XML”（异步JavaScript和XML），</span><br><span class="line">&gt; 并不是新的技术，只是把原有的技术，整合到一起而已。 </span><br><span class="line">	   1.使用CSS和XHTML来表示。</span><br><span class="line">	   2. 使用DOM模型来交互和动态显示。</span><br><span class="line">	   3.使用XMLHttpRequest来和服务器进行异步通信。</span><br><span class="line">	   4.使用javascript来绑定和调用。</span><br><span class="line">	   </span><br><span class="line">- 有什么用?</span><br><span class="line">&gt; 咱们的网页如果想要刷新局部内容。 那么需要重新载入整个网页。用户体验不是很好。  就是为了解决局部刷新的问题。 保持其他部分不动，只刷新某些地方。</span><br></pre></td></tr></table></figure>
<p><strong>数据请求 Get</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">1.创建对象</span><br><span class="line"></span><br><span class="line">		function  ajaxFunction()&#123;</span><br><span class="line">		   var xmlHttp;</span><br><span class="line">		   try&#123; // Firefox, Opera 8.0+, Safari</span><br><span class="line">		        xmlHttp=new XMLHttpRequest();</span><br><span class="line">		    &#125;</span><br><span class="line">		    catch (e)&#123;</span><br><span class="line">			   try&#123;// Internet Explorer</span><br><span class="line">			         xmlHttp=new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);</span><br><span class="line">			      &#125;</span><br><span class="line">			    catch (e)&#123;</span><br><span class="line">			      try&#123;</span><br><span class="line">			         xmlHttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</span><br><span class="line">			      &#125;</span><br><span class="line">			      catch (e)&#123;&#125;</span><br><span class="line">			      &#125;</span><br><span class="line">		    &#125;</span><br><span class="line">	</span><br><span class="line">			return xmlHttp;</span><br><span class="line">		 &#125;</span><br><span class="line">		 </span><br><span class="line">2. 发送请求</span><br><span class="line">	//执行get请求</span><br><span class="line">function get() &#123;</span><br><span class="line">	</span><br><span class="line">	//1. 创建xmlhttprequest 对象</span><br><span class="line">	var request = ajaxFunction();</span><br><span class="line">	</span><br><span class="line">	//2. 发送请求。</span><br><span class="line">	// http://localhost:8080/day16/demo01.jsp</span><br><span class="line">	//http://localhost:8080/day16/DemoServlet01</span><br><span class="line">	</span><br><span class="line">	/*	</span><br><span class="line">		参数一： 请求类型  GET or  POST</span><br><span class="line">		参数二： 请求的路径</span><br><span class="line">		参数三： 是否异步， true  or false</span><br><span class="line">	*/</span><br><span class="line">	request.open(&quot;GET&quot; ,&quot;/day16/DemoServlet01&quot; ,true );</span><br><span class="line">	request.send();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">如果发送请求的同时，还想获取数据，那么代码如下</span><br><span class="line"></span><br><span class="line">//执行get请求</span><br><span class="line">function get() &#123;</span><br><span class="line">	</span><br><span class="line">	//1. 创建xmlhttprequest 对象</span><br><span class="line">	var request = ajaxFunction();</span><br><span class="line">	</span><br><span class="line">	//2. 发送请求</span><br><span class="line">	request.open(&quot;GET&quot; ,&quot;/day16/DemoServlet01?name=aa&amp;age=18&quot; ,true );</span><br><span class="line">	</span><br><span class="line">	//3. 获取响应数据 注册监听的意思。  一会准备的状态发生了改变，那么就执行 = 号右边的方法</span><br><span class="line">	request.onreadystatechange = function()&#123;</span><br><span class="line">		</span><br><span class="line">		//前半段表示 已经能够正常处理。  再判断状态码是否是200</span><br><span class="line">		if(request.readyState == 4 &amp;&amp; request.status == 200)&#123;</span><br><span class="line">			//弹出响应的信息</span><br><span class="line">			alert(request.responseText);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	request.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>数据请求 Post</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line"></span><br><span class="line">//1. 创建对象</span><br><span class="line">function  ajaxFunction()&#123;</span><br><span class="line">   var xmlHttp;</span><br><span class="line">   try&#123; // Firefox, Opera 8.0+, Safari</span><br><span class="line">        xmlHttp=new XMLHttpRequest();</span><br><span class="line">    &#125;</span><br><span class="line">    catch (e)&#123;</span><br><span class="line">	   try&#123;// Internet Explorer</span><br><span class="line">	         xmlHttp=new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);</span><br><span class="line">	      &#125;</span><br><span class="line">	    catch (e)&#123;</span><br><span class="line">	      try&#123;</span><br><span class="line">	         xmlHttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</span><br><span class="line">	      &#125;</span><br><span class="line">	      catch (e)&#123;&#125;</span><br><span class="line">	      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	return xmlHttp;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">function post() &#123;</span><br><span class="line">	//1. 创建对象</span><br><span class="line">	var request = ajaxFunction();</span><br><span class="line">	</span><br><span class="line">	//2. 发送请求</span><br><span class="line">	request.open( &quot;POST&quot;, &quot;/day16/DemoServlet01&quot;, true );</span><br><span class="line"></span><br><span class="line">	//如果不带数据，写这行就可以了</span><br><span class="line">	//request.send();</span><br><span class="line">	</span><br><span class="line">	//如果想带数据，就写下面的两行</span><br><span class="line">	</span><br><span class="line">	//如果使用的是post方式带数据，那么 这里要添加头， 说明提交的数据类型是一个经过url编码的form表单数据</span><br><span class="line">	request.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);</span><br><span class="line">	</span><br><span class="line">	//带数据过去  ， 在send方法里面写表单数据。 </span><br><span class="line">	request.send(&quot;name=aobama&amp;age=19&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">需要获取数据</span><br><span class="line">function post() &#123;</span><br><span class="line">		//1. 创建对象</span><br><span class="line">		var request = ajaxFunction();</span><br><span class="line">		</span><br><span class="line">		//2. 发送请求</span><br><span class="line">		request.open( &quot;POST&quot;, &quot;/day16/DemoServlet01&quot;, true );</span><br><span class="line">		</span><br><span class="line">		//想获取服务器传送过来的数据， 加一个状态的监听。 </span><br><span class="line">		request.onreadystatechange=function()&#123;</span><br><span class="line">			if(request.readyState==4 &amp;&amp; request.status == 200)&#123;</span><br><span class="line">				</span><br><span class="line">				alert(&quot;post：&quot;+request.responseText);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		//如果使用的是post方式带数据，那么 这里要添加头， 说明提交的数据类型是一个经过url编码的form表单数据</span><br><span class="line">		request.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);</span><br><span class="line">		</span><br><span class="line">		//带数据过去  ， 在send方法里面写表单数据。 </span><br><span class="line">		request.send(&quot;name=aobama&amp;age=19&quot;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>校验用户名是否可用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">1. 搭建环境</span><br><span class="line">页面准备</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;table border=&quot;1&quot; width=&quot;500&quot;&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;用户名:&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;name&quot;  onblur=&quot;checkUserName()&quot;&gt;&lt;span id=&quot;span01&quot;&gt;&lt;/span&gt;&lt;/td&gt; </span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;密码&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;&quot;&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;邮箱&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;&quot;&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;简介&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;&quot;&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td colspan=&quot;2&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;注册&quot;&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">	&lt;/table&gt;</span><br><span class="line">   &lt;/body&gt;</span><br><span class="line">   </span><br><span class="line">   2.数据库准备</span><br><span class="line">   Servlet代码</span><br><span class="line">   protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">	try &#123;</span><br><span class="line">		</span><br><span class="line">		request.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">		</span><br><span class="line">		//1. 检测是否存在</span><br><span class="line">		String name = request.getParameter(&quot;name&quot;);</span><br><span class="line">		System.out.println(&quot;name=&quot;+name);</span><br><span class="line">		</span><br><span class="line">		UserDao dao = new UserDaomImpl();</span><br><span class="line">		boolean isExist = dao.checkUserName(name);</span><br><span class="line">		</span><br><span class="line">		//2.  通知页面，到底有还是没有。</span><br><span class="line">		if(isExist)&#123;</span><br><span class="line">			response.getWriter().println(1);  //存在用户名</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			response.getWriter().println(2); //不存在该用户名</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125; catch (SQLException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">3. Dao代码</span><br><span class="line">public class UserDaomImpl implements UserDao&#123;</span><br><span class="line"></span><br><span class="line">		@Override</span><br><span class="line">		public boolean checkUserName(String username) throws SQLException &#123;</span><br><span class="line">			QueryRunner runner = new QueryRunner(JDBCUtil02.getDataSource());</span><br><span class="line">			</span><br><span class="line">			String sql = &quot;select count(*) from t_user where username =?&quot;;</span><br><span class="line">			</span><br><span class="line">			runner.query(sql, new  ScalarHandler(), username);</span><br><span class="line"></span><br><span class="line">			Long result = (Long) runner.query(sql, new  ScalarHandler(), username); </span><br><span class="line">			return result &gt; 0 ;</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>jsp页面显示</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">function checkUserName() &#123;</span><br><span class="line">//获取输入框的值 document 整个网页</span><br><span class="line">	var name = document.getElementById(&quot;name&quot;).value; // value  value() val val()</span><br><span class="line">	//1. 创建对象</span><br><span class="line">	var request = ajaxFunction();</span><br><span class="line">	</span><br><span class="line">	//2. 发送请求</span><br><span class="line">	request.open(&quot;POST&quot;  ,&quot;/day16/CheckUserNameServlet&quot; , true );</span><br><span class="line">	</span><br><span class="line">	//注册状态改变监听，获取服务器传送过来的数据</span><br><span class="line">	request.onreadystatechange = function()&#123;</span><br><span class="line">		</span><br><span class="line">		if(request.readyState == 4 &amp;&amp; request.status == 200)&#123;</span><br><span class="line">			//alert(request.responseText);</span><br><span class="line">			var data = request.responseText;</span><br><span class="line">			if(data == 1)&#123;</span><br><span class="line">				//alert(&quot;用户名已存在&quot;);</span><br><span class="line">				document.getElementById(&quot;span01&quot;).innerHTML = &quot;&lt;font color=&apos;red&apos;&gt;用户名已存在!&lt;/font&gt;&quot;;</span><br><span class="line">			&#125;else&#123;</span><br><span class="line">				document.getElementById(&quot;span01&quot;).innerHTML = &quot;&lt;font color=&apos;green&apos;&gt;用户名可用!&lt;/font&gt;&quot;;</span><br><span class="line">				//alert(&quot;用户名未存在&quot;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	request.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);</span><br><span class="line">	request.send(&quot;name=&quot;+name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>JQuery</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- 是什么?</span><br><span class="line">&gt; javascript 的代码框架。  </span><br><span class="line">- 有什么用?</span><br><span class="line">&gt; 简化代码，提高效率。  </span><br><span class="line">- 核心 </span><br><span class="line">&gt; write less do more , 写得更少，做的更多。</span><br></pre></td></tr></table></figure>
<p><strong>load</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;&quot; onclick=&quot;load()&quot;&gt;使用JQuery执行load方法&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">有两次刷新，  先走 onClick的方法，取到数据回来之后，赋值显示。 接着 走 href=&quot;&quot;的路径，但是这个属性没有给值，所以会把当前的页面重新再刷新一次。所以导致看不见值。</span><br><span class="line"></span><br><span class="line">//找到这个元素， 去执行加载的动作， 加载/day16/DemoServlet02 ， 得到的数据，赋值显示</span><br><span class="line">$(&quot;#aaa&quot;).load(&quot;/day16/DemoServlet02&quot; , function(responseText , statusTXT  , xhr) &#123;</span><br><span class="line">		//找到id为text01的元素， 设置它的value属性值为 responseText 对应的值</span><br><span class="line">		$(&quot;#aaa&quot;).val(responseText);</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>Get</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$.get(&quot;/day16/DemoServlet02&quot;  , function(data ,status) &#123;</span><br><span class="line">		$(&quot;#div01&quot;).text(data);</span><br><span class="line">	&#125;);</span><br><span class="line">赋值显示</span><br><span class="line">- val(&quot;aa&quot;); </span><br><span class="line">&gt; 只能放那些标签带有value属性</span><br><span class="line">- html(&quot;aa&quot;); ---写html代码</span><br><span class="line">- text(&quot;aa&quot;);</span><br><span class="line">&gt; 其实没有什么区别，如果想针对这分数据做html样式处理，那么只能用html()</span><br></pre></td></tr></table></figure>
<p><strong>load &amp; get</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">load</span><br><span class="line">$(&quot;#元素id&quot;).load(url地址);</span><br><span class="line">$(&quot;#div1&quot;).load(serlvet); ---&gt; 使用的get请求，回来赋值的时候， 使用text（）;去赋值</span><br><span class="line">get</span><br><span class="line">语法格式 ： $.get(URL,callback);	</span><br><span class="line">	使用案例： $.get(&quot;/day16/DemoServlet02&quot;  , function(data ,status) &#123;</span><br><span class="line">		$(&quot;#div01&quot;).text(data);</span><br><span class="line">	&#125;);</span><br><span class="line">post</span><br><span class="line">语法格式：$.post(URL,data,callback);</span><br><span class="line">	function post() &#123;</span><br><span class="line">		$.post(&quot;/day16/DemoServlet02&quot;, &#123;name:&quot;zhangsan&quot;,age:18&#125;,function(data,status) &#123;</span><br><span class="line">			//想要放数据到div里面去。 --- 找到div</span><br><span class="line">			$(&quot;#div01&quot;).html(data);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>使用JQuery去实现校验用户名</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function checkUserName() &#123;</span><br><span class="line">	//1. 获取输入框的内容</span><br><span class="line">	var name = $(&quot;#name&quot;).val();</span><br><span class="line">	</span><br><span class="line">	//2. 发送请求</span><br><span class="line">	$.post(&quot;/day16/CheckUserNameServlet&quot; , &#123;name:name&#125; , function(data , status)&#123;</span><br><span class="line">		//alert(data);</span><br><span class="line">		if(data == 1)&#123;//用户名存在</span><br><span class="line">			//alert(&quot;用户名存在&quot;);</span><br><span class="line">			$(&quot;#span01&quot;).html(&quot;&lt;font color=&apos;red&apos;&gt;用户名已被注册&lt;/font&gt;&quot;);</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			//alert(&quot;用户名可用&quot;);</span><br><span class="line">			$(&quot;#span01&quot;).html(&quot;&lt;font color=&apos;green&apos;&gt;用户名可以使用&lt;/font&gt;&quot;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; );</span><br><span class="line">	//3. 输出响应的数据到页面上。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>实现百度搜索提示</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">搭建环境</span><br><span class="line">1.定义首页</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;center&gt;</span><br><span class="line">	&lt;h2&gt;黑马&lt;/h2&gt;</span><br><span class="line">		&lt;input type=&quot;text&quot; name=&quot;word&quot; id=&quot;word&quot; style=&quot;width: 600px ; height: 50px  ;font-size: 20px;&quot;&gt;</span><br><span class="line">		&lt;input type=&quot;button&quot; value=&quot;黑马一下&quot;  style=&quot;height: 55px ; width: 100px ; &quot;&gt;</span><br><span class="line">		&lt;div id=&quot;div01&quot; style=&quot;position:relative; left : -54px; width: 600px; height: 200px ; border:  1px solid blue; display: none&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">2.定义数据库</span><br><span class="line">###捕获键盘弹起</span><br><span class="line"></span><br><span class="line">$(function()&#123;</span><br><span class="line">	$(&quot;#word&quot;).keyup(function() &#123;</span><br><span class="line">		alert(&quot;键盘弹起了..&quot;);</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">###JS请求</span><br><span class="line">$(function()&#123;</span><br><span class="line">	$(&quot;#word&quot;).keyup(function() &#123;</span><br><span class="line">		//2。 获取输入框的值 </span><br><span class="line">		//var word = $(&quot;#word&quot;).val();</span><br><span class="line">		//this  对应就是执行这个方法的那个对象， $(&quot;#word&quot;)</span><br><span class="line">		var word = $(this).val();</span><br><span class="line"></span><br><span class="line">		if(word == &quot;&quot;)&#123;</span><br><span class="line">			$(&quot;#div01&quot;).hide();</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			//3. 请求数据。</span><br><span class="line">			$.post(&quot;find&quot;,&#123;word:word&#125; ,function(data , status)&#123;</span><br><span class="line">				//alert(data);</span><br><span class="line">				$(&quot;#div01&quot;).show();</span><br><span class="line">				$(&quot;#div01&quot;).html(data);</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>Servlet代码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">		request.setCharacterEncoding(&quot;utf-8&quot;);</span><br><span class="line">		try &#123;</span><br><span class="line">			//1. 先获取参数</span><br><span class="line">			String word = request.getParameter(&quot;word&quot;);</span><br><span class="line">			System.out.println(&quot;word=&quot;+word);</span><br><span class="line">			</span><br><span class="line">			//2. 让dao执行查询</span><br><span class="line">			WordsDao dao = new WordsDaoImpl();</span><br><span class="line">			List&lt;WordBean&gt; list = dao.findWords(word);</span><br><span class="line">			</span><br><span class="line">			for (WordBean wordBean : list) &#123;</span><br><span class="line">				System.out.println(&quot;===&quot;+wordBean.toString());</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			request.setAttribute(&quot;list&quot;, list);</span><br><span class="line">			</span><br><span class="line">			//3. 返回数据</span><br><span class="line">			response.setContentType(&quot;text/html;charset=utf-8&quot;);</span><br><span class="line">			//response.getWriter().write(&quot;数据是：&quot;);</span><br><span class="line">			request.getRequestDispatcher(&quot;list.jsp&quot;).forward(request, response);</span><br><span class="line">		&#125; catch (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><strong>list.jsp</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">	    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">	 &lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot;  prefix=&quot;c&quot;%&gt;</span><br><span class="line">	 </span><br><span class="line">		&lt;table style=&quot;width: 100%&quot;&gt;</span><br><span class="line">			&lt;c:forEach items=&quot;$&#123;list &#125;&quot; var=&quot;wordBean&quot;&gt;</span><br><span class="line">				&lt;tr&gt;</span><br><span class="line">					&lt;td&gt;$&#123;wordBean.words&#125;&lt;/td&gt;</span><br><span class="line">				&lt;/tr&gt;</span><br><span class="line">			&lt;/c:forEach&gt;</span><br><span class="line">		&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<p><strong>使用JQuery实现 省市联动</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">环境准备</span><br><span class="line">1. 准备数据库</span><br><span class="line"></span><br><span class="line">2 。 准备页面</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;js/jquery-1.11.3.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">		&lt;script type=&quot;text/javascript&quot; src=&quot;js/city.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">		&lt;/head&gt;</span><br><span class="line">		&lt;body&gt;</span><br><span class="line">		省份: &lt;select name=&quot;province&quot; id =&quot;province&quot;&gt;</span><br><span class="line">				&lt;option value=&quot;&quot; &gt;-请选择 -</span><br><span class="line">				&lt;option value=&quot;1&quot; &gt;广东</span><br><span class="line">				&lt;option value=&quot;2&quot; &gt;湖南</span><br><span class="line">				&lt;option value=&quot;3&quot; &gt;湖北</span><br><span class="line">				&lt;option value=&quot;4&quot; &gt;四川</span><br><span class="line">			&lt;/select&gt;</span><br><span class="line">		城市: </span><br><span class="line">			&lt;select name=&quot;city&quot; id=&quot;city&quot;&gt;</span><br><span class="line">				&lt;option value=&quot;&quot; &gt;-请选择 -</span><br><span class="line">			&lt;/select&gt;</span><br><span class="line">		&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p><strong>XStream的使用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//3. 返回数据。手动拼  ---&gt; XStream  转化 bean对象成 xml</span><br><span class="line">		XStream xStream = new XStream();</span><br><span class="line">		</span><br><span class="line">		//想把id做成属性</span><br><span class="line">		xStream.useAttributeFor(CityBean.class, &quot;id&quot;);</span><br><span class="line">		</span><br><span class="line">		//设置别名</span><br><span class="line">		xStream.alias(&quot;city&quot;, CityBean.class);</span><br><span class="line">		</span><br><span class="line">		//转化一个对象成xml字符串</span><br><span class="line">		String xml = xStream.toXML(list);</span><br></pre></td></tr></table></figure>
<p><strong>JS代码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">$(function() &#123;</span><br><span class="line">	//1。找到省份的元素</span><br><span class="line">	$(&quot;#province&quot;).change(function() &#123;</span><br><span class="line">		//2. 一旦里面的值发生了改变，那么就去请求该省份的城市数据</span><br><span class="line">		//$(&quot;#province&quot;).varl();</span><br><span class="line">		var pid = $(this).val();</span><br><span class="line">		</span><br><span class="line">		/*&lt;list&gt;</span><br><span class="line">			&lt;city&gt;</span><br><span class="line">				&lt;id&gt;1&lt;id&gt;</span><br><span class="line">				&lt;pid&gt;1&lt;/pid&gt;</span><br><span class="line">				&lt;cname&gt;深圳&lt;/cname&gt;</span><br><span class="line">			&lt;/city&gt;</span><br><span class="line">			&lt;city &gt;</span><br><span class="line">				&lt;id&gt;2&lt;id&gt;</span><br><span class="line">				&lt;pid&gt;1&lt;/pid&gt;</span><br><span class="line">				&lt;cname&gt;东莞&lt;/cname&gt;</span><br><span class="line">			&lt;/city&gt;</span><br><span class="line">		&lt;/list&gt;*/</span><br><span class="line">		</span><br><span class="line">		$.post( &quot;CityServlet&quot;,&#123;pid:pid&#125; ,function(data,status)&#123;</span><br><span class="line">			//alert(&quot;回来数据了:&quot;+data);</span><br><span class="line">			</span><br><span class="line">			//先清空以前的值：</span><br><span class="line">			$(&quot;#city&quot;).html(&quot;&lt;option value=&apos;&apos; &gt;-请选择-&quot;)</span><br><span class="line">			//遍历： </span><br><span class="line">			//从data数据里面找出所有的city  ， 然后遍历所有的city。</span><br><span class="line">			//遍历一个city，就执行一次function方法</span><br><span class="line">			$(data).find(&quot;city&quot;).each(function() &#123;</span><br><span class="line">				</span><br><span class="line">				//遍历出来的每一个city，取它的孩子。 id , cname</span><br><span class="line">				var id = $(this).children(&quot;id&quot;).text();</span><br><span class="line">				var cname = $(this).children(&quot;cname&quot;).text();</span><br><span class="line">				</span><br><span class="line">				$(&quot;#city&quot;).append(&quot;&lt;option value=&apos;&quot;+id+&quot;&apos; &gt;&quot;+cname)</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125; );</span><br><span class="line">		</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>服务器和客户端数据传输的方式</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">xml</span><br><span class="line"></span><br><span class="line">&lt;list&gt;</span><br><span class="line">			&lt;city&gt;</span><br><span class="line">				&lt;id&gt;1&lt;id&gt;</span><br><span class="line">				&lt;pid&gt;1&lt;/pid&gt;</span><br><span class="line">				&lt;cname&gt;深圳&lt;/cname&gt;</span><br><span class="line">			&lt;/city&gt;</span><br><span class="line">			&lt;city &gt;</span><br><span class="line">				&lt;id&gt;2&lt;id&gt;</span><br><span class="line">				&lt;pid&gt;1&lt;/pid&gt;</span><br><span class="line">				&lt;cname&gt;东莞&lt;/cname&gt;</span><br><span class="line">			&lt;/city&gt;</span><br><span class="line">		&lt;/list&gt;</span><br><span class="line">		</span><br><span class="line">json</span><br><span class="line">阅读性更好 、 容量更小。</span><br><span class="line">&#123;&quot;name&quot;:&quot;aaa&quot; , &quot;age&quot;:19&#125;</span><br><span class="line">把javaBean  转化成 json数据</span><br><span class="line"></span><br><span class="line">	//3. 把list ---&gt; json数据</span><br><span class="line">		//JSONArray ---&gt; 变成数组 ， 集合  []</span><br><span class="line">		//JSONObject ---&gt; 变成简单的数据  &#123; name : zhangsan , age:18&#125;</span><br><span class="line">		</span><br><span class="line">		JSONArray jsonArray = JSONArray.fromObject(list);</span><br><span class="line">		String json = jsonArray.toString();</span><br></pre></td></tr></table></figure>
<p><strong>使用json格式数据显示省市联动效果</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">serlvet代码：</span><br><span class="line">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">	try &#123;</span><br><span class="line">		//1. 获取参数</span><br><span class="line">		int pid = Integer.parseInt(request.getParameter(&quot;pid&quot;));</span><br><span class="line">		</span><br><span class="line">		//2 找出所有的城市</span><br><span class="line">		CityDao dao = new CityDaoImpl();</span><br><span class="line">		List&lt;CityBean&gt; list = dao.findCity(pid);</span><br><span class="line">		</span><br><span class="line">		//3. 把list ---&gt; json数据</span><br><span class="line">		//JSONArray ---&gt; 变成数组 ， 集合  []</span><br><span class="line">		//JSONObject ---&gt; 变成简单的数据  &#123; name : zhangsan , age:18&#125;</span><br><span class="line">		</span><br><span class="line">		JSONArray jsonArray = JSONArray.fromObject(list);</span><br><span class="line">		String json = jsonArray.toString();</span><br><span class="line">		</span><br><span class="line">	response.setContentType(&quot;text/html;charset=utf-8&quot;);</span><br><span class="line">		response.getWriter().write(json);</span><br><span class="line">		</span><br><span class="line">			&#125; catch (SQLException e) &#123;</span><br><span class="line">		// TODO Auto-generated catch block</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line">js代码</span><br><span class="line">$(function() &#123;</span><br><span class="line">		//1。找到省份的元素</span><br><span class="line">		$(&quot;#province&quot;).change(function() &#123;</span><br><span class="line">			//2. 一旦里面的值发生了改变，那么就去请求该省份的城市数据</span><br><span class="line">			//$(&quot;#province&quot;).varl();</span><br><span class="line">			var pid = $(this).val();</span><br><span class="line">			</span><br><span class="line">			/*[</span><br><span class="line">			    &#123;</span><br><span class="line">			        &quot;cname&quot;: &quot;深圳&quot;,</span><br><span class="line">			        &quot;id&quot;: 1,</span><br><span class="line">			        &quot;pid&quot;: 1</span><br><span class="line">			    &#125;,</span><br><span class="line">			    &#123;</span><br><span class="line">			        &quot;cname&quot;: &quot;东莞&quot;,</span><br><span class="line">			        &quot;id&quot;: 2,</span><br><span class="line">			        &quot;pid&quot;: 1</span><br><span class="line">			    &#125;</span><br><span class="line">			    ...</span><br><span class="line">			]*/</span><br><span class="line">			</span><br><span class="line">			$.post( &quot;CityServlet02&quot;,&#123;pid:pid&#125; ,function(data,status)&#123;</span><br><span class="line">				</span><br><span class="line">				//先清空</span><br><span class="line">				$(&quot;#city&quot;).html(&quot;&lt;option value=&apos;&apos; &gt;-请选择-&quot;);</span><br><span class="line">				//再遍历，追加</span><br><span class="line">				$(data).each(function(index , c) &#123;</span><br><span class="line">					$(&quot;#city&quot;).append(&quot;&lt;option value=&apos;&quot;+c.id+&quot;&apos; &gt;&quot;+c.cname)</span><br><span class="line">				&#125;);</span><br><span class="line">			&#125;,&quot;json&quot; );</span><br><span class="line">			</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<p>##总结</p>
<p>###Ajax  </p>
<p>发送get请求</p>
<p>发送post请求</p>
<p>都要求带数据 + 获取数据＋　放置到元素上。</p>
<p>JQuery</p>
<p>发送get请求</p>
<p>发送post请求</p>
<p>都要求带数据 + 获取数据＋　放置到元素上。</p>
<hr>
<ol>
<li>服务器返回xml数据</li>
<li>服务器返回json数据</li>
</ol>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/JavaEE/" rel="tag"># JavaEE</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/05/26/数据结构/6 查找/查找/" rel="prev" title="查找">
                查找 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/uploads/avatar.jpg" alt="Beny">
            
              <p class="site-author-name" itemprop="name">Beny</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">33</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">12</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">11</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="/1105397915" title="1105397915 &rarr; 1105397915"><i class="fa fa-fw fa-qq"></i>1105397915</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/benyzheng" title="GitHub &rarr; https://github.com/benyzheng" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="/zhengbeny@qq.com" title="zhengbeny@qq.com &rarr; zhengbeny@qq.com"><i class="fa fa-fw fa-envelope"></i>zhengbeny@qq.com</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#XML"><span class="nav-number">1.</span> <span class="nav-text">XML</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tomcat"><span class="nav-number">2.</span> <span class="nav-text">Tomcat</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#JDBC"><span class="nav-number">3.</span> <span class="nav-text">JDBC</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTP-amp-Servlet"><span class="nav-number">4.</span> <span class="nav-text">HTTP&amp;Servlet</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTPServletReauest-amp-HTTPServletResponse"><span class="nav-number">5.</span> <span class="nav-text">HTTPServletReauest&amp;HTTPServletResponse</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Cookie-amp-amp-Session"><span class="nav-number">6.</span> <span class="nav-text">Cookie&amp;&amp;Session</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#JSP-amp-EL-amp-JSTL"><span class="nav-number">7.</span> <span class="nav-text">JSP &amp; EL &amp; JSTL</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#事务-amp-数据库连接池-amp-DBUtils"><span class="nav-number">8.</span> <span class="nav-text">事务&amp;数据库连接池&amp;DBUtils</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MVC设计模式"><span class="nav-number">9.</span> <span class="nav-text">MVC设计模式</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Ajax-amp-Jquery"><span class="nav-number">10.</span> <span class="nav-text">Ajax &amp; Jquery</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Beny</span>

  

  
</div>








<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共76.5k字</span>
</div>
        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/libs/jquery/index.js?v=2.1.3"></script>

  
  <script src="/libs/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/libs/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.0"></script>



  
  <script src="/js/scrollspy.js?v=7.1.0"></script>
<script src="/js/post-details.js?v=7.1.0"></script>



  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  
  

<script src="//cdn1.lncld.net/static/js/3.11.1/av-min.js"></script>



<script src="/js/src/Valine.min.js"></script>

<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: true,
    appId: 'oaY0uDqkCsuX94AxTtnV6scO-gzGzoHsz',
    appKey: 'HKU5SJPAd8KyYqk6Q8fdArL5',
    placeholder: '写了评论, offer还会远吗? ----记得填写邮箱哦~如果可以填写你的网站互相参考就更好啦',
    avatar: 'retro',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false,
    lang: '' || 'zh-cn'
  });
  //增加以下六行代码去除 power by valine
    var infoEle = document.querySelector('#comments .info');
    if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0){
      infoEle.childNodes.forEach(function(item) {
        item.parentNode.removeChild(item);
      });
    }
</script>




  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  

  

  

  

  

  

  

<!-- 页面点击小红心 -->
<!-- <script type="text/javascript" src="/js/src/click.js"></script>-->
</body>
</html>
